# FANUC Series Oi-MODEL F Plus
加工中心系统操作说明书
- 本说明书的任何内容不得以任何方式复制。- 本机的外观及规格如需改良而变更，恕不另行通知。
本说明书中所记载的商品，受到日本国《外汇和外国贸易法》的限制。从日本将本说明书中的商品出口到其他国家时，须获得日本国政府的出口许可。此外，该产品可能还受到美国政府的再出口法的限制。若要出口或者再出口此类产品，请向FANUC公司洽询。
本说明书中记载的商品是在严格的质量管理下制造的，在因本商品的故障而预测会导致重大事故或者损失时，请对安全进行充分考虑。
我们试图在本说明书中描述尽可能多的情况。但如果在本说明书中涵盖所有禁止及不可做的事项，将占用很多篇幅，本说明书无法全部一一列举。因此，对于那些在说明书中没有特别指明可以做的事，都应解释为“不可做”。
本说明书中记载了除本公司产品以外的程序名称及设备名称，其中包含了各制造商的注册商标。但在正文中可能未明确标注®及™标记。
# 安全使用须知
为了更加安全地使用CNC装置附带的机床(以下简称“机床”)，“安全使用须知”描述与CNC装置相关的安装注意事项。用户所使用的某些CNC装置虽然没有相对应的功能，但已经标上了该项注意事项，用户在阅读时可以忽略。有关机床的安全注意事项，请参阅机床制造商提供的说明书。凡是编写机床程序和进行机床操作的作业人员，必须在充分理解机床制造商提供的说明书和本说明书的内容后再使用。
# 警告、注意和注释
本说明书中，为保障使用者的人身安全及防止机床破损，根据安全注意事项的不同程度，正文中分别以“警告”及“注意”来标记说明。
另外，补充说明内容以“注释”标记说明。
在使用之前，必须熟读这些“警告”、“注意”和“注释”中所叙述的事项。
# 警告
指如果操作错误，可能会导致使用人员死亡或受重伤的危险状态。
# 注意
指如果操作错误，可能会导致使用人员受轻伤或损坏设备的危险状态。
警告和注意以外，需要进行补充说明时使用。
请仔细阅读本说明书，并加以妥善保管。
# 一般警告和注意
1 在实际加工工件时，不可一上来就运转机床，要通过试运行来确认机床的动作状态；确认项目包括：使用单程序段、进给速度倍率、机床锁住功能或没有安装刀具和工件时的空载运转。如果未能充分确认机床是否运转正常，会因为机床预想不到的运转而损坏工件或者机床，或导致操作人员受伤。2 机床运转之前应认真检查是否已经正确输入想要输入的数据。使用不正确的数据运转机床，会因为机床预想不到的运转而损坏工件和机床，或导致操作人员受伤。3 要确保进给速度与打算进行的操作相适应。一般地讲，每台机床其最大进给速度受到限制。根据运转内容的不同，最佳速度也不同，请按照机床说明书执行。如果机床运转的速度不正确，会给机床带来预想不到的负荷，从而损坏工件和机床，或导致操作人员受伤。4 当使用刀具补偿功能时，请充分确认补偿方向和补偿值。使用不正确的数据运转机床，会因为机床预想不到的运转而损坏工件和机床，或导致操作人员受伤。5 制造商已经设置了CNC和PMC参数的最佳值，一般情况下不必改变。然而，在迫不得已必须改变参数时，在改变前，必须弄懂该参数的功能。如果参数设置不正确，则会因为机床预想不到的运转而损坏工件和机床，或导致操作人员受伤。
1 接通电源后，在位置显示画面或报警画面显示在CNC装置的画面上之前，请勿触摸MDI单元上的任何按键。MDI单元上的某些键是为维护或别的特殊操作而设置的，按压这些键中的任何一个，都会使CNC处于预想不到的状态，在这种状态下启动机床有可能导致机床预想不到的运转。2 操作说明书说明CNC装置具备的全部功能，其中包括选项功能。应注意的是，所选的选项功能将随着机床型号不同而不同。因此，说明书中所载的有些功能无法使用，用户应事先确认机床的规格。3 某些功能可能是按机床制造商的要求提供的。当使用这些功能时，关于使用方法和注意事项，请参阅机床制造商提供的说明书。4 液晶显示屏使用非常精密的加工技术制作而成，但是由于其特性，有时会存在像素缺陷和经常点亮的像素。但是这并非故障，请予谅解。
# 注释
程序、参数和宏变量都存储在CNC装置内部的永久性存储器中。通常，即使接通/断开电源，存储内容也不会丢失。但是，有时会因为不注意而将这些数据删除掉，或者在修复故障时，需要清除永久性存储器中的全部数据。为避免上述情况的发生，确保被删除数据的迅速恢复，应将这些数据制成备份并妥善保管起来。存储加工程序的永久性存储器中，写入次数受到限制。在每次进行加工时从上位的电脑自动下载加工程序的使用方法等、频繁地反复进行加工程序的登录或删除这样的使用方法的情况下，务必使用“高速程序管理”。“高速程序管理”中，在进行程序的登录、变更或删除时，不会向永久性存储器进行保存。
# 与编程有关的警告和注意
下面叙述与编程有关的主要安全注意事项。在编程时，请仔细阅读操作说明书，充分理解里面的内容。
1坐标系设定
1坐标系设定如果坐标系的设定不正确，即使程序的移动指令正确，也会导致机床预想不到的运转。这种情况会损坏刀具、机床和工件，或导致操作人员受伤。
2用非直线插补法定位
当用非直线插补法定位时（即在起点和终点之间采用非线性运动定位方式），在进行编程之前，必须仔细确认刀具的路径。
由于定位是在快速进给下进行的，如果刀具与工件相碰，就会损坏刀具、机床和工件，或导致操作人员受伤。
3旋转轴动作的功能
编制法线方向控制等的程序时，应格外注意旋转轴的速度。程序编得不合适，会使旋转轴的速度变得过快，或由于工件的安装方法不当，工件因离心力而脱落。
这种情况会损坏刀具、机床和工件，或导致操作人员受伤。
4英制/米制转换
由英制输入转为米制输入，或由米制输入转为英制输入，并不转换工件原点偏置值、各类参数和当前位置等单位。因此，在运行机床之前，必须充分确认这类数据的单位。试图用错误的数据进行操作，会损坏刀具、机床和工件，或导致操作人员受伤。
5周速恒定控制
在周速恒定控制中周速恒定控制轴的工件坐标系的当前位置接近原点时，主轴的速度会变得过快，因此，必须正确指定最大转速。如果没有正确指定最大转速，就会损坏刀具、机床和工件，或导致操作人员受伤。
6行程检查
对于需要进行手动参考点返回的机床，在接通电源后，务须进行手动参考点返回。在手动参考点返回之前，行程检查失效。注意，在行程检查失效的状态下，即使行程超出限制，也不会有报警发出，从而损坏刀具、机床和工件，或导致操作人员受伤。
7系统间刀架干涉检测
系统间刀架干涉检测是根据在自动运行期间所指定的刀具数据进行的。如果指定的刀具与实际使用的刀具不匹配，就无法正确进行干涉检测，从而损坏刀具和机床，或导致操作人员受伤。接通电源时以及手动选择一个刀架后，务须在自动运行下指定所用刀具的刀具号。
8同一程序段内的同一地址指令
使用同一地址的G代码或者M代码，无法在同一程序段中指令。使用同一地址的情况下，有可能会因机床的预想不到的动作而造成刀具和机床以及工件破损，或致使人员受伤，所以要以不同的程序段进行指令。（有关地址P，请参阅附录“程序指令中包含地址P的功能一览”。）
1绝对/增量模式
如果用绝对值编写的程序在增量模式下执行，或者用增量值编写的程序在绝对模式下执行，会导致机床预想不到的运转。
2平面选择
对圆弧插补/螺旋插补/固定循环，如果指定的平面不正确，会导致机床预想不到的运转。详情请参阅各自的功能描述。
3扭矩极限跳转
在试图进行扭矩极限跳转之前，务须将扭矩极限设为有效。如果在扭矩极限失效的状态下指定扭矩极限跳转，将执行移动指令而不产生跳转动作。
4可编程镜像
注意：当可编程镜像被设为有效时，之后的程序动作将会发生很大的变化。
5补偿功能
如果在补偿功能模式下指定机床坐标系的指令或与参考点返回相关的指令，则会暂时取消补偿，从而导致机床预想不到的运转。
因此，在发出上述任何指令之前，先取消补偿功能模式。
# 与操作有关的警告和注意
本节示出与操作机床有关的为确保安全的主要注意事项。在进行操作时，请仔细阅读操作说明书，充分理解里面的内容。
1 手动运行
手动运行机床时，要把握刀具和工件的当前位置，还要充分确认移动轴、移动方向和进给速度的选择没有错误。错误操作会损坏刀具、机床和工件，或导致操作人员受伤。
2 手动参考点返回
对于需要进行手动参考点返回的机床，在接通电源后，务须进行手动参考点返回。如果不首先进行手动参考点返回就操作机床，会导致机床预想不到的运转。另外，在进行手动参考点返回之前，行程检查失效。这种情况会损坏刀具、机床和工件，或导致操作人员受伤。
3 手动手轮进给
手动手轮进给时，若选择100倍等较大的倍率旋转手轮，会使刀具和转台的移动速度加快。因此，运转时如果不加注意，就会损坏刀具、机床和工件，或导致操作人员受伤。
4 倍率的失效
在螺纹切削、刚性攻丝或其他攻丝期间，当指定宏变量倍率失效或取消倍率而倍率失效时，将成为预想不到的速度，从而损坏刀具、机床和工件，或导致操作人员受伤。
5 原点/预设操作
当机床处于程序执行中时，原则上请勿进行原点/预设操作。若在程序执行中进行原点/预设操作，在之后的程序执行过程中，机床将执行预想不到的动作。这种情况会损坏刀具、机床和工件，或导致操作人员受伤。
6 工件坐标系位移
手动干预、机床锁住或镜像都会导致工件坐标系位移。因此，在执行程序之前，必须认真确认坐标系。如果不考虑工件坐标系的位移而执行程序，会导致机床预想不到的运转。这种情况会损坏刀具、机床和工件，或导致操作人员受伤。
7 软件操作面板和菜单开关
利用软件操作面板和菜单开关，可以从MDI单元指定机床面板不支持的操作，如改变模式、改变倍率值、指定JOG进给指令等。因此，如果不注意操作MDI单元键，会导致机床预想不到的运转。这种情况会损坏刀具、机床和工件，或导致操作人员受伤。8 RESET（复位）键
按下RESET键时，执行中的程序停止。结果，伺服轴也会随之停止，但是，RESET键MDI由于单元的故障等原因而有可能不起作用，为了确保安全，在需要停止电机时，请勿按下RESET键，而应使用急停按钮。
1 手动干预
如果在程序执行过程中进行手动干预，根据不同的状态，在重新启动机床时，移动路径会有所不同。因此，手动干预之后，在重新启动机床之前，应确认手动绝对开关、参数和绝对/增量指令模式等的状态。
2 进给保持、倍率和单程序设
使用用户宏程序系统变量P3004，可使进给保持、进给速度倍率和单程序段功能失效。这时，由操作人员进行的这些操作将会失效，操作机床时必须格外小心。
3 空运行
通常采用空运行来确认机床的运转性能。空运行时机床以空运行速度运转，该速度不同于用程序指定的进给速度。有时机床会在快速进给下运动。
4 编辑程序
如果机床暂停加工，之后对加工中的程序进行修改、插入或删除，然后继续执行该程序，就会导致机床预想不到的运转。对正在使用的加工程序进行修改、插入或删除是十分危险的，原则上请勿擅自为之。
5 PS报警
如果在程序段的中途发生PS报警，则轴移动将继续，直到程序段完成。程序段执行完成后，轴的移动将停止。
# 与日常维护有关的警告
1 存储器备份电池的更换更换电池的工作只有那些已经接受过维修培训和安全培训的人员才能胜任。在打开机柜更换电池时，切勿触碰高压电路部分（标有标记并配有绝缘盖）。触摸不加盖的高压电路，会导致触电。
注释CNC靠电池来保存存储器的数据，即使在无外部电源供应的情况下也必须保存诸如程序、偏置值、参数等数据。当电池的电压下降时，机床操作面板上或画面上会显示电池电压下降报警。当电池电压下降的报警显示后，应在一周内更换电池。若不更换电池，CNC存储器中的数据将会丢失。电池的更换步骤，请参阅操作说明书（车床系统/加工中心系统通用）的维护篇“关于日常维护”的“更换电池的方法”项。
2 绝对脉冲编码器备份电池的更换
更换电池的工作只有那些已经接受过维修培训和安全培训的人员才能胜任。在打开机柜更换电池时，切勿触碰高压电路部分（标有标记并配有绝缘盖）。触摸不加盖的高压电路，会导致触电。
绝对脉冲编码器靠电池来保存绝对位置的数据。当电池的电压下降时，机床操作面板上或画面上会显示出绝对脉冲编码器的电池电压下降报警。当电池电压下降的报警显示后，应在一周内更换电池。若不更换电池，绝对脉冲编码器内部的绝对位置数据将会丢失。更换电池的方法，请参阅FANUC SERVO MOTOR AMPLIFIER αi series维修说明书。
| A 警告 |
| --- |
| 3 保险丝的更换 |
| 在更换烧断的保险丝之前，应先找到造成保险丝熔断的原因并将它排除。 |
| 因此，只有那些已经接受过维修培训和安全培训的人员才能胜任此项工作。 |
| 在打开机柜更换保险丝时，切勿触碰高压电路部分（标有 ▲ 标记并配有绝缘盖）。 |
| 触摸不加盖的高压电路，会导致触电。 |
# 目录
安全使用须知 s- 1
# I. 概述
1 概述 3
1.1 阅读本说明书时的注意事项 5  1.2 有关各类数据的注意事项 6
# Ⅱ. 编程
1 概述 9
1.1 刀具形状和基于程序的刀具移动 9
2 预备功能（G功能） 10
3 插补功能 14
3.1 螺纹切削（G33） 14
4 坐标值和尺寸 16
4.1 极坐标指令(G15、G16) 16
# 5 为简化编程的功能 20
# 5.1 钻孔固定循环 20
5.1 钻孔固定循环 20  5.1.1 高速钻深孔循环(G73) 24  5.1.2 反向攻丝循环(G74) 26  5.1.3 精密镗孔（G76） 28  5.1.4 钻孔循环，定点镗孔(G81) 29  5.1.5 钻孔循环，镗阶梯孔(G82) 31  5.1.6 钻深孔循环(G83) 32  5.1.7 钻小口径深孔循环(G83) 34  5.1.8 攻丝循环(G84) 38  5.1.9 镗孔循环(G85) 39  5.1.10 镗孔循环(G86) 41  5.1.11 回程镗孔循环（G87） 42  5.1.12 镗孔循环(G88) 44  5.1.13 镗孔循环(G89) 46  5.1.14 钻孔固定循环取消(G80) 47  5.1.15 钻孔固定循环的举例 48  5.1.16 钻孔固定循环主轴速度到达等待时间缩短 50
# 5.2 钻孔固定循环搭接 51
# 5.3 刚性攻丝 56
5.3.1 刚性攻丝(G84) 56
5.3.2 反向刚性攻丝循环(G74) 60
5.3.3 深孔刚性攻丝循环(G84或G74) 63
5.3.4 固定循环取消(G80) 67
5.3.5 刚性攻丝中的倍率 67
5.3.5.1 拉拔倍率 67  5.3.5.2 倍率信号 68
# 5.4 任意角度的倒角和倒圆 69
5.5 分度工作台分度功能 72
# 5.6 模向进给控制(磨床用) 74
# 5.7 磨削用固定循环（磨床用） 77
5.7.1 切入式磨削循环(G75) 78  5.7.2 切入式直接恒定尺寸磨削循环(G77) 81  5.7.3 连续进给表面磨削循环(G78) 83  5.7.4 间歇进给表面磨削循环(G79) 86
# 6 补偿功能 88
# 6.1 刀具长度补偿位移类型 88
# 6.2 刀具长度自动测量（G37） 93
6.3 刀具位置偏置（G45～G48） 95
6.4 刀具径补偿（G40～G42）的概括说明 100
# 6.5 刀尖半径补偿（G40～G42）的概括说明 105
6.5.1 假想刀尖 105  6.5.2 假想刀尖的方向 107  6.5.3 偏置号与补偿值 108  6.5.4 工件位置与移动指令 109  6.5.5 关于刀尖半径补偿的注意事项 114
# 6.6 刀具径补偿或刀尖半径补偿的详细说明 115
6.6.1 概述 115  6.6.2 起刀时的刀具移动 119  6.6.3 偏置模式下的刀具移动 124  6.6.4 偏置模式取消模式下的刀具移动 142  6.6.5 利用刀具的补偿来防止过切 149  6.6.6 干涉检查 152  6.6.6.1 被判断为干涉时的动作 155  6.6.6.2 干涉检查报警功能 155  6.6.6.3 干涉检查避开功能 157  6.6.7 针对来自MDI输入的刀具径补偿或刀尖半径补偿 162
# 6.7 矢量保持（G38） 164
6.8 拐角圆弧插补（G39） 165
6.9 刀具补偿值、补偿值数目和利用程序的刀具补偿值输入（G10） 167
6.10 坐标系旋转（G68、G69） 169
# 7 Series15格式下的存储器运行 176
# 8 用于高速加工的功能 177
8.1 通过程序指令选择精细表面设定的设定模式 177
# Ⅲ. 操作
# 1 显示和设定数据 181
# 1.1 按下功能键 显示的画面 181
1.1.1 显示和设定刀具偏置值 181
1.1.2 刀具长度测量 185
1.1.3 精密表面设定 188
# 附录
# A 程序指令中包含地址P的功能一览 193
A.1 G代码的自变量中包含地址P的功能一览表 193
A.2 M代码、S代码的自变量中包含地址P的功能一览表 195
# I．概述
# 1 概述
本说明书由下列篇幅构成。
# 说明书的描述内容
I.概述
概述中描述本说明书的构成、可以使用的机型、相关说明书、以及阅读说明书时的注意事项。
Ⅱ．编程
编程篇就利用NC语言创建程序时的程序的格式、解释、限制等，针对每一功能进行描述。
III.操作
操作篇中就机床的手动运行和自动运行、数据的输入/输出方法、程序的编辑方法等进行描述。
附录
附录中就参数、指令值范围、报警等各类列表进行描述。
注释1 本说明书仅就可通过加工中心系统的机种（控制类型）动作的功能进行描述。有关非加工中心系统专用的其他功能，请参阅操作说明书（车床系统／加工中心通用）(B- 64604CM)。2 根据机型的不同，本说明书中描述的某些功能可能无法使用。有关详细内容，请参阅规格说明书(B- 64692CM)。3 本说明书中对正文中所叙述内容以外的参数细节不予描述，请参阅PARAMETER MANUAL（参数说明书）(B- 64610CM)。参数中预先设定了CNC机床的功能和动作状态、经常使用的数值。通常，机床制造商已经设定便于用户操作机床的参数。4 本说明书不仅描述基本功能，而且还描述选项功能。用户购买的装置中安装有哪些选项，请参阅机床制造商提供的说明书。
# 可以使用的机型名称
本说明书对作为“纳米CNC”的下列机型进行描述。通过将该机型与高速、高精度的伺服控制相结合，可以构建实现高精度加工的“纳米CNC系统”。另外，正文中还使用下列简称。
| 机型名称 | 简称 |
| --- | --- |
| FANUC Series 0i-MF Plus | 0i-MF Plus |
注释1 为了便于说明，有的情况下按照如下方式分类说明各机型。- 0i- MF Plus：加工中心系统（M系列）2 根据机型的不同，本说明书中描述的某些功能可能无法使用。有关详细内容，请参阅规格说明书(B- 64692CM)。
# 符号说明
正文中使用下列符号。符号的含义如下所示。
# -IP
诸如X_Y_Z_，它们表示任意轴的组合。紧跟地址之后的底划线处，将输入坐标值等数值。（在编程篇中使用）
- 该符号表示程序段结尾。实际上，与ISO代码LF对应，并与EIA代码CR对应。
# Series0i-FPlus的相关说明书
Series0i- FPlus的相关说明书如表1(a)所示。\*表示本说明书。
表1（a) 相关说明书列表  
| 说明书名称 | 规格编号 |  |
| --- | --- | --- |
| 规格说明书 | B-64692CM |  |
| 连接说明书（硬件篇） | B-64693CM |  |
| 连接说明书（功能篇） | B-64693CM-1 |  |
| 操作说明书（车床系统/加工中心系统通用） | B-64694CM |  |
| 操作说明书（车床系统） | B-64694CM-1 |  |
| 操作说明书（加工中心系统） | B-64694CM-2 | * |
| 维修说明书 | B-64695CM |  |
| 参数说明书 | B-64700CM |  |
| 编程相关说明书 |  |  |
| Macro Executor PROGRAMMING MANUAL | B-63943EN-2 |  |
| Macro Compiler PROGRAMMING MANUAL | B-66263EN |  |
| C Language Executor PROGRAMMING MANUAL | B-63943EN-3 |  |
| PMC |  |  |
| PMC PROGRAMMING MANUAL | B-64513EN |  |
| 网络相关说明书 |  |  |
| PROFIBUS-DP Board CONNECTION MANUAL | B-63993EN |  |
| 快速以太网/快速数据服务器操作说明书 | B-64014CM |  |
| DeviceNet Board CONNECTION MANUAL | B-64043EN |  |
| FL-net Board CONNECTION MANUAL | B-64163EN |  |
| CC-Link Board CONNECTION MANUAL | B-64463EN |  |
| 操作指南功能相关说明书 |  |  |
| MANUAL GUIDE i（车床系统/加工中心系统通用）操作说明书 | B-63874CM |  |
| MANUAL GUIDE i（加工中心系统）操作说明书 | B-63874CM-2 |  |
| MANUAL GUIDE i加工前准备支持功能操作说明书 | B-63874CM-1 |  |
| MANUAL GUIDE 0i 操作说明书 | B-64434CM |  |
| 双重安全性检查 | — |  |
| Dual Check Safety CONNECTION MANUAL | B-64483EN-2 |  |
# 伺服电机相关说明书
伺服电机  $\alpha i / \beta i$  的相关说明书如表1(b)所示
表1（b）SERVOMOTORai/Biseries的相关说明书  
| 说明书名称 | 规格编号 |
| --- | --- |
| FANUC AC SERVO MOTOR αi-B series FANUC AC SERVO MOTOR αi series 规格说明书 | B-65262CM |
| FANUC AC SPINDLE MOTOR αi-B / βi-B series 规格说明书 | B-65452CM |
| FANUC AC SERVO MOTOR βi-B series FANUC AC SERVO MOTOR βi series 规格说明书 | B-65302CM |
| FANUC SERVO AMPLIFIER αi series 规格说明书 | B-65282EN |
| FANUC SERVO AMPLIFIER βi series 规格说明书 | B-65322EN |
| FANUC AC SERVO MOTOR αi series FANUC AC SPINDLE MOTOR αi series FANUC SERVO AMPLIFIER αi series 维修说明书 | B-65285CM |
| FANUC AC SERVO MOTOR βi series FANUC AC SPINDLE MOTOR βi series FANUC SERVO AMPLIFIER βi series 维修说明书 | B-65325CM |
| FANUC AC SERVO MOTOR αi-B/αi series FANUC AC SERVO MOTOR βi-B/βi series FANUC LINEAR MOTOR LIS-B/LiS series FANUC DD MOTOR DiS-B/DiS series 参数说明书 | B-65270CM |
| FANUC AC SPINDLE MOTOR αi/βi series, BUILT-IN SPINDLE MOTOR Bi series 参数说明书 | B-65280CM |
本说明书中描述的CNC上，可以连接上述伺服电机和主轴电机。本说明书主要就FANUC SERVO MOTOR αi series进行描述，而有关伺服电机和主轴电机，请另行参阅与实际连接的伺服电机和主轴电机相对应的说明书。
# 1.1 阅读本说明书时的注意事项
1 作为CNC机床系统的功能，并非仅由CNC决定，而是通过机床、机床端强电回路、伺服系统、CNC、操作面板等的组合决定的。这里不可能全部描述这些装置组合时的功能、编程和操作。本说明书以CNC为基准进行概要描述，有关不同类型CNC机床的说明，请仔细阅读机床制造商提供的相关说明书。就说明书中所载事项，机床制造商提供的说明书优先于本说明书。2 本说明书的每页上边都标有小标题，这是为便于读者查阅必要事项。读者可以先查找小标题，然后再查阅所需的内容。3 我们试图在本说明书中叙述尽可能多的情况。然而，要在本说明书中注明所有禁止或不可做的事宜，需要占用说明书的大量篇幅，所以本说明书中没有一一列举。因此，对于那些在说明书中没有特别指明可以做的事，都应解释为“不可做”。
# 1.2 有关各类数据的注意事项
注意加工程序、参数、偏置数据等，存储在CNC装置内部的永久性存储器中。这些数据通常不会因为电源的接通/断开而丢失。但是，有时会因为错误注意而将这些数据删除掉，或者在修复故障时，不得不清除永久性存储器中的全部数据。当发生此类不测的事态时，为了尽快恢复正常，事先应留下各类数据的备份。存储加工程序的永久性存储器中，写入次数受到限制。在每次进行加工时从上位的电脑自动下载加工程序的使用方法等、频繁地反复进行加工程序的登录或删除这样的使用方法的情况下，务必使用“高速程序管理”。“高速程序管理”中，在进行程序的登录、变更或删除时，不会向永久性存储器进行保存。
# 1.1 刀具形状和基于程序的刀具移动
# 解释
# ·在刀具的底面加工一刀具长度补偿功能
通常加工一个工件要用几个刀具。
每个刀具都具有其不同的长度。根据刀具而改变程序，是一件非常麻烦的事情。
因此，通过事先测量每个刀具的长度，例如，在CNC上设定与标准刀具之差（请参阅操作说明书（T系列/M系列通用）(B- 64694CM)的“数据的显示与设定”项），即使在换刀后，也可不必改变程序地进行加工。此功能叫做刀具长度补偿功能。（请参阅编程篇“补偿功能”的“刀具长度补偿”项。）
![](images/fd3bd5b839a743ff5edd1f7a6b8aa940bc6d422798272f2a8838a123a0c04754.jpg)
# ·在刀具的侧面加工一刀具径补偿功能
![](images/6e02aa7cf1ae0570c48354582f5eda44f8e01484e3c6d896ecfc15606d4b2886.jpg)
由于刀具具有半径，因此，通常对于加工形状，刀具路径处在仅偏离半径的位置。
通过事先将刀具的半径登录在CNC中（请参阅操作说明书（T系列/M系列通用）(B- 64694CM)的“数据的显示与设定”项），针对加工形状，可以沿着仅偏离刀具半径的路径使刀具移动。此功能叫做刀具径补偿功能。（请参阅“补偿功能”的项）
# 2 预备功能（G功能）
预备功能的指令由紧接地址G后的数值来表述，并决定包含在程序段中的指令的含义。G代码分为以下两种类型。
| 类别 | 含义 |
| --- | --- |
| 单步G代码 | 只在被指定的程序段中才有效的G代码 |
| 模态G代码 | 直到相同组中的其他G代码被指定之前有效的G代码 |
（例）G01和G00是模态G代码。G01X ；Z ；X ；G00Z ；X ；G01X ；
1. 当接通电源或机床被复位时，如果机床进入清零状态（参数CLR（No.3402#6）），模态G代码就变为如下状态。
（1）变为表2中带有
![](images/79472edfe41bca2ea828fa794f6350af21c98601182c21e68c1ca1d3e7dc3f42.jpg)
符号的G代码的状态。
(2）当系统由于接通电源或复位而清零时，G20和G21保持不变。
(3）可以用参数G23(No.3402#7)表示接通电源后是选择G22还是选择G23。在复位的清零状态下，并不影响对G22或G23。
(4）G00和G01，可以根据参数G01(No.3402#0)设定处在哪个G代码的状态。
(5）G90和G91，可以根据参数G91(No.3402#3)设定处在哪个G代码的状态。
(6）G17、G18以及G19可以由参数G18(No.3402#1)以及参数G19（No.3402#2）来设定处在哪个G代码的状态。
2. 00组中的G代码除G10和G11外，都是单步G代码。
3. 当指定的G代码不在G代码表中或没有相对应的选项时，将会发生报警(PS0010）“指定了无法使用的G代码”。
4. 在相同程序段中可指定不同组的多个G代码。
如果在相同程序段中指定了多个相同组的G代码，则最后指定的那个G代码有效。
5. 在钻孔固定循环中如果指定01组的G代码，则取消钻孔固定循环。即，变为与指定了G80相同的状态。01组的G代码不受用来指定钻孔固定循环的G代码的影响。
6. G代码显示每组编号。
7. G60的组通过参数MDL（No.5431#0）来切换。（MDL=0:00组，MDL=1:01组）
表2G代码列表  
| 代码 | 组 | 含义 |
| --- | --- | --- |
| G00 | 01 | 定位（快速进给） |
| G01 | 直线插补（切削进给） |  |
| G02 | 圆弧插补/螺旋插补 CW |  |
| G03 | 圆弧插补/螺旋插补 CCW |  |
| G04 | 00 | 暂停 |
| G04.1 | 基于G代码的掩码缓冲器 |  |
| G05 | AI轮廓控制（高精度轮廓控制兼容指令） |  |
| G05.1 | AI轮廓控制 |  |
| G05.4 | HRV3 接通/断开 |  |
| G07.1 | 00 | 圆柱插补 |
| G08 | AI轮廓控制（先行控制兼容指令） |  |
| G09 | 精确停止 |  |
| G10 | 可编程数据输入 |  |
| G10.6 | 刀具回退和返回 |  |
| G11 | 可编程数据输入取消 |  |
| G15 | 17 | 极坐标指令取消 |
| G16 | 极坐标指令 |  |
| G17 | 02 | XpYp 平面 |
| G18 | ZpXp 平面 |  |
| G19 | YpZp 平面 |  |
| G20(G70) | 06 | 英制输入 |
| G21(G71) | 米制输入 |  |
| G22 | 04 | 存储行程检查功能 ON |
| G23 | 存储行程检查功能 OFF |  |
| G25 | 19 | 主轴速度变动检测 OFF |
| G26 | 主轴速度变动检测 ON |  |
| G27 | 00 | 参考点返回检查 |
| G28 | 自动返回至参考点 |  |
| G28.2 | 到位检测无效、参考点返回 |  |
| G29 | 从参考点移动 |  |
| G30 | 第2、第3、第4参考点返回 |  |
| G30.2 | 到位检测无效、第2、第3、第4参考点返回 |  |
| G31 | 跳转功能 |  |
| G31.8 | EGB 轴跳过 |  |
| G33 | 01 | 螺纹切削 |
| G37 | 00 | 刀具长度自动测定 |
| G38 | 刀具径补偿或刀尖半径补偿：保持矢量 |  |
| G39 | 刀具径补偿或刀尖半径补偿：拐角圆弧插补 |  |
| G40 | 07 | 刀具径补偿或刀尖半径补偿取消 |
| G41 | 刀具径补偿或刀尖半径补偿：左 |  |
| G42 | 刀具径补偿或刀尖半径补偿：右 |  |
| G40.1 | 18 | 法线方向控制取消模式 |
| G41.1 | 法线方向控制左侧 ON |  |
| G42.1 | 法线方向控制右侧 ON |  |
| G43 | 08 | 刀具长度补偿+ |
| G44 | 刀具长度补偿- |  |
| G43.7 | 刀具位置偏置 |  |
| G45 | 00 | 刀具位置偏置 伸长 |
| G46 | 刀具位置偏置 缩小 |  |
| G47 | 刀具位置偏置 伸长2倍 |  |
| G48 | 刀具位置偏置 缩小2倍 |  |
| G49(G49.1) | 08 | 刀具长度补偿取消 |
| 代码 | 组 | 含义 |
| --- | --- | --- |
| G50 | 11 | 比例缩放取消 |
| G51 | 比例缩放 |  |
| G50.1 | 22 | 可编程镜像取消 |
| G51.1 | 可编程镜像 |  |
| G50.4 | 00 | 同步控制结束 |
| G50.5 | 混合控制结束 |  |
| G50.6 | 重叠控制结束 |  |
| G51.4 | 同步控制开始 |  |
| G51.5 | 混合控制开始 |  |
| G51.6 | 重叠控制开始 |  |
| G52 | 局部坐标系设定 |  |
| G53 | 机床坐标系选择 |  |
| G53.1 | 刀具轴向控制 |  |
| G53.2 | 基于进给速度指令的机床坐标系选择 |  |
| G53.6 | 刀具前端点保持型刀具轴向控制 |  |
| G54(G54.1) | 14 | 工件坐标系1选择 |
| G55 | 工件坐标系2选择 |  |
| G56 | 工件坐标系3选择 |  |
| G57 | 工件坐标系4选择 |  |
| G58 | 工件坐标系5选择 |  |
| G59 | 工件坐标系6选择 |  |
| G60 | 00 | 单向定位 |
| G61 | 15 | 精确停止模式 |
| G62 | 自动拐角倍率 |  |
| G63 | 攻丝模式 |  |
| G64 | 切削模式 |  |
| G65 | 00 | 宏程序调用 |
| G66 | 12 | 宏模态调用A |
| G66.1 | 宏模态调用B |  |
| G67 | 宏模态调用A/B取消 |  |
| G68 | 16 | 坐标系旋转或三维坐标变换模式ON |
| G69 | 坐标系旋转或三维坐标变换模式OFF |  |
| G68.2 | 倾斜面分度指令 |  |
| G68.3 | 基于刀具轴方向的倾斜面分度指令 |  |
| G68.4 | 倾斜面分度指令（增量多重指令） |  |
| G72.1 | 00 | 图形复制（旋转复制） |
| G72.2 | 图形复制（平行复制） |  |
| G73 | 09 | 钻深孔循环 |
| G74 | 反向攻丝循环 |  |
| G75 | 01 | 切入式磨削循环 |
| G76 | 09 | 精密镗孔循环 |
| G77 | 01 | 切入式直接恒定尺寸磨削循环 |
| G78 | 连续进给表面磨削循环 |  |
| G79 | 间歇进给表面磨削循环 |  |
| G80 | 09 | 固定循环取消/电子齿轮箱同步取消 |
| G80.4 | 34 | 电子齿轮箱同步取消 |
| G81.4 | 电子齿轮箱同步开始 |  |
| G80.5 | 24 | 电子齿轮箱2组同步取消 |
| G81.5 | 电子齿轮箱2组同步开始 |  |
| 代码 | 组 | 含义 |
| --- | --- | --- |
| G81 | 09 | 钻孔循环、点镗孔循环/电子齿轮箱同步开始 |
| G81.1 | 00 | 高精度振荡功能 |
| G82 | 03 | 钻孔循环、镗阶梯孔循环 |
| G83 | 钻深孔循环 |  |
| G84 | 攻丝循环 |  |
| G84.2 | 刚性攻丝循环（FS15格式） |  |
| G84.3 | 反向刚性攻丝循环（FS15格式） |  |
| G85 | 09 | 镗孔循环 |
| G86 | 镗孔循环 |  |
| G87 | 回程镗孔循环 |  |
| G88 | 镗孔循环 |  |
| G89 | 镗孔循环 |  |
| G90 | 03 | 绝对指令 |
| G91 | 增量指令 |  |
| G91.1 | 00 | 最大增量指令值检测 |
| G92 | 工件坐标系的设定/主轴最高转速钳制 |  |
| G92.1 | 工件坐标系预设 |  |
| G93 | 05 | 反比时间进给 |
| G94 | 每分钟进给 |  |
| G95 | 每转进给 |  |
| G96 | 13 | 周速恒定控制 |
| G97 | 周速恒定控制取消 |  |
| G96.1 | 00 | 主轴分度执行（有完成等待） |
| G96.2 | 主轴分度执行（无完成等待） |  |
| G96.3 | 主轴分度完成确认 |  |
| G96.4 | SV旋转控制模式ON |  |
| G98 | 10 | 固定循环基准平面返回 |
| G99 | 固定循环R点平面返回 |  |
| G107 | 00 | 圆柱插补 |
| G160 | 20 | 横向进给控制取消 |
| G161 | 横向进给控制 |  |
# 3 插补功能
# 3.1 螺纹切削（G33）
可以切削等导程的直线螺纹。主轴转速可从安装在主轴上的位置编码器实时读得，并被转换为用来移动刀具的每分钟切削进给速度后发送给刀具。
# 格式
![](images/81606cf95b5884e27d4e117d2689cc96211a3761bb409fbffd3b0f969d21cfc7.jpg)
通常在制作一个螺纹时，从粗削到精削，沿着相同路径重复进行螺纹切削。
安装在主轴上的位置编码器与一转信号同步开始，所以即使重复进行螺纹切削，刀具在工件圆周上的切削起点和刀具的路径相同。但是，值得注意的是，主轴转速从粗削到精削须保持恒定不变。当主轴的转速变化时，将导致螺纹偏斜。由于伺服系统等的滞后，在螺纹切削的起点和终点将产生一些导程差，考虑到该值，加工的螺纹长度常比所指定的稍长些。
表3.1(a)中列出了螺纹导程的指令范围。
表3.1（a）导程的指令范围  
|  | 最小移动单位 | 可指定的导程范围 |
| --- | --- | --- |
| 米制输入 | 0.001 mm | F1～F50000 (0.01～500.00mm) |
| 0.0001 mm | F1～F50000 (0.01～500.00mm) |  |
| 英制输入 | 0.0001 inch | F1～F99999 (0.0001～9.9999inch) |
| 0.00001 inch | F1～F99999 (0.0001～9.9999inch) |  |
注释1 进行螺纹切削的主轴的转速有以下限制。  0<主轴的转速  $\leq$  （进行螺纹切削的轴的最大切削进给速度（每分钟的速度））  /（螺纹的导程（1转相应的长度））但是，主轴的转速：  $\mathrm{min^{- 1}}$   螺纹的导程：mm或inch  最大切削进给速度：  $\mathrm{mm / min}$  或inch/min，每分钟进给的最大指令值与电机及机床的限制下的最大切削进给速度中较小的值  2 螺纹切削中，不应用切削进给速度倍率，固定为  $100\%$   3 对转换的切削进给速度应用切削进给速度夹紧。  4 进给保持在螺纹切削中无效。如果在螺纹切削中按下进给保持按键，将在螺纹切削结束后（变为非G33模式）的下一个程序段的终点停止。  5 由于自动加减速的原因，螺纹切削中会产生导程不正确的部分。因此编程时需留有一定距离的宽裕。距离的计算方法请参阅操作说明书（车床系统/加工中心系统通用）“不完整的螺纹部分计算方法”（B- 64694CM）。
# 限制事项
# 刀具回退和返回
限制事项- 刀具回退和返回如果为螺纹切削的长轴指定了后退轴，则不执行后退。在执行非螺纹切削的程序段后，将发生报警（PS0429）“G10.6非法指令”并停止。
# 例
例导程  $1.5\mathrm{mm}$  的螺纹切削  G33 Z10. F1.5;
![](images/8cfd4501bdc2287d6b2df9c23faed6be1e6a0cfb6cc5d8425edd2ab48783c24e.jpg)
# 4 坐标值和尺寸
# 4.1 极坐标指令 (G15、G16)
可以在半径和角度的极坐标上输入终点坐标值。从指定极坐标指令的平面的第一轴的  $+$  方向，沿逆时针方向的角度为正，沿顺时针方向的角度为负。此外，在绝对指令/增量指令(G90、G91)下都可以指定半径和角度。
![](images/5ad18d136ff872f1f9252916100396f77358f03643eb38f9efd1250fd99d08d9.jpg)
# - 将工件坐标系的原点设为极坐标的中心时
以绝对值指定半径值。程序坐标系的原点变为极坐标的中心。
![](images/dae56985b104c7fabbe15bf919561f63befc85af61234032d80cbccff7ce94ac.jpg)
# - 将当前位置设为极坐标的中心时
以增量值指定半径值。当前位置被设为极坐标的中心。
![](images/e332b67139671eb564759b21f41ef499c03782063eef1111c1295a2b533a47c9.jpg)
# - 省略平面第1轴（半径）或者平面第2轴（角度）的指令时的动作
遵从参数PCC(No.10351#5)。
（PCC = 0（FS0i规格），PCC = 1（FS16i兼容规格））
# 极坐标的中心
极坐标的中心按照表4.1(a)而决定。
表4.1（a） 极坐标中心的决定  
|  | PCC = 0 | PCC = 1 |
| --- | --- | --- |
| G16 指令时 | 程序坐标系的原点 |  |
| 复位后的极坐标指令时（※1） | 但是，模态为 G91 并具有平面第 1 轴（半径）的指令时，极坐标的中心为当前位置。 |  |
| 改变所选平面时 (G17, G18, G19) | 例：G16 G91 G00 X20.0 Y30.0 |  |
| 模态为 G90 并具有平面第 1 轴（半径）的指令时 | 程序坐标系的原点 |  |
| 模态为 G91 并具有平面第 1 轴（半径）的指令时 | 当前位置 |  |
| 没有平面第 1 轴（半径）的指令 但具有平面第 2 轴（角度）的指令时 | 本指令前的极坐标的中心在程序坐标系的原点的情形（※2） | 程序坐标系的原点 |
| 本指令前的极坐标的中心在当前位置的情形（※3） | 当前位置 由于半径也为 0，因此轴不会因该指令而移动。 |  |
| 没有平面第 1 轴（半径）、平面第 2 轴（角度）的指令时 | 由于不会被视为极坐标指令，因而无法决定极坐标的中心。 |  |
※1表示在极坐标指令模式中复位后，继续进行极坐标指令的情形复位状态（参数CLR(No.34026)为0）时，可进行此操作。
（例）G16 G90 G00 X100.0 Y45.0复位G91 Y60.0 复位后继续进行极坐标指令
※2表示如下含义。
（1）利用G16或G90来指令平面第1轴（半径）。（2）程序坐标系的原点变为极坐标的中心。（3）之后，在无平面第1轴（半径）的指令下指令平面第2轴（角度）。
（例）G16 极坐标的中心为程序坐标系的原点G91 Y60.0 无平面第1轴（半径）的指令而有平面第2轴（角度）的指令
※3表示如下含义。
（1）利用G91来指令平面第1轴（半径）。（2）当前位置变为极坐标的中心。（3）之后，在无平面第1轴（半径）的指令下指令平面第2轴（角度）。
（例）
G16G91 X30.0 Y30.0 极坐标的中心为当前位置G90 Y40.0 无平面第1轴（半径）的指令而有平面第2轴（角度）的指令
# 半径和角度
如下情况下，半径和角度分别按照表4.1(b)进行设定。
- G16指令时- 复位后的极坐标指令时- 改变所选平面时(G17,G18,G19)
表4.1（b）半径和角度  
|  | PCC = 0 | PCC = 1 |
| --- | --- | --- |
| G16 指令时 | 半径/角度变为 0。 同时指令半径/角度时变为指令值。 (例) G90 G00 X50.0 Y50.0 G16 .............. Y60.0 .............. 因此,向(X:0.0,Y:0.0)移动。 | 由当前位置计算半径/角度。 G16 ....... 距当前位置(X:50.0,Y:50.0) 半径 70.710 角度 45.0° 因此,向(X:35.355,Y:61.237)移动。 |
| 改变所选 平面时 (G17,G18,G19) | 半径/角度变为 0。 G90 G16 G17 X100.0 Y30.0 ...  G19 Z40.0 ...  因此,向(Y:0.0,Z:0.0)移动。 | 继承半径/角度。 因此,向(Y:76.604,Z:64.279)移动。 |
螺栓孔循环
![](images/c8a597ce9700554cd8da23f557470896d314ed97a58ba763e5b6f520dc2c93ae.jpg)
# 半径值和角度为绝对指令时
N1 G17 G90 G16;
N2 G81 X100.0 Y30.0 Z- 20.0 R- 5.0 F200.0; N3 Y150.0; N4 Y270.0; N5 G15 G80;
极坐标指令、X- Y平面选择极坐标的原点为程序坐标系的原点半径  $100\mathrm{mm}$  、角度30deg半径  $100\mathrm{mm}$  、角度150deg半径  $100\mathrm{mm}$  、角度270deg极坐标指令取消
# 半径值为绝对指令而角度为增量指令时
半径值为绝对指令而角度为增量指令时N1 G17 G90 G16; 极坐标指令、X- Y平面选择极坐标的原点为程序坐标系的原点N2 G81 X100.0 Y30.0 Z- 20.0 R- 5.0 F200.0; 半径  $100\mathrm{mm}$  、角度30degN3 G91 Y120.0; 半径  $100\mathrm{mm}$  、角度  $+120\mathrm{deg}$ N4 Y120.0; 半径  $100\mathrm{mm}$  、角度  $+120\mathrm{deg}$ N5 G15 G80; 极坐标指令取消
限制事项- 极坐标模式下半径编程在极坐标模式下，用R指令来指定圆弧插补、螺旋插补(G02、G03)的半径。
# ·在极坐标模式下不被视为极坐标指令的轴指令
有关伴有如下指令的轴指令，不会被视为极坐标指令。不进行基于极坐标指令的指令值的变换而动作。
暂停(G04)可编程数据输入(G10)局部坐标系设定(G52)工件坐标系变更(G92)机床坐标系的选择(G53)存储行程检查(G22)坐标旋转(G68)比例缩放(G51)刀具回退&返回(G10.6)工件坐标系预设(G92.1)图形复制（G72.1，G72.2）圆柱插补(G07.1，G107)可编程镜像(G51.1)
# ·旋转轴
·旋转轴极坐标指令在平面的第1轴和第2轴中指令。无法在已经设定为旋转轴的轴中进行极坐标指令。
# ·并用时受到限制的功能
以下功能与极坐标指令并用时受到限制。有关限制事项的详情，请参阅各功能的说明章节。
回退英制/公制转换
# ·无法并用的功能
以下的功能无法与极坐标指令并用。
AI轮廓控制倾斜面分度指令Cs轮廓控制任意角度的倒角/倒圆
注释极坐标模式下不被视为极坐标指令的轴指令、并用时受到限制的功能、以及无法并用的功能，伴随CNC的功能追加，有可能会被变更或追加。
# 5 为简化编程的功能
# 5.1 钻孔固定循环
# 概述
钻孔固定循环可以用包含G代码的一个程序段，这样便可省掉通常要用多个程序段来指定使用频率较高的几个加工动作。因此，可以简化编程。同时可以减小程序，从而有效使用存储器。
表5.1(a)是钻孔固定循环的列表。
表5.1(a) 钻孔固定循环列表  
| G代码 | 钻孔动作
(-Z方向) | 在孔底位置的动作 | 退刀动作
(+Z方向) | 用途 |
| --- | --- | --- | --- | --- |
| G73 | 间歇进给 | ----- | 快速进给 | 高速钻深孔循环 |
| G74 | 切削进给 | 暂停→主轴正转(CW) | 切削进给 | 反向攻丝 |
| G76 | 切削进给 | 主轴定向 | 快速进给 | 精密镗孔 |
| G80 | ----- | ----- | ----- | 取消 |
| G81 | 切削进给 | ----- | 快速进给 | 钻孔、定点镗孔 |
| G82 | 切削进给 | 暂停 | 快速进给 | 钻孔、梯阶镗孔 |
| G83 | 间歇进给 | ----- | 快速进给 | 钻深孔循环 |
| G84 | 切削进给 | 暂停→主轴逆转 | 切削进给 | 干涉 |
| G85 | 切削进给 | ----- | 切削进给 | 镗孔 |
| G86 | 切削进给 | 主轴停止 | 快速进给 | 镗孔 |
| G87 | 切削进给 | 主轴正转 | 快速进给 | 回程镗孔 |
| G88 | 切削进给 | 暂停→主轴停止 | 手动 | 镗孔 |
| G89 | 切削进给 | 暂停 | 切削进给 | 镗孔 |
钻孔固定循环由下列6个动作顺序组成。动作1 X、Y轴的定位（有可能变为其它轴。）动作2 快速进给到R点平面动作3 钻孔动作4 在孔底位置的动作动作5 退刀至R点平面动作6 快速进给到基准平面
![](images/d5533a1308f02e8baca9f039e09c1788b1586baaa8844c7b57db79771ff6608b.jpg)  
图5.1(a) 钻孔固定循环的动作顺序
# ·定位平面
定位平面由G17、G18、G19的平面选择方式决定。定位轴是钻孔轴以外的轴。
# ·钻孔轴
虽然钻孔固定循环除包含钻孔循环外还包含攻丝循环和镗孔循环，本章中，为了统一名称，将其称为钻孔。钻孔轴是不构成定位平面的基准轴(X、Y或Z)或者该平行轴。用来作为钻孔轴的基准轴或平行轴是按钻孔轴地址决定的(指定在与G73～G89的G代码相同的程序段中)。如果没有指定钻孔轴的轴地址，基准轴被假定为钻孔轴。
表5.1（b）定位平面和钻孔轴  
| G代码 | 定位平面 | 钻孔轴 |
| --- | --- | --- |
| G17 | Xp-Yp 平面 | Zp |
| G18 | Zp-Xp 平面 | Yp |
| G19 | Yp-Zp 平面 | Xp |
Xp：X轴或X轴的平行轴 Yp：Y轴或Y轴的平行轴 Zp：Z轴或Z轴的平行轴
假定在参数(No.1022)中设定U、V、W分别为X、Y、Z的平行轴。
G17 G81 Z_： 钻孔轴为Z轴 G17 G81 W_： 钻孔轴为W轴 G18 G81 Y_： 钻孔轴为Y轴 G18 G81 V_： 钻孔轴为V轴 G19 G81 X_： 钻孔轴为X轴 G19 G81 U_： 钻孔轴为U轴
也可以不将G17、G18、G19指定在与G73～G89相同的程序段中。
请在暂时取消钻孔固定循环后再切换钻孔轴。
通过参数FXY(No.5101#0)，可以将Z轴始终设为钻孔轴。当FXY为0时，Z轴始终为钻孔轴。
# - 钻孔轴移动量 G90/G91
钻孔轴方向的移动量根据G90和G91的指令，如图5.1(b)所示。
![](images/3680176909a4193b16da2d7fa88f4d01625c958739c5f1ff970e03f8caeecfae.jpg)  
图5.1(b) 绝对指令和增量指令
# - 钻孔模式
G73/G74/G76/G81～G89是模态G代码，且在被取消之前保持有效。我们将此称为钻孔模式。一旦在钻孔模式下指定钻孔数据，则在改变或取消之前该数据保持不变。因此，在固定循环开始时指定全部所需的钻孔数据，在固定循环过程中，只能指定将要变更的数据。
# - 返回点平面 G98/G99
使刀具从孔底返回到R点平面，还是返回到基准平面，由G98、G99来指定。图5.1(c)示出指定G98或G99时的动作。通常，最初的钻孔使用G99，最后的钻孔使用G98。即使在G99模式中执行钻孔操作，基准平面也不会改变。
![](images/c1dc0c366756a7981e78feec93f46bc640627c5f9c001577e7f720c4bb4512c0.jpg)  
图5.1(c) 基准平面和R点平面
# - 退刀量
退刀量指令使用带逗号的地址D指定。指定未指定“,D”的固定循环时，退刀量的参数变为有效。可指定的固定循环如表5.1(c)所示。如果程序未指定退刀量d，则使用参数设定的退刀量。请在执行钻孔动作的程序段中指定“,D”。在钻孔固定循环中存储为模态的指令。“,D”可输入小数点。
表5.1（c） 退刀量指令可用的钻孔固定循环列表  
| G代码 | 功能 | 无“,D”指令时使用的
退刀量、余隙的参数 |
| --- | --- | --- |
| G73 | 高速钻深孔循环 | No.5114 |
| G74, G84 | 高速深孔刚性攻丝循环 深孔刚性攻丝循环 | No.5213 |
| G83 | 钻深孔循环 | No.5115 |
| 钻小口径深孔循环 | No.5174 |  |
| G84.2 | 刚性攻丝循环（FS15格式） | No.5213 |
| G84.3 | 反向刚性攻丝循环（FS15格式） | No.5213 |
# ·重复
·重复想要重复等距离的钻孔时，用K指定重复次数。K只在它被指定的程序段中有效。以增量方式(G91)指定第一个孔的位置。如果以绝对方式(G90)来指定它，钻孔在同一个孔位置重复。

如果K0被指定，钻孔数据被存储，但不钻孔。

# ·单程序段
·单程序段在单程序段进行孔加工循环时，控制装置在图5.1(a)的动作1、2、6的终点分别停止。因此，为了钻1个孔而需要启动3次。在动作1、2的终点，进钻保持指示灯点亮并停止操作。在动作6的终点，如果近留下重复次数，则通过进钻保持停止，如果没有留下重复次数，则在单程序段停止状态下停止。另外，G87的R点不会停止。G88在Z点暂停后也停止。
# ·取消
用G80或01组G代码，取消固定循环。
组01的G代码G00： 定位（快速进给）G01： 直线插补G02： 圆弧插补或螺旋插补（顺时针方向）G03： 圆弧插补或螺旋插补（逆时针方向）
# ·图中符号说明
下面说明各固定循环。在这些说明中所使用的图像用下列符号来表示。
| - - - | 定位（快速进给G00） |
| --- | --- |
|  | 切削进给（直线插补G01） |
|  | 手动进给 |
|  | 主轴定向（主轴停止在固定的旋转位置） |
|  | 位移（快速进给G00） |
|  | 暂停 |
# 5.1.1 高速钻深孔循环(G73)
此循环进行高速钻深孔操作。该循环以间歇方式切削进给到达孔底，一边将金属切屑从孔中清除出去，一边进行加工。
| G73 X_Y_Z_R_Q_D_F_K_; |  |
| --- | --- |
| X_Y_:  孔位置数据 Z      :  从R点到孔底的距离 R      :  从基准平面到R点的距离 Q      :  每次的进刀量 ,D      :  退刀量 F      :  切削进给速度 K      :  重复次数（仅限需要重复时） |  |
| G73(G98) | G73(G99) |
| 初始平面 | R点 |
| R点 | q |
| q | q |
| q | q |
| q | q |
| q | q |
| q | q |
| q | q |
# ·动作
高速钻深孔循环沿Z轴方向进行间歇进给，金属切屑很容易从孔中清除，可以设定较小的退刀量，这就使得钻孔能有效进行。退刀量d可以指令“,D”，或在参数(No.5114)中设定。刀具以快速进给的方式收回。
# ·主轴的旋转
在指定G73之前，利用辅助功能（M代码）使主轴旋转。
# ·辅助功能
当在相同程序段中指定G73指令和M代码时，在最初的定位操作时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
# ·刀具长度补偿
当在钻孔固定循环中指定了刀具长度补偿时(G43、G44、G49)时，在向R点定位时应用该补偿。
# 轴的切换
在切换钻孔轴之前，请暂时取消钻孔固定循环。
# ·钻孔
在没有包含X、Y、Z、R、或任何其他附加轴的程序段中不钻孔。
# Q
请在进行钻孔动作的程序段中指定Q。如果被指定在不执行钻孔操作的程序段中，则不被当作模态数据存储。
请勿在包含G73的程序段中指定01组的G代码（  $\mathrm{G00\sim G03}$  等）。否则，G73将被取消。
# ·刀具位置偏置
在钻孔固定循环模式下，刀具位置偏置被忽略。
M3 S2000; G90 G99 G73 X300.0 Y- 250.0 Z- 150.0 R- 100.0 Q15.0 F120; Y- 550.0; Y- 750.0; X1000.0; Y- 550.0; G98 Y- 750.0; G80 G28 G91 X0 Y0 Z0; M5;
主轴起动定位后，钻孔1，然后返回到R点平面定位后，钻孔2，然后返回到R点平面定位后，钻孔3，然后返回到R点平面定位后，钻孔4，然后返回到R点平面定位后，钻孔5，然后返回到R点平面定位后，钻孔6，然后返回到基准平面返回到参考点主轴停止
# 5.1.2 反向攻丝循环 (G74)
该循环可以进行反向攻丝操作。主轴在孔底正转，执行反向攻丝循环。
![](images/e5183b1f734515e8c2417c04abc1815b23d6444d0aa589103aaf872a82a9c3b7.jpg)
使主轴反转进给，当到达孔底时，主轴正转并退刀，进行反向攻丝。
在反向攻丝动作中，忽略进给速度倍率，在完成返回动作之前，进给保持不会使机床停止。
在指定G74之前，利用辅助功能（M代码）使主轴反转。连续执行从孔位置和基准平面到R点平面的距离较短的钻孔动作时，在进入孔的切削动作之前，主轴有可能无法进行正常旋转。在这种情况下，请勿指定重复次数K，而需要将基于G04的暂停插入到每个钻孔动作之前以腾出时间。有的机床不必考虑上述情况，详情请参阅机床制造商提供的说明书。
当在相同程序段中指定G74指令和M代码时，在最初的定位时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
# ·P
·P请在进行钻孔动作的程序段中指定P。如果被指定在不执行钻孔操作的程序段中，则不被当作模态数据存储。
·取消请勿在包含G74的程序段中指定01组的G代码（G00～G03等）。否则，G74将被取消。
例M4 S100；G90 G99 G74 X300.0 Y- 250.0 Z- 150.0 R - 120.0 F120；Y- 550.0；Y- 750.0；X1000.0；Y- 550.0；G98 Y- 750.0；G80 G28 G91 X0 Y0 Z0；M5；
主轴起动
主轴起动定位后，加工螺纹孔1，然后返回到R点平面定位后，加工螺纹孔2，然后返回到R点平面定位后，加工螺纹孔3，然后返回到R点平面定位后，加工螺纹孔4，然后返回到R点平面定位后，加工螺纹孔5，然后返回到R点平面定位后，加工螺纹孔6，然后返回到基准平面返回到参考点主轴停止
# 5.1.3 精密镗孔（G76）
该循环用来进行高精度的镗孔。主轴在到达孔底时停止，刀具离开工件的表面后收回。
![](images/8f817004a4930f9d46fe8c555f774d53164e93cab03a73b083f91b1d7729d9ed.jpg)
·动作
当刀具到达孔底时，主轴停止在固定的旋转位置，刀具与刀尖反向移动并且收回，这样能保证加工表面不受损伤，实现精确和有效的镗孔加工。
在指定G76之前，利用辅助功能（M代码）使主轴旋转。
当在相同程序段中指定G76指令和M代码时，在最初的定位时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
当在钻孔固定循环中指定了刀具长度补偿时(G45、G44、G49)时，在向R点定位时应用该补偿。
# ·轴的切换
# P,Q
P,QQ的值必须以正值予以指定。即使以负值指定，符号也将被忽略。在参数(No.5148)中设定位移的方向。在进行钻孔动作的程序段中指定P和Q。如果被指定在不执行钻孔操作的程序段中，则不被当作模态数据存储。
注意Q(在孔底的位移量)是保留在钻孔固定循环中的模态信息，指定时必须注意，因为它还可以被G73、G83当做进刀量使用。
# 取消
取消请勿在包含G76的程序段中指定01组的Q代码（  $\mathrm{G00\sim G03}$  等）。否则，G76将被取消。
# 刀具位置偏置
例M3 S500; G90 G99 G76 X300.0 Y- 250.0 Z- 150.0R- 120.0Q5.0 P1000 F120. ; Y- 550.0; Y- 750.0; X1000.0; Y- 550.0; G98 Y- 750.0; G80 G28 G91 X0 Y0 Z0; M5;
主轴起动定位后，钻孔1，然后返回到R点平面在孔底定向后位移5mm在孔底停止1秒钟定位后，钻孔2，然后返回到R点平面定位后，钻孔3，然后返回到R点平面定位后，钻孔4，然后返回到R点平面定位后，钻孔5，然后返回到R点平面定位后，钻孔6，然后返回到基准平面返回到参考点主轴停止
# 5.1.4 钻孔循环，定点镗孔(G81)
该循环用于通常的钻孔操作。切削进给进行到孔底，刀具以快速进给的方式从孔底退出。
| G81 X_Y_Z_R_F_K;
X_Y_ : 孔位置数据
Z_ : 从R点到孔底的距离
R_ : 从基准平面到R点的距离
F_ : 切削进给速度
K_ : 重复次数(仅限需要重复时) |
| --- |
| G81(G98) |
| R点 |
| OZ点 |
沿X轴和Y轴定位之后，刀具快速进给到R点平面。之后，从R点平面到Z点进行钻孔加工。刀具以快速进给的方式收回。
在指定G81之前，利用辅助功能（M代码）使主轴旋转。
·辅助功能当在相同程序段中指定G81指令和M代码时，在最初的定位操作时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
·刀具长度补偿当在钻孔固定循环中指定了刀具长度补偿时(G43、G44、G49)时，在向R点定位时应用该补偿。
·取消请勿在包含G81的程序段中指定01组的G代码（G00～G03等）。否则，G81将被取消。
例M3 S2000; G90 G99 G81 X300.0Y- 250.0Z- 150.0R- 100.0F120; Y- 550.0; Y- 750.0; X1000.0; Y- 550.0; G98 Y- 750.0; G80 G28 G91 X0 Y0 Z0; M5;
定位后，钻孔1，然后返回到R点平面定位后，钻孔2，然后返回到R点平面定位后，钻孔3，然后返回到R点平面定位后，钻孔4，然后返回到R点平面定位后，钻孔5，然后返回到R点平面定位后，钻孔6，然后返回到基准平面返回到参考点主轴停止
# 5.1.5 钻孔循环，镗阶梯孔(G82)
该循环用于通常的钻孔操作。切削进给进行到孔底，在孔底暂停，然后刀具以快速进给的方式从孔底收回。该循环可以提高孔深的精度。
| G82 X_Y Z_R_P_F_K_; |
| --- |
| X_Y |
| Z_ |
| R_ |
| P_ |
| F_ |
| K_ |
| G82(G98) |
| R点 |
| P |
沿X轴和Y轴定位之后，刀具快速进给到R点平面。之后，从R点平面到Z点进行钻孔加工。在孔底暂停后，刀具以快速进给的方式收回。
在指定G82之前，利用辅助功能(M代码)使主轴旋转。
当在相同程序段中指定G82指令和M代码时，在最初的定位操作时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
请在进行钻孔动作的程序段中指定P。如果被指定在不执行钻孔操作的程序段中，则不被当作模态数据存储。
·取消请勿在包含G82的程序段中指定01组的G代码（ $\mathrm{G00\sim G03}$  等）。否则，G82将被取消。
例M3 S2000; G90 G99 G82 X300.0 Y- 250.0 Z- 150.0 R - 100.0 P1000 F120; Y- 550.0; Y- 750.0; X1000.0; Y- 550.0; G98 Y- 750.0; G80 G28 G91 X0 Y0 Z0; M5;
定位后，钻孔1，然后在孔底暂停1秒钟后，返回到R点平面
定位后，钻孔2，然后返回到R点平面
定位后，钻孔3，然后返回到R点平面
定位后，钻孔4，然后返回到R点平面
定位后，钻孔5，然后返回到R点平面
定位后，钻孔6，然后返回到基准平面
返回到参考点
主轴停止
# 5.1.6 钻深孔循环(G83)
该循环进行深孔钻孔操作。
该循环以间歇方式切削进给到达孔底，一边将金属切屑从孔中清除出去，一边进行加工。
| G83 X_Y_Z_R_Q_D_F_K_; |  |  |
| --- | --- | --- |
| X_Y_ | :  孔位置数据 |  |
| Z_ | :  从R点到孔底的距离 |  |
| R_ | :  从基准平面到R点的距离 |  |
| Q_ | :  每次的进刀量 |  |
| ,D_ | :  退刀量 |  |
| F_ | :  切削进给速度 |  |
| K_ | :  重复次数（仅限需要重复时） |  |
| G83(G98) | G83(G99) |  |
| 初始平面 | R点平 Q点 | G83(G99) |
·动作Q是每次的进刀量，始终以增量值来指定。在第2次以后的切削进给中，在加工到其紧之前的位置d，由快速进给改变微切削进给。d可以指令“,D”，或在参数(No.5115)中设定。Q的指令值务须设定一正值。即使指定负值，也将被忽略。
# 主轴的旋转
在指定G83之前，利用辅助功能(M代码)使主轴旋转。
·辅助功能当在相同程序段中指定G83指令和M代码时，在最初的定位操作时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
# ·Q
·Q请在进行钻孔动作的程序段中指定Q。如果被指定在不执行钻孔操作的程序段中，则不被当作模态数据存储。
·取消请勿在包含G83的程序段中指定01组的G代码（G00～G03等）。否则，G83将被取消。
例M3 S2000; G90 G99 G83 X300.0 Y- 250.0 Z- 150.0 R- 100.0 Q15.0 F120.0; Y- 550.0; Y- 750.0; X1000.0; Y- 550.0; G98 Y- 750.0; G80 G28 G91 X0 Y0 Z0; M5; 主轴起动定位后，钻孔1，然后返回到R点平面定位后，钻孔2，然后返回到R点平面定位后，钻孔3，然后返回到R点平面定位后，钻孔4，然后返回到R点平面定位后，钻孔5，然后返回到R点平面定位后，钻孔6，然后返回到基准平面返回到参考点主轴停止
# 5.1.7 钻小口径深孔循环(G83)
钻深孔循环重复下列步骤：在检测到过载扭矩信号（使用跳转信号）时，具有过载扭矩检测功能的轴杆使刀具收回，并在改变主轴转速和切削进给速度后，钻孔动作重新开始。通过指定被设定在参数(No.5163)中的M代码，就进入钻小口径深孔循环模式。在该模式指定G83，即可执行钻小口径深孔循环。钻小口径深孔循环模式可用G80指令或复位来解除。
![](images/19eda5880273c3353f10ac50804ca6d78d2fab87d2f6e3beed2e158530443c55.jpg)
# 构成循环的动作
$\ast \mathbf{X}$  、Y轴定位\*沿Z轴定位到R点\*沿Z轴切削（第1次进刀量Q，增量）后退动作(孔底  $\twoheadrightarrow$  微小退刀量  $\Delta$  ，增量）后退动作(孔底  $\twoheadrightarrow$  至R点）前进动作（R点  $\twoheadrightarrow$  至孔底  $^+$  余隙量  $\Delta$  的点）切削（第2次以后，进刀量  $\mathbf{Q} + \Delta$  ，增量）\*暂停 $\ast \mathbf{Z}$  轴R点（或起始点）返回  $=$  循环结束
在后退和前进动作期间，通过切削进给加／减速时间常数进行加/减速控制，并且在后退操作时，在R点进行到位检查。
# 指定M代码
通过指定被设定在参数(No.5163)中的M代码，就进入钻小口径深孔循环模式。但是，该M代码不等待FIN。因此，如果在相同程序段中指定该M代码与另一个M代码，需要引起注意。（例）M03M口口；  $\twoheadrightarrow$  等待FIN。M口口M03；  $\twoheadrightarrow$  不等待FIN。
# 指定G代码
在钻小口径深孔循环模式下，通过指定G83时，即开始执行钻小口径深孔循环。G83是模态G代码，一旦指定以后，在指定另一个固定循环或指定取消固定循环的G代码之前保持不变。因此，在连续进行相同的钻孔时，不必对每个程序段指定钻孔数据。
# 循环正在执行的信号
本循环模式中，在指令G83向孔位置的定位动作后，开始钻孔方向的轴的R点定位时，钻小口径深孔循环执行中信号变为“1”。在指令其它固定循环，或者在G80、复位或紧急停止下取消本模式时，本信号变为“0”。详情请参阅机床制造商提供的说明书。
# 过载扭矩检测信号
过载扭矩检测信号使用跳转信号。当钻孔方向的轴处于R点和Z点之间，且刀具前进或在执行切削动作时，该跳转信号有效（执行后退动作）。详情请参阅机床制造商提供的说明书。
当检测出前进动作中过载扭矩时，在执行后退动作（微小退刀量  $\Delta +$  向R点的移动）后，刀具在下一个前进动作中，移动到上次切削结束时刻的微小退刀量  $\Delta$  的后退动作已完成的位置。
# ·改变切削条件
·改变切削条件在单独的 G83 循环中，针对每个钻深孔动作(前进  $\twoheadrightarrow$  切削  $\twoheadrightarrow$  后退)改变切削条件。也可以通过参数OLS、NOL(No.5160#1、#2)的设定不改变切削条件。
1改变切削进给速度在执行第2次以后的每次钻孔动作时，改变用F代码编程的切削进给速度。在参数（No.5166、No.5167）中设定上一次切削动作中检测到和没有检测到跳转信号时的变更比率。
切削进给速度  $= \mathrm{F}\times \mathrm{a}$
<第1次  $\gtrless$ $\alpha = 1.0$ $<$  第2次  $\gtrless$ $\alpha = \alpha \times \beta \div 100$ $\beta$  是每次钻孔动作的变更比率在上次的切削中有跳转信号：  $\beta = b1\%$  （参数(No.5166)）在上次的切削中没有跳转信号：  $\beta = b2\%$  （参数(No.5167)）
如果切削进给速度的变更比率  $\alpha$  小于设定在参数(No.5168)中的比率，停止改变切削进给速度。此外，已被改变的切削进给速度的上限即为最大切削进给速度。
2改变主轴转速在开始第2次以后的前进动作时，改变用S代码编程的主轴转速。在参数（No.5164、No.5165）中设定上一次切削动作中检测到和没有检测到跳转信号时的变更比率。
# 主轴转速  $= S\times \gamma$
<第1次  $\gtrless$ $\gamma = 1.0$ $<$  第2次  $\gtrless$ $\gamma = \gamma \times \delta \div 100$  8为每次钻孔动作的变更比率在上次的切削中有跳转信号：  $\delta = d1\%$  （参数(No.5164)）在上次的切削中没有跳转信号：  $\delta = d2\%$  （参数(No.5165)）
当切削进给速度达到最小速度时，停止改变主轴转速。此外，已被变更的主轴转速的上限为相当于S模拟数据最大值的数值。
# ·前进与后退动作
·前进与后退动作前进与后退动作的进行方式不同于快速进给定位的方式，同切削进给一样，前进与后退动作是以插补动作的方式进行的。但是，刀具寿命管理功能在计算刀具寿命时不考虑前进与后退动作。
# ·指定地址I
以地址I来指定前进与后退速度时，其格式与地址F相同。即，
G83I1000；（不带小数点的指令）G83I1000；（带有小数点的指令）
两种情形的速度均为  $1000\mathrm{mm / min}$  。在指定G80之前或进行复位之前，在G83模态状态下指定的地址I继续有效。
注释在I的指定被省略，参数(No.5172）（后退动作时）、参数(No.5173）（前进动作时）的设定值为0时，移动速度为与用F指定的速度相同的速度。
# ·可以指定的功能
在钻小口径深孔循环模式下，可以指定如下指令。
·钻孔轴以外的轴的孔位置指令·基于用户宏程序的运算、转移·子程序（孔位置组等）调用·绝对/增量的切换·坐标系旋转·比例缩放指令（该指令不影响进刀量Q及微小退刀量  $\Delta$  ）·空运行·进给保持
# - 单程序段
在单程序段操作被激活时，每次后退动作后钻孔停止。此外，通过参数SBC(No.5105#0)的设定，还可以在每个循环执行单程序段停止操作。
# - 进给速度倍率
针对循环中的切削、后退、前进的每个动作，进给速度倍率有效。
# - 用户宏程序接口
可以将切削中的后退动作的累计次数和过载扭矩信号所进行的后退动作的累计次数输出到设定在参数(No.5170、No.5171)中的用户宏程序公共变量（#100～#149）中。但是，无法在参数(No.5170、No.5171)中设定  $100\sim 149$  以外的值。参数（No.5170）：设定用来输出切削期间的后退动作的累计次数的公共变量号。参数（No.5171）：设定基于切削期间接收到的过载扭矩信号的后退动作累计次数的公共变量编号。
输出给用户用程序的公共变量的累计次数值，将被进入钻小口径深孔循环模式后的G83指令清零。
# - 定位到孔位置
钻小口径深孔循环中，定位到孔位置时（XY平面时为定位到X,Y轴时），通过消除主轴的停止，可缩短加工时间。本功能在参数SPH(No.5108#6)为1时有效。
# - 子程序调用
请用单程序段来指定在钻小口径深孔循环模式下的子程序调用指令M98P_。
M3 S2000; M□□; G90 G99 G83 X_Y_Z_R_Q_F_I_K_P_; X_Y_; G80;
主轴起动切换为“钻小口径深孔循环”模式“钻小口径深孔循环”指令改变孔位置后执行
“钻小口径深孔循环”模式取消
# 5.1.8 攻丝循环(G84)
该循环可以进行攻丝加工。主轴到达孔底时反转，执行攻丝循环。
| G84 X_Y_Z_R_P_F_K_; |
| --- |
| X_Y_ : |
| Z_ : |
| R_ : |
| P_ : |
| F_ : |
| K_ : |
| G84(G98) |
| 初始平面 R点 Z点 |
使主轴正转进给，当到达孔底时，主轴反转并收回，这个操作生成螺纹。
在攻丝动作期间忽略进给速度倍率，在返回动作完成之前，进给保持并不使机床停止。
在指定G84之前，利用辅助功能（M代码）使主轴旋转。连续执行从孔位置和基准平面到R点平面的距离较短的钻孔动作时，在进入孔的切削动作之前，主轴有可能无法进行正常旋转。在这种情况下，请勿指定重复次数K，而需要将基于G04的暂停插入到每个钻孔动作之前以腾出时间。有的机床不必考虑上述情况，详情请参阅机床制造商提供的说明书。
当在相同程序段中指定G84指令和M代码时，在最初的定位时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
·取消请勿在包含G84的程序段中指定01组的G代码（G00～G03等）。否则，G84将被取消。
例M3 S100; G90 G99 G84 X300.0Y- 250.0 Z- 150.0 R- 120.0 P300 F120.0; Y- 550.0; Y- 750.0; X1000.0; Y- 550.0; G98 Y- 750.0; G80 G28 G91 X0 Y0 Z0; M5;
# 5.1.9 镗孔循环 (G85)
该循环用于镗孔加工。
| G85 X_Y_Z_R_F_K_; |
| --- |
| X_Y_ : |
| Z_ : |
| R_ : |
| F_ : |
| K_ : |
| G85(G98) |
| R点 |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
| O |
沿X轴和Y轴定位之后，刀具快速进给到R点平面。之后，从R点平面到Z点进行钻孔加工。在到达Z点后，刀具以切削进给的方式返回到R点。
在指定G85之前，利用辅助功能（M代码）使主轴旋转。
当在相同程序段中指定G85指令和M代码时，在最初的定位操作时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
请勿在包含G85的程序段中指定01组的G代码（G00～G03等）。否则，G85将被取消。
M3S100; G90G99G85X300.0Y- 250.0Z- 150.0R- 120.0F120.0; Y- 550.0; Y- 750.0; X1000.0; Y- 550.0; G98Y- 750.0; G80G28G91X0Y0Z0; M5;
# 5.1.10 镗孔循环 (G86)
![](images/0b990c21af75e291335bcdcd60ad02a9d0de7f5df6d9c47f4884c632a151bbe7.jpg)
- 动作沿X轴和Y轴定位之后，刀具快速进给到R点平面。之后，从R点平面到Z点进行钻孔加工。当主轴在孔底停止旋转后，刀具以快速进给方式收回。
- 主轴的旋转在指定G86之前，利用辅助功能（M代码）使主轴旋转。连续执行从孔位置和基准平面到R点平面的距离较短的钻孔动作时，在进入孔的切削动作之前，主轴有可能无法进行正常旋转。在这种情况下，请勿指定重复次数K，而需要将基于G04的暂停插入到每个钻孔动作之前以腾出时间。有的机床不必考虑上述情况，详情请参阅机床制造商提供的说明书。
- 辅助功能当在相同程序段中指定G86指令和M代码时，在最初的定位时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
- 刀具长度补偿当在钻孔固定循环中指定了刀具长度补偿时(G43、G44、G49)时，在向R点定位时应用该补偿。
·取消请勿在包含G86的程序段中指定01组的G代码（G00～G03等）。否则，G86将被取消。
例M3 S2000; G90 G99 G86 X300.0 Y- 250.0 Z- 150.0 R- 100.0 F120.0; Y- 550.0; Y- 750.0; X1000.0; Y- 550.0; G98 Y- 750.0; G80 G28 G91 X0 Y0 Z0; M5;
定位后，钻孔1，然后返回到R点平面 定位后，钻孔2，然后返回到R点平面 定位后，钻孔3，然后返回到R点平面 定位后，钻孔4，然后返回到R点平面 定位后，钻孔5，然后返回到R点平面 定位后，钻孔6，然后返回到基准平面 返回到参考点 主轴停止
# 5.1.11 回程镗孔循环（G87）
该循环用来进行高精度的镗孔。
![](images/48fad7b5ce949897f57383d92f0c88d154f21d320ea48bc835e61de42a7ebe99.jpg)
| G87 X_Y_Z_R_Q_P_F_K_; |  |  |  |  |
| --- | --- | --- | --- | --- |
| X_Y_ | : 孔位置数据 |  |  |  |
| Z_ | : 从R点到孔底的距离 |  |  |  |
| R_ | : 从基准平面到R点的距离 |  |  |  |
| Q_ | : 孔底的位移量 |  |  |  |
| P_ | : 孔底的暂停时间 |  |  |  |
| F_ | : 切削进给速度 |  |  |  |
| K_ | : 重复次数（仅限需要重复时） |  |  |  |
| G87(G98) | G87(G99) |  |  |  |
| 主轴正转 | 初始平面 |  |  |  |
| 主轴正转 | Q | 不使用。 |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| 位移量q | Q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q<tr> | 主轴正转 | OSS |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| 主轴正转 | OSS | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | Q | Q |  |  |
| OSS | q | Q |  |  |
| 主轴正转 | OSS | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| C | Q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q<rel> | OSS | q |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q O | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| T | Q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q |  |  |
| OSS | q | Q< |  |  |
沿X轴和Y轴定位之后，主轴停止在固定的旋转位置，刀具在与刀尖相反的方向位移后，以快速进给的方式定位在孔底(R点)。
在此位置，刀具沿刀尖方向位移，主轴正转，沿Z轴进行正方向镗孔，直到Z点。
在此位置，使主轴又停止在固定的旋转位置，然后刀具沿着与刀尖相反的方向位移，并返回到基准平面，之后，刀具沿着刀尖方向位移，主轴正转，进入下一程序段的动作。
在指定G87之前，利用辅助功能（M代码）使主轴旋转。
连续执行从孔位置和基准平面到R点平面的距离较短的钻孔动作时，在进入孔的切削动作之前，主轴有可能无法进行正常旋转。在这种情况下，请勿指定重复次数K，而需要将基于G04的暂停插入到每个钻孔动作之前以腾出时间。有的机床不必考虑上述情况，详情请参阅机床制造商提供的说明书。
当在相同程序段中指定G87指令和M代码时，在最初的定位时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
# 刀具长度补偿
# ·P,Q
Q的值必须以正值予以指定。即使以负值指定，符号也将被忽略。在参数(No.5148)中设定位移的方向。在进行钻孔动作的程序段中指定P和Q。如果被指定在不执行钻孔操作的程序段中，则不被当作模态数据存储。
Q(在孔底的位移量)是保留在钻孔固定循环中的模态信息，指定时必须注意，因为它还可以被G73、G83当做进刀量使用。
请勿在包含G87的程序段中指定01组的G代码（G00～G03等）。否则，G87将被取消。
M3 S500; G90 G87 X300.0 Y- 250.0 Z- 150.0 R- 120.0 Q5.0 P1000 F120.0; Y- 550.0; Y- 750.0; X1000.0; Y- 550.0; Y- 750.0; G80 G28 G91 X0 Y0 Z0; M5;
主轴起动定位后，钻孔1在基准平面定位后，位移5mm在Z点停止1秒钟定位后，钻孔2定位后，钻孔3定位后，钻孔4定位后，钻孔5定位后，钻孔6返回到参考点主轴停止
# 5.1.12 镗孔循环 (G88)
| G88 X_Y_Z_R_P_F_K_; |
| --- |
| X_Y_ : |
| Z_ : |
| R_ : |
| P_ : |
| F_ : |
| K_ : |
| G88(C98) |
| 主轴正转 初始平面 Z点 暂停后主轴停止 |
沿X轴和Y轴定位之后，刀具快速进给到R点平面。
从R点平面到Z点进行镗孔操作。
之后，刀具在孔底暂停，而后主轴停止，并进入保持状态。因此，此时可以切换到手动模式，手动移动刀具。什么样的手动动作都可以进行，但是，最后应将刀具从孔中抽出较为安全。
在重新开始加工时，如果在DNC运行模式或存储器运行模式启动，刀具按照G98或G99返回到基准平面或R点平面后，主轴正转，而后按照下一个程序段的程序指令重新开始动作。
在指定G88之前，利用辅助功能（M代码）使主轴旋转。
·辅助功能当在相同程序段中指定G88指令和M代码时，在最初的定位时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
·钻孔在没有包含X、Y、Z、R、或任何其他附加轴的程序段中不钻孔。
·取消请勿在包含G88的程序段中指定01组的G代码（G00～G03等）。否则，G88将被取消。
例M3 S2000； 主轴起动G90 G99 G88 X300.0 Y- 250.0 Z- 150.0 R- 100.0 P1000 F120.0； 定位后，钻孔1，然后返回到R点平面，在孔底停止1秒钟Y- 550.0； 定位后，钻孔2，然后返回到R点平面Y- 750.0； 定位后，钻孔3，然后返回到R点平面X1000.0； 定位后，钻孔4，然后返回到R点平面Y- 550.0； 定位后，钻孔5，然后返回到R点平面G98 Y- 750.0； 定位后，钻孔6，然后返回到基准平面G80 G28 G91 X0 Y0 Z0； 返回到参考点M5； 主轴停止
# 5.1.13 镗孔循环 (G89)
| G89 X_Y_Z_R_P_F_K_: |
| --- |
| X_Y_: |
| Z_: |
| R_: |
| P_: |
| F_: |
| K_: |
| G89(G98) |
| R点 |
| O |
| P |
这一循环与G85相同，但是在孔底执行暂停操作。
在指定G89之前，利用辅助功能（M代码）使主轴旋转。
当在相同程序段中指定G89指令和M代码时，在最初的定位操作时执行M代码。当指定了重复次数K时，仅在第1次执行上述动作，第2次以后不再执行M代码。
请勿在包含G89的程序段中指定01组的G代码（G00～G03等）。否则，G89将被取消。
M3S100; G90 G99 G89 X300.0 Y- 250.0 Z- 150.0 R- 120.0 P1000 F120.0;
Y- 550.0; Y- 750.0; X1000.0; Y- 550.0; G98 Y- 750.0; G80 G28 G91 X0 Y0 Z0; M5;
定位后，钻孔1，然后返回到R点平面，在孔底停止1秒钟
# 5.1.14 钻孔固定循环取消(G80)
该循环取消钻孔固定循环。

解释取消所有的钻孔固定循环，之后进行正常的操作。R点平面和Z点也被取消。其它钻孔数据也被取消。
例M3 S100; G90 G99 G88 X300.0 Y- 250.0 Z- 150.0 R- 120.0 F120.0; Y- 550.0; Y- 750.0; X1000.0; Y- 550.0; G98 Y- 750.0; G80 G28 G91 X0 Y0 Z0; M5;
主轴起动定位后，钻孔1，然后返回到R点平面定位后，钻孔2，然后返回到R点平面定位后，钻孔3，然后返回到R点平面定位后，钻孔4，然后返回到R点平面定位后，钻孔5，然后返回到R点平面定位后，钻孔6，然后返回到基准平面参考点返回，固定循环取消主轴停止
# 5.1.15 钻孔固定循环的举例
在偏置号11设的偏置值为  $+200.0$  ，在偏置号15设的偏置值为  $+190.0$  ，在偏置号31设的偏置值为  $+150.0$
# 程序例
N001 G92 X0 Y0 Z0 ; 在参考点设定坐标系N002 G90 G00 Z250.0 T11 M6 ; 换刀N003 G43 Z0 H11 ; 基准平面，刀具长度补偿N004 S30 M3 ; 主轴起动N005 G99 G81 X400.0 Y- 350.0 Z- 153.0 R- 97.0 F120 ; 定位后，钻孔#1N006 Y- 550.0 ; 定位后，钻孔#2，然后返回到R点平面N007 G98 Y- 750.0 ; 定位后，钻孔#3，然后返回到基准平面N008 G99 X1200.0 ; 定位后，钻孔#4，然后返回到R点平面N009 Y- 550.0 ; 定位后，钻孔#5，然后返回到R点平面N010 G98 Y- 350.0 ; 定位后，钻孔#6，然后返回到基准平面N011 G00 X0 Y0 M5 ; 参考点返回，主轴停止N012 G49 Z250.0 T15 M6 ; 刀具长度补偿取消、换刀N013 G43 Z0 H15 ; 基准平面，刀具长度补偿N014 S20 M3 ; 主轴起动N015 G99 G82 X550.0 Y- 450.0 Z- 130.0 R- 97.0 P300 F70 ; 定位后，钻孔#7，然后返回到R点平面N016 G98 Y- 650.0 ; 定位后，钻孔#8，然后返回到基准平面N017 G99 X1050.0 ; 定位后，钻孔#9，然后返回到R点平面N018 G98 Y- 450.0 ; 定位后，钻孔#10，然后返回到基准平面N019 G00 X0 Y0 M5 ; 参考点返回，主轴停止N020 G49 Z250.0 T31 M6 ; 刀具长度补偿取消、换刀N021 G43 Z0 H31 ; 基准平面，刀具长度补偿N022 S10 M3 ; 主轴起动N023 G85 G99 X800.0 Y- 350.0 Z- 153.0 R47.0 F50 ; 定位后，钻孔#11，然后返回到R点平面N024 G91 Y- 200.0 K2 ; 定位后，钻孔#12，#13，然后返回到R点平面N025 G28 X0 Y0 M5 ; 参考点返回，主轴停止N026 G49 Z0 ; 刀具长度补偿取消N027 M0 ; 程序停止
使用了刀具长度补偿、固定循环的程序
![](images/58cf70a50ed6ec97a01cee1d02e080f6d526d068b46504850a67da029f9b0945.jpg)  
图5.1.15(a) 钻孔固定循环的举例
# 5.1.16 钻孔固定循环主轴速度到达等待时间缩短
通过将参数SAC(No.11507#7)设定为1，就会在钻孔固定循环中，在第2次以后的孔加工开始时不等待参数(No.3740)中设定的时间便检查主轴速度到达信号SAR。此外，可以快速进给搭接进行钻孔用固定循环向基准平面的快速进给、和向下一个孔位置的定位。通过这些改进，循环时间缩短。
钻孔固定循环由下列6个动作顺序组成。动作1 X、Y轴的定位动作2 快速进给到R点平面动作3 钻孔动作4 在孔底位置的动作动作5 退刀至R点平面动作6 快速进给到基准平面
![](images/50e835a93172f496871dda283c9be781ae1c512f64f1de7eb60957a62dd46b7b.jpg)  
图5.1.16(a) 钻孔固定循环的动作顺序
参数SAC(No.11507#7)为0时，每次孔加工都将等待参数(No.3740)中设定的时间经过后再检查主轴速度到达信号SAR。参数SAC(No.11507#7)为1时，在第2次以后的孔加工中不管参数(No.3740)的设定如何，都将马上检查主轴速度到达信号SAR。
但是，在满足如下任何一个条件时，在主轴速度到达信号SAR的检查前等待参数(No.3740)中设定的时间经过。
通过G80或者第1组G代码取消了钻孔固定循环。指令了S代码。指令了与模态不同的钻孔固定循环的G代码。主轴速度到达信号SAR成了“0”。已处于NC复位状态。
# 关于各指令适应高速化
钻孔固定循环列表（Series0i格式）  
| G代码 | 用途 | SAR 等待时间缩短 | 快速进给搭接 |
| --- | --- | --- | --- |
| G73 | 高速深孔钻循环 | 有效 | 有效 |
| G74 | 反向攻丝循环 反向刚性攻丝循环 | - | 有效 |
| G76 | 精密镗孔循环 | 有效 | 有效 |
| G81 | 钻孔循环定点镗孔 | 有效 | 有效 |
| G82 | 钻孔循环镗阶钻孔 | 有效 | 有效 |
| G83 | 钻深孔循环 | 有效 | 有效 |
| G84 | 攻丝循环 刚性攻丝循环 | - | 有效 |
| G85 | 镗孔循环(G85) | 有效 | 有效 |
| G86 | 镗孔循环(G86) | 有效 | 有效 |
| G87 | 回程镗孔循环 | 有效 | 有效 |
| G88 | 镗孔循环(G88) | 有效 | 有效 |
| G89 | 镗孔循环(G89) | 有效 | 有效 |
钻孔固定循环列表（Series15格式）  
| G代码 | 用途 | SAR 等待时间缩短 | 快速进给搭接 |
| --- | --- | --- | --- |
| G84.2 | 刚性攻丝循环 | — | 有效 |
| G84.3 | 反向刚性攻丝循环 | — | 有效 |
# 5.2 钻孔固定循环搭接
概述使用本功能，在钻孔固定循环的模式中，可以在插补后加减速的时间常数中的一定时间中搭接下一程序段与指令。由此可以高速化钻孔固定循环的动作，从而缩短循环时间。
# ·支持的钻孔固定循环
可启用本功能的钻孔固定循环如表5.2（a）钻孔固定循环所示。
| 表5.2(a) 钻孔固定循环 |
| --- |
| G代码 |
| G73 |
| G81 |
| G82 |
| G83 |
| G85 |
| G86 |
| G89 |
# - 各循环中搭接有效的动作
![](images/e8a5dc01fabf267b681ffcc03d9af990a9bbaab9ec86a1154f7a3513ea38c457.jpg)  
图5.2(a) 高速钻深孔循环(G73)
![](images/fffbf7de2a7be13198de521992c989a2afb9557d41042a48d2732f4232335725.jpg)  
图5.2(b) 钻孔循环，定点镗孔（G81）
![](images/4bdd55ede8981e6beaa0226857cc75072c4fc38bb5c990de6d3ad04c4679c064.jpg)  
图5.2（c）钻孔循环，镗阶梯孔（G82）
![](images/c9a84fd9eface116641031aff2293ec436f19b9ced5d8eaef452dba56f083f2e.jpg)  
图5.2（d）钻深孔循环（G83）
![](images/3726067cadae3fe7a64a32471bd65f1f24f6b7af5f5b4334a474eeb8bcc64e9b.jpg)  
图5.2(e) 镗孔循环(G85)
![](images/9be6e94544cf722ecda9b99bc173de1a7a36b48c9da10c98af2a904f2ee69ac5.jpg)  
图5.2(f) 镗孔循环(G86)
![](images/c9e83e19a1b4a61c9518995d1394c47f0d54e1b396715b62adcdedbe91234008.jpg)  
图5.2 (g) 镗孔循环(G89)
# 5.3 刚性攻丝
攻丝循环(G84)和反向攻丝循环(G74)可以在标准模式和刚性攻丝模式下进行。在标准模式下，主轴旋转或停止都伴随着沿攻丝轴上的移动，攻丝轴使用辅助功能进行攻丝：M03（主轴正转）、M04（主轴反转）和M05（主轴停止）。在刚性模式下，通过控制主轴电机（把它看成伺服电机）以及在攻丝轴和主轴之间的副补进行攻丝。利用刚性模式进行攻丝时，主轴每旋转一周，攻丝轴就进给一定的距离（螺纹导程）。即使在加速或者减速期间，这种操作也不改变。因此，刚性模式不必使用可变丝锥（在标准攻丝模式下要求使用），而可进行更快、更精确的攻丝操作。
# 5.3.1 刚性攻丝(G84)
当主轴电机被控制在刚性模式（把它看成伺服电机）时，可以进行高速攻丝循环。
![](images/9d7c0806d8bcdf99bcefb46d3d14de32222d7bc6e48e7f7fc1225422e92862be.jpg)
解释沿X轴和Y轴定位之后，刀具快速进给到R点平面。从R点平面到Z点进行攻丝操作，完成攻丝操作之后，主轴停止转动并暂停。然后，停止中的主轴反转，刀具收回到R点平面，主轴停止旋转，之后快速进给到基准平面。正在进行攻丝时，进给速度倍率和主轴倍率都假设为  $100\%$  。但是，可通过设定使进给速度倍率有效。
# ·螺纹的导程
·螺纹的导程在每分钟进给模式下，进给速度  $\div$  主轴转速  $=$  螺纹的导程。在每转进给模式下，进给速度  $=$  螺纹导程。
·刀具长度补偿当在固定循环中指定刀具长度补偿时(G43、G44、G49)时，在向R点定位时应用偏置。
# ·FANUCSeries15程序格式指令
·FANUCSeries15程序格式指令可以通过FANUCSeries15程序格式指令使用刚性攻丝功能，刚性攻丝的顺序（包括与PMC之间的数据传输等）和限制等事项，按照本章的说明执行。
# ·插补后加减速
可以应用直线型加减速或铃型加减速
# ·预读插补前加减速
预读插补前加减速无效。
# ·倍率
各类倍率虽然无效，但是通过设定参数可以使下列倍率有效。
·拉拔倍率
·倍率信号
详情将在后面描述。
# ·空运行
·空运行空运行对G84(G74)也有效。因此，对G84(G74)的钻孔轴的速度应用空运行时，系统随之进行攻丝。空运行速度较快时，主轴的速度也将随之加快，应予注意。
# ·机床锁住
机床锁住对G84(G74)也有效。即使在机床锁住状态执行G84(G74)，钻孔轴也不会移动。因此，主轴也不会动作。
# ·复位
·复位在刚性攻丝中执行复位操作时，刚性攻丝将会停止。复位时的G代码根据参数CLR(No.3402#5)以及参数C09(No.3407#1)，如表5.3.1(a)所示。在G84/G74保持的状态下重新运行时，请根据需要指令G80。
表5.3.1(a)  
| CLR(No.3402#5) | C09(No.3407#1) | G代码 |
| --- | --- | --- |
| 0 | - | G84/G74 |
| 1 | 0 | G80 |
| 1 | 1 | G84/G74 |
# ·联锁
联锁联锁对G84(G74)也有效。
# ·进给保持、单程序段
·进给保持、单程序段在G84(G74)方式下，若将参数FHD(No.5200#6)设定为0，进给保持、单程序段将无效。将其设定为1，进给保持、单程序段将有效。
·进给保持
·进给保持- 参数FHD(No.5200#6)=0当在动作  $3\sim 5$  之间应用进给保持时，进给保持指示灯立即点亮，但在继续执行至动作6后停止。在动作1、动作2、动作6中应用进给保持时，CNC进入自动运行休止状态，并减速停止。- 参数FHD(No.5200#6)=在动作1～动作6之间应用进给保持时，CNC进入自动运行休止状态，并减速停止。
·单程序段
·单程序段- 参数FHD(No.5200#6)=0单程序段中的停止点在动作1、动作2、动作6的结束后。- 参数FHD(No.5200#6)=单程序段中的停止点在各动作的结束后。
# ·手动进给
·手动进给在手动手轮进给下进行刚性攻丝时，请参阅操作说明书（车床系统／加工中心通用）（B- 64484CM）“基于手动手轮的刚性攻丝”项。无法在除此以外的手动进给中进行刚性攻丝。
# ·反冲补偿
·反冲补偿在刚性攻丝模式下，为了补偿主轴承转、反转时的空转，进行反冲补偿。请在参数(No.5321～5324)中设定反冲量。沿着钻孔轴的反冲补偿可按通常方式执行。
在切换钻孔轴之前，请暂时取消固定循环。在刚性模式下切换时，会有报警(PS0206)发出。
# ·S指令
·S指令- 如果指定的转速大于所用齿轮的最大转速，将会发生报警(PS0200)。- 刚性攻丝中所使用的S在刚性攻丝的固定循环取消时被清除，SO变为被指定的状态。
# ·主轴的分配量
·主轴的分配量在串联主轴的情形下，最大主轴分配量为32767pulse每8msec。（通过诊断数据(No.451)来显示。）此值随着位置编码器的齿轮比设定和刚性攻丝的指令而变化，指定了超过此上限的指令时，会发生报警(PS0202)。
# ·F指令
·F指令当指定值超过切削进给速度上限值时，会有报警(PS0011)发出。
·F指令的单位  
|  | 米制输入 | 英制输入 | 备注 |
| --- | --- | --- | --- |
| G94 | 1mm/min | 0.01 inch/min | 允许用小数点编程 |
| G95 | 0.01 mm/rev | 0.0001 inch/rev | 允许用小数点编程 |
# ·M29
·M29如果在M29和G84之间指定S指令和轴移动，会有报警(PS0203)发出。此外，如果在攻丝循环中指定M29，会有报警(PS0204)发出。
# P
请在进行钻孔动作的程序段中指定P。如果被指定在不进行钻孔动作的程序段中，则不被当作模态数据存储。
请勿在与G84(G74)相同的程序段中指定01组的G代码（G00～G03,G60（参数MDL(No.5431#0)为1时））。否则，G84(G74)将被取消。
在固定循环模式下，刀具位置偏置被忽略。
# ·程序再启动
在刚性攻丝的循环中，无法执行程序再启动。
# ·子程序调用
请用单程序段来指定在固定循环模式下的子程序调用指令M98P_。
# ·周速恒定控制
周速恒定控制中指令了刚性攻丝时，将会发生报警(PS0200）“非法的S代码指令”，在取消周速恒定控制后指令刚性攻丝。
# ·通过最佳加速度定位
在刚性攻丝中，通过最佳加速度定位无效。
Z轴进给速度  $1000\mathrm{mm / min}$  主轴转速  $1000\mathrm{min - 1}$  螺纹的导程  $1.0\mathrm{mm}$  <每分钟进给编程>G94； G00X120.0Y100.0； M29S1000； G84Z- 100.0R- 20.0F1000； <每转进给编程>G95； G00X120.0Y100.0； M29S1000； G84Z- 100.0R- 20.0F1.0；
每分钟进给指令定位刚性模式指令刚性攻丝加工
每转进给指令定位刚性模式指令刚性攻丝加工
# 5.3.2 反向刚性攻丝循环 (G74)
![](images/0d362ab33b81a288036539ac2a3c57b1b5bc9fd67924d75a367300792d26539f.jpg)
沿X轴和Y轴定位之后，快速运行到R点平面。从R点平面到Z点进行攻丝操作，完成攻丝操作之后，主轴停止转动并暂停。然后，停止中的主轴正向旋转，刀具收回到R点平面，主轴停止旋转，而后快速进给到基准平面。进行攻丝动作时，进给速度倍率和主轴倍率都假设为  $100\%$  。但是，可通过设定使进给速度倍率有效。
在每分钟进给模式下，进给速度  $\div$  主轴转速  $=$  螺纹导程。在每转进给模式下，进给速度  $=$  螺纹导程。
当在固定循环中指定刀具长度补偿时(G43、G44、G49)时，在向R点定位时应用偏置。
# - FANUC Series 15 程序格式指令
可以通过 FS10/11 格式指令使用刚性攻丝功能，刚性攻丝的顺序（包括与 PMC 之间的数据传输等）和限制等事项，按照本章的说明执行。
# - 插补后加减速
# - 预读插补前加减速
# - 倍率
各类倍率虽然无效，但是通过设定参数可以使下列倍率有效。- 拉拔倍率- 倍率信号详情将在后面描述。
# - 空运行
空运行对 G84(G74) 也有效。因此，对 G84(G74) 的钻孔轴的速度应用空运行时，系统随之进行攻丝。空运行速度较快时，主轴的速度也将随之加快，应予注意。
# - 机床锁住
机床锁住对 G84(G74) 也有效。即使在机床锁住状态执行 G84(G74)，钻孔轴也不会移动。因此，主轴也不会动作。
# - 复位
在刚性攻丝中执行复位操作时，刚性攻丝将会停止。复位时的 G 代码根据参数 CLR(No.3402#5) 以及参数 C09(No.3407#1)，如表 5.3.2（a）所示。在 G84(G74) 保持的状态下重新运行时，请根据需要指令 G80。
表5.3.2(a)  
# - 联锁
联锁对 G84(G74) 也有效。
# - 进给保持、单程序段
在 G84(G74) 方式下，若将参数 FHD(No.5200#6) 设定为 0，进给保持、单程序段将无效。将其设定为 1，进给保持、单程序段将有效。
- 进给保持
- 参数 FHD(No.5200#6)=0
当在动作  $3\sim 5$  之间应用进给保持时，进给保持指示灯立即点亮，但在继续执行至动作 6 后停止。在动作 1、动作 2、动作 6 中应用进给保持时，CNC 进入自动运行休止状态，并减速停止。
- 参数 FHD(No.5200#6)=在动作 1～动作 6 之间应用进给保持时，CNC 进入自动运行休止状态，并减速停止。
- 单程序段
- 参数 FHD(No.5200#6)=0单程序段中的停止点在动作 1、动作 2、动作 6 的结束后。- 参数 FHD(No.5200#6)=单程序段中的停止点在各动作的结束后。
·反冲补偿在刚性攻丝模式下，为了补偿主轴正转、反转时的空转，进行反冲补偿。请在参数(No.5321～5324)中设定反冲量。沿着钻孔轴的反冲补偿可按通常方式执行。
·S指令如果指定的转速大于所用齿轮的最大转速，将会发生报警(PS0200)。- 刚性攻丝中所使用的S在刚性攻丝的固定循环取消时被清除，S0变为被指定的状态。
·F指令当指定值超过切削进给上限值时，会有报警(PS0011)发出。
|  | 米制输入 | 英制输入 | 备注 |
| --- | --- | --- | --- |
| G94 | 1mm/min | 0.01inch/min | 允许用小数点编程 |
| G95 | 0.01mm/tev | 0.0001inch/tev | 允许用小数点编程 |
·P请在进行钻孔动作的程序段中指定P。如果被指定在不进行钻孔动作的程序段中，则不被当作模态数据存储。
·取消请勿以与G74相同的程序段指定01组的G代码(G00～G03、G60(当参数MDL(No.5431#0)设为1时))。否则，G74将被取消。
·周速恒定控制周速恒定控制中指令了刚性攻丝时，将会发生报警(PS0200)“非法的S代码指令”。在取消周速恒定控制后指令刚性攻丝。
Z轴进给速度  $1000\mathrm{mm / min}$  主轴转速  $1000\mathrm{min - 1}$  螺纹的导程  $1.0\mathrm{mm}$  <每分钟进给编程>G94; G00X120.0Y100.0； M29S1000; G74Z- 100.0R- 20.0F1000； <每转进给编程>G95; G00X120.0Y100.0； M29S1000; G74Z- 100.0R- 20.0F1.0；
每分钟进给指令定位刚性模式指令刚性攻丝加工每转进给指令定位刚性模式指令刚性攻丝加工
# 5.3.3 深孔刚性攻丝循环(G84或G74)
在刚性攻丝方式下切削深孔是困难的，这是因为金属切屑会粘在刀具上，或增加切削阻力。在这种情况下，深孔刚性攻丝循环就很有用。通过参数PCP(No.5200#5)设定，本功能可以从高速深孔攻丝循环和标准深孔攻丝循环中予以选择。
- 高速深孔攻丝循环（参数PCP(No.5200#5)为0时）(1) 刀具以通常的切削进给速度操作，使用通常的时间常数。(2) 收回倍率有效，使用收回时间常数。
![](images/6108a6aa9d8d8e3194f8730031446a51cda7e4492808a2a190a03455abd10061.jpg)
·深孔攻丝循环
（参数PCP（No.5200#5）为1时）
（1）刀具以通常的切削进给速度操作，使用通常的时间常数。
(2）收回倍率有效，使用收回时间常数。
(3）收回倍率有效，使用通常的时间常数。
![](images/02c8b654a4c26dac665e6122cdf532473473b958dc56dcfba3cd43ee6eab1123.jpg)
# ·高速深孔攻丝循环
·高速深孔攻丝循环沿X轴和Y轴定位之后，快速进给到R点平面。从R点平面开始进行切深为Q（每次的进刀量）的切削操作，然后刀具后退d（退刀量）。退刀时，通过参数DOV(No.5200#4)可以指定倍率是否有效。到达Z点时，主轴停止，然后反向旋转并收回。在参数(No.5213)中设定退刀量d。
# ·深孔攻丝循环
·深孔攻丝循环沿X轴和Y轴定位之后，快速进给到R点平面。从R点平面开始进行切深为Q（每次的进刀量）的切削操作，然后刀具返回到R点。退刀时，通过参数DOV(No.5200#4)可以指定倍率是否有效。切削进给速度F从R点移动到离上一次切削点的距离为d的位置，并从该点重新开始切削操作。参数DOV(No.5200#4)对于此时的切削进给速度F的移动仍然有效。到达Z点时，主轴停止，然后反向旋转并收回。在参数(No.5213)中设定切削开始距离d。
·拉拔倍率·倍率信号详情将在后面描述。
·复位在刚性攻丝中执行复位操作时，刚性攻丝将会停止。复位时的G代码根据参数CLR(No.3402#6)以及参数C09(No.3407#1)，如表5.3.3(a)所示。在G84/G74保持的状态下重新运行时，请根据需要指令G80。
表5.3.3(a)  
| CLR(No.3402#6) | C09(No.3407#1) | G代码 |
| --- | --- | --- |
| 0 | - | G84/G74 |
| 1 | 0 | G80 |
| 1 | 1 | G84/G74 |
联锁对G84(G74)也有效。
在G84(G74)方式下，若将参数FHD(No.5200#6)设定为0，进给保持、单程序段将无效。将其设定为1，进给保持、单程序段将有效。
参数FHD(No.5200#6)=0
在攻丝中应用进给保持时，进给保持指示灯立即点亮，但对于G98将在收回到基准平面后停止，对于G99将在收回到R点平面后停止。在到钻孔位置的定位、从基准平面到R点的定位、以及从R点平面到基准平面的收回动作中应用进给保持时。CNC进入自动运行休止状态，并减速停止。
参数FHD(No.5200#6)=
在从到钻孔位置的定位、到收回到基准平面（G98）（R点平面（G99））之间应用进给保持时，CNC进入自动运行休止状态，并减速停止。
单程序段中的停止点为到钻孔位置的定位、从基准平面到R点平面的定位、以及从R点平面到基准平面的收回（G98）（R点平面（G99））的结束后。
·参数FHD(No.5200#6)=单程序段中的停止点在各动作的结束后。
在手动手轮进给下进行刚性攻丝时，请参阅操作说明书（车床系统／加工中心通用）（B- 64484CM）“基于手动手轮的刚性攻丝”项。无法在除此以外的手动进给中进行刚性攻丝。
在刚性攻丝模式下，为了补偿主轴正转、反转时的空转，进行反冲补偿。请在参数(No.5321～5324)中设定反冲量。沿着钻孔轴的反冲补偿可按通常方式执行。
·如果指定的转速大于所用齿轮的最大转速，将会发生报警(PS0200)。·刚性攻丝中所使用的S在刚性攻丝的固定循环取消时被清除，S0变为被指定的状态。
在串联主轴的情形下，最大主轴分配量为32767pulse每8msec。（通过诊断数据(No.451)来显示。）此值随着位置编码器的齿轮比设定和刚性攻丝的指令而变化，指定了超过此上限的指令时，会发生报警(PS0202)。
当指定值超过切削进给上限值时，会有报警(PS0011)发出。
|  | 米制输入 | 英制输入 | 备注 |
| --- | --- | --- | --- |
| G94 | 1mm/min | 0.01inch/min | 允许用小数点编程 |
| G95 | 0.01mm/rev | 0.0001inch/rev | 允许用小数点编程 |
# M29
如果在M29和G84之间指定S指令和轴移动，会有报警(PS0203)发出。此外，如果在攻丝循环中指定M29，会有报警(PS0204)发出。
# P/Q
在进行钻孔操作的程序段中指定P、Q。如果被指定在不进行钻孔动作的程序段中，则不被当作模态数据存储。当Q0被指定时，则不执行深孔刚性攻丝循环。
# 子程序调用
# 返回量和切削开始距离
请以避免超过R点的方式设定返回量以及切削开始距离（No.5213）。
# 周速恒定控制
周速恒定控制中指令了刚性攻丝时，将会发生报警(PS0200）“非法的S代码指令”。在取消周速恒定控制后指令刚性攻丝。
# 通过最佳加速度定位
Z轴进给速度  $1000\mathrm{mm / min}$  主轴转速  $1000\mathrm{min - 1}$  螺纹的导程  $1.0\mathrm{mm}$  进刀量  $20.0\mathrm{mm}$  退刀量或切削开始位置  $10.0\mathrm{mm}$  （在参数(No.5213)中设定）<每分钟进给编程>G94；G00X120.0Y100.0；M29S1000；G74Z- 100.0R- 20.0Q20.0F1000；<每转进给编程>G95；G00X120.0Y100.0；M29S1000；G74Z- 100.0R- 20.0Q20.0F1.0；
# 5.3.4 固定循环取消(G80)
该循环取消刚性攻丝的固定循环。指令方法与钻孔固定循环取消相同，请参阅“5.1.14钻孔固定循环取消(G80)”项。
在刚性攻丝的固定循环取消时，刚性攻丝中所使用的S值也被清除。（与指定了S0的状态相同。）即，无法将为刚性攻丝指定的S用在取消刚性攻丝的固定循环之后的程序中。在取消刚性攻丝的固定循环后，请根据需要重新指定S。
# 5.3.5 刚性攻丝中的倍率
各类倍率虽然无效，但是通过设定参数可以使下列倍率有效。- 拉拔倍率- 倍率信号
# 5.3.5.1 拉拔倍率
拉拔倍率可以使参数中所设定的固定的倍率值或者程序中所指定的倍率值在拉拔时（含深孔/高速深孔时的收回时）有效。
# ·在参数中指定倍率
将参数DOV(No.5200#4)设定为1，在参数(No.5211)中设定倍率值。倍率值以  $1\%$  的刻度单位，可以在  $0\sim 200\%$  的范围内设定。此外，将参数OVU(No.5201#3)设定为1时，可以以  $10\%$  为刻度单位在  $0\sim 2000\%$  范围内设定。
# ·在程序中指定倍率
当将参数DOV(No.5200#4)和参数OV3(No.5201#4)设定为1时，拉拔时的主轴转速可以通过程序加以指定。在刚性攻丝的指令程序段中使用“J”地址来指定拉拔时的主轴转速。例）切削时  $\mathrm{S = 1000min - 1}$  拉拔时  $\mathrm{S = 2000min - 1}$  的情形
M29S1000； G84Z- 100.0F1000.0J2000;
实际的倍率值换算，按照如下方式计算。
因此，拉拔时的主轴转速在某些情况下与通过“J”地址指定的转速不一致。此外，倍率值超出  $100\% \sim 200\%$  的范围时，被固定在  $100\%$  上。
倍率值（%） = 拉拔时的主轴转速（J指令）  $\times 100$  主轴转速（S指令）
通过参数设定和指令变为实际有效的倍率，如表5.3.5.1(a)所示。
表5.3.5.1(a)  
| 参数设定 | DOV=1 | DOV=0 |
| --- | --- | --- |
| 指令 | OV3=1 | OV3=0 |
| 存在由地址“J”指定的拉拔时的主轴转速指令 | 100～200%的范围内 | 程序指令 |
| 100～200%的范围外 | 100% |  |
| 不存在由地址“J”指定的拉拔时的主轴转速指令 | 参数(No.5211) |  |
1 请勿将小数点使用于地址“J”的指令中。使用小数点时，变为如下所示的情形。
例）基准轴的设定单位为IS- B时
·非计算器型小数点输入时，指令值被变换为考虑了最小设定单位的数值。“J200.0”为20000min- 1。·计算器型小数点输入时，变换为舍去了小数点以后部分的数值。“J200.0”为200min- 1。
2 请勿在地址“J”的指令中使用负号。
使用负号时，视为指定了  $100\sim 200\%$  范围外的值。
3 应用了拉拔倍率值的主轴转速，通过下列计算求出倍率的最大值，以免超过使用中的齿轮的最高转速（参数 $(\mathrm{No}.5241\sim \mathrm{No}.5244)$  ）。因此，根据倍率值，求得的值在某些情况下与主轴最高转速不一致。
主轴最高转速（参数设定）  $\times 100$  倍率最大值  $(\%) =$  主轴转速（S指令）
4 指定拉拔时的主轴转速的地址“J”，被在刚性攻丝模式下指定时，直到取消固定循环之前都有效。
# 5.3.5.2 倍率信号
将参数OVS(No.5203#4)设定为1时，即可对刚性攻丝中的切削/拉拔动作应用下列所示的倍率。
·通过进给速度倍率信号应用倍率（第2进给速度倍率信号为“1”时，对应用了进给速度倍率后的速度，应用第2进给速度倍率。）·通过倍率取消信号取消倍率
本功能与每个动作的倍率关系，如下所示。
·切削时倍率取消信号为0的情形、通过倍率信号指定的值倍率取消信号为1的情形、  $100\%$  ·拉拔时倍率取消信号为0的情形、通过倍率信号指定的值在倍率取消信号为1，拉拔倍率无效的情形、  $100\%$  拉拔倍率有效时、通过拉拔倍率指定的值
1 应用了倍率值的主轴转速，通过下列计算求出倍率的最大值，以免超过使用中的齿轮的最高转速（参数(No.5241\~No.5244)）。因此，根据倍率值，求得的值在某些情况下与主轴最高转速不一致。倍率最大值  $(\%) =$  主轴最高转速（参数设定）  $\times 100$  主轴转速（S指令）
2 倍率的操作，随所使用的机床而不同，请参阅机床制造商提供的说明书。
# 5.4 任意角度的倒角和倒圆
可以在以下插补之间自动插入倒角程序段和倒圆程序段。
·在直线插补与直线插补之间·在直线插补与圆弧插补之间·在圆弧插补与直线插补之间·在圆弧插补与圆弧插补之间
本功能可以与AI轮廓控制一起使用。

当在指定直线插补(G01)或圆弧插补(G02、G03)程序段的末尾指定上述格式时，则插入一个倒角程序段或倒圆程序段。可以连续指定两个以上的倒角程序段和倒圆程序段。
# ·倒角
紧跟C的数值指定从假想拐角交点起的倒角起点到终点的距离，所谓假想拐角就是不进行倒角时假设存在的拐角。
![](images/402e0081bdab24d23b44fe7f9232be949a292155dcb5f4e5564d17d087afbfcb.jpg)  
图5.4（a）倒角
# ·倒圆
紧跟在R后的数值指定倒圆的半径。
![](images/957b2c9b6311cf11949d3d7d7f05c03f5c0508c53da0f227a854d25d77a65de2.jpg)  
图5.4（b）倒圆
N001 G92 G90 X0 Y0;  N002 G00 X10.0 Y10.0;  N003 G01 X50.0 F10.0, C5.0;  N004 Y25.0, R8.0;  N005 G03 X80.0 Y55.0 R30.0, R8.0;  N006 G01 X50.0, R8.0;  N007 Y70.0, C5.0;  N008 X10.0, C5.0;  N009 Y10.0;  N010 G00 X0 Y0;  N011 M0;
![](images/13e2ab8181a05254bfe6546b24788ffcc0dbbc86d0534382e1a2777e790a263b.jpg)  
图5.4（c）加工例
# ·无效指令
在直线插补(G01)和圆弧插补(G02、G03)以外的程序段中即使指定倒角，(C)或者倒圆，(R)即将被忽略。
# ·下一程序段
指定倒角操作或倒圆操作的程序段后面，必须是直线插补(G01)或(G02、G03)的移动指令的程序段。如果是除此之外的指令，会有报警(PS0051)发出。但是，在这些程序段之间，可以仅插入一个G04（暂停）程序段。在执行已被插入的倒角和倒圆的程序段后进入暂停状态。
# ·超出移动范围时
如果插入倒角程序段或倒圆程序段而导致超出原先的插补移动范围，则会有报警(PS0055)发出。
![](images/2547c44a5f3afb145384909d21b92b8d1721892bb594617d5bc4dc99e90a3ca7.jpg)  
图5.4（d）超出移动范围时
# ·平面选择
只有对相同平面内的移动指令才插入倒角程序段或倒圆程序段。
例：
在将U轴设定为基本X轴的平行轴时（参数  $(\mathrm{No.1022}) = 5$  ），在其后的程序中，在U轴的切削进给和Y轴的切削进给之间进行倒角处理。
G17U0Y0 G00U100.0Y100.0 G01U200.0F100,C30.0 Y200.0
但是，在其后的程序发出报警(PS0055)。（由于在尚未进行平面选择的X轴的移动程序段中指定了倒角）
G17U0Y0 G00U100.0Y100.0 G01X200.0F100,C30.0 Y200.0
在其后的程序也发出报警(PS0055)。（由于倒角指令之后的程序段是尚未进行平面选择的X轴的移动程序段）
G17U0Y0 G00U100.0Y100.0 G01Y200.0F100,C30.0 X200.0
在指定了倒角或者倒圆的下一个程序段中指定了平面选择(G17、G18、G19)时，会有报警(PS0051)发出。
# ·移动量0
当进行两个直线插补操作时，如果两条直线之间的角度差在  $\pm 1^{\circ}$  以内，则认为倒角或倒圆程序段的移动量为0。当进行直线插补和圆弧插补操作时，如果直线和圆弧在交点处切线之间的角度差在  $\pm 1^{\circ}$  以内，则认为倒圆程序段的移动量为0。当进行两个圆弧插补时，如果交点处两个圆弧切线之间的角度差在  $\pm 1^{\circ}$  以内，则认为倒圆程序段的移动量为0。
# ·宏程序执行器
执行宏中的任意角度倒角和倒圆指令无效。
# ·单程序段运行
在单程序段中运行指定了倒角及倒圆的程序段时，操作一直持续到新插入的倒角或倒圆的程序段的终点，机床在该终点以进给保持方式停止。但是，将参数SBC(No.5105#0)设定为1时，即使在已被插入的倒角或倒圆的程序段的起点，机床也会以进给保持方式停止。
1 在相同程序段中指定了“C”和“R”时，最后指定的那个地址有效。2 在螺纹切削的指令程序段中指定了“C”或“R”时，会有报警(PS0050)发出。
# 5.5 分度工作台分度功能
通过给分度轴（旋转轴A、B、C中的其中之一）指定分度位置（角度），既可进行加工中心的分度工作台的分度。在分度工作台移动之前和之后，分度工作台自动松开或夹紧。
本功能在参数 IXC(No.8132#3)被设定为 1 时可以使用。</td></tr></table>
# ·分度位置
地址以A、B或C指定分度位置
分度位置可以用下面任何一种方法指定（取决于参数G90(No.5500#4)的设定）。
1. 始终是绝对值
2. 基于绝对/增量指令G代码G90/G91的值
正值表示逆时针方向分度位置，负值表示顺时针方向分度位置。
分度工作台的最小分度角度是设定在参数(No.5512)中的值。只有整数倍的值才能指定为分度角度。如果指定不是整数倍的值，则会有报警(PS1561)发出。此外，还可以输入以度为单位的小数。
![](images/19b1b5e24d04d0d43462df49dff43627829cd0aa8b457cd4a4901cf0f15e1270.jpg)  
图5.5(a)分度位置
# ·旋转方向和旋转值
旋转方向和旋转值可以用下面两种方法中的任何一种决定，请参阅机床制造商提供的说明书，找出哪一种方法适用。
1. 使用在参数（No.5511）中设定的辅助功能的方法
（地址）（分度位置）（辅助功能）；朝负方向旋转（地址）（分度位置）；朝正方向旋转（没有指定辅助功能）
当参数ABS(No.5500#2)指定该选项时，大于360度的旋转角度被四舍五入成360度以内的相应旋转值。譬如，当G90B400.0（辅助功能）；被指定在0度位置时，工作台在负方向旋转40度。
2. 不使用辅助功能的方法
通过设定参数ABS、INC、G90B50.5500#2、#3、#4)，即可选择下列2种操作。选择操作时，请参阅机床制造商提供的说明书。
（1）在旋转角度最小的方向旋转
这种旋转只有在绝对方式下才有效，通过参数ABS(No.5500#2)的设定，指定的旋转角度大于360度时被四舍五入成360度以内的相应旋转值。譬如，当“G90B400.0”被指定在0度位置时，工作台在正方向旋转40度。
(2）在绝对编程方式下，通过设定参数ABS(No.5500#2)，指定的旋转角度大于360度时，有的会被四舍五入成360度以内的相应旋转值，而有的则不会被四舍五入成360度以内的相应旋转值。在增量方式下，旋转值不四舍五入。譬如，当“G90B720.0”被指定在0度位置时，工作台在正方向旋转两次（而旋转值不四舍五入）。
# ·进给速度
执行分度工作台分度的控制轴（以下称分度工作台分度轴）工作台始终绕分度轴以快速进给方式旋转。分度工作台分度轴无法执行空运行。
| 注意 |
| --- |
| 1 如果在分度工作台分度轴移动期间复位，则以后在进行分度工作台分度之前，务须进行参考点返回。 2 不使用分度工作台分度功能的路径，请将分度工作台分度功能设定为无效（参数ITI(No.5501#0)=0）。 |
1 在相同的程序段中指令分度工作台分度轴和其它控制轴时，通过参数SIM(No.5500#6)、IXS(No.5502#0)发出报警(PS1564)，或执行指令。2 指定负方向的辅助功能被在CNC的内部进行处理，而相关的M代码信号和完成信号在CNC和机床之间传输。3 如果在等待夹紧或松开完成的状态下进行复位，夹紧信号或松开信号就被清除。此外，CNC则从等待完成的状态中退出。
# - 分度工作台分度功能和其他功能
表5.5（a）分度工作台分度功能和其他功能  
| 项目 | 说明 |
| --- | --- |
| 相对位置显示 | 当参数REL(No.5500#1)指定该选项时，这个值被四舍五入。 |
| 绝对位置显示 | 当参数ABS(No.5500#2)指定该选项时，这个值被四舍五入。 |
| 单向定位 | 无法指定。 |
| 第2辅助功能(B代码) | 对于B以外的分度工作台分度轴的任何地址都是可能的。 |
| 分度工作台分度轴移动中的操作 | 除非由机床进行特殊处理，否则就可以进行进给保持、联锁和急停。分度完成后机床锁住有效。 |
| 伺服关断信号 | 无效。 通常情况下，分度轴处于伺服关断状态。 |
| 发给分度工作台分度轴的增量指令 | 分度工作台分度轴上的机床坐标系和工件坐标系必须互相一致(工件原点偏置值为0)。 |
| 分度工作台分度轴的操作 | 在JOG、INC以及HND模式下，手动运行无效。 可以进行手动参考点返回。 如果在手动参考点返回期间抽选择信号设为0，则移动停止，不执行夹紧指令。 |
| 磁极位置检测功能 | 使用磁极位置检测功能的轴上无法使用本功能。 |
# 5.6 横向进给控制(磨床用)
在转塔终点每次输入机床操作面板上的开关时，刀具沿着所指定的Y- Z平面上的程序形状每次切入一定量。由此，磨削和切削密切配合进行，从而可以简单进行具有轮廓的工件的磨削。
本功能包含在“磨床用功能A”以及“磨床用功能B”的选项功能中。如需使用本功能，需要上述选项的任何一个
![](images/5be688f5562e687e6f5d39cb1edb8b905a9807ce0989af7ca70c04fbc59f82a4.jpg)  
图5.6(a)
比如，可以在图5.6(a)所示的Y－Z平面上，对通过直线插补－圆弧插补－直线插补编程的形状的工件进行加工。在  $\mathbf{X} = 0$  的位置配置传感器，当传感器检测到磨轮时，机床操作面板上的开关即被输入。在A点开始程序时，首先为机床操作面板上的开关输入等待状态。这里，传感器检测到磨轮时，输入机床操作面板上的开关，刀具沿着所指定的Y－Z平面上的程序形状进行一定量a的切削，并移动到B点（动作(1)）。并且，再次进入机床操作面板上的开关输入等待状态，在此期间刀具执行向X轴方向的磨削动作。刀具从B点向C点磨削（动作(2)），执行从C点返回B点的磨削（动作(3)）。刀具返回B点后传感器再次检测磨轮，输入机床操作面板上的开关，刀具进行α的切削，并移动到D点（动作(4)）。刀具在D点执行向X轴方向的磨削动作。
之后，每次输入机床操作面板上的开关，刀具就沿着形状程序执行α的切削，进行如图5.6(a)所示形状的工件加工。
| G161 R ; |
| --- |
| 形状程序 |
| G160 ; |
务须通过单程序段来指令G160、G161。（请勿同时指定其他的G代码）
# G161R
指令操作模式和形状程序的开始。另外，还通过R指定切削量。
# ·形状程序
通过直线插补(G01)或圆弧插补(G02，G03)，在Y- Z平面编制工件形状程序。可以指令多个程序段。
开始形状程序时，系统成为机床操作面板上的开关输入等待状态。在此状态下输入机床操作面板上的开关时，刀具只切入由R所指定的切削量。之后，到程序的终点，每次输入机床操作面板上的开关刀具就进行切削。最后的切削不足R的情况下，待走量即为切削量。
进给速度为用F代码编程的速度。其与通常的直线插补(G01)或者与圆弧插补(G02,G03)一样应用倍率。
# ·G160
指令动作模式的取消（形状程序结束）。
# ·G161R
没有R指令或者R的指令值为负时发出报警(PS0230)。
请勿在形状程序中指定直线插补(G01)或圆弧插补(G02,G03)以外的移动指令。
形状程序中进行了直线插补(G01)或者圆弧插补(G02,G03)以外的移动指令时，不会变为所指定的切入量。
# ·磨削动作
本动作模式中，无法在NC程序中指令使磨轮往返移动的磨削动作。请通过其他方法进行指令。
# ·程序段搭接
动作模式中，程序段搭接无效。
# ·机床操作面板上的开关
开始形状程序之前，即使输入机床操作面板上的开关也无效。开始形状程序后，请在机床操作面板上的开关输入等待状态下输入机床操作面板上的开关。此外，切削中即使输入机床操作面板上的开关，也不会作为下一个切削受理，所以，请在切削结束后，在机床操作面板上的开关输入等待状态下进行输入。
![](images/5a4d27de31af4163cceaf9e2fc1bb3987b9a924607c5372e5b4432a44543d54d.jpg)  
图5.6 (b)
在上面的程序中，每进行一次机床操作面板上的开关输入，刀具沿图5.6(b)所示的加工形状移动10.000。 $\alpha =$  机床操作面板上的每次开关输入的移动量。进给速度为用F代码编程的速度。
注释横向进给控制中进行手动干预时，手动干预后的刀具路径与通常的直线/圆弧插补一样，可以通过手动绝对ON/OFF来进行切换。手动绝对ON时，在绝对指令、或者参数ABS(No.700#1)=1下的增量指令时，机床返回编程路径。
# 5.7 磨削用固定循环（磨床用）
磨削用固定循环使程序员编制程序更容易，它可以用包含G功能的一个程序段来指令通常需要用几个程序段才能指令的磨削加工特有的反复加工动作。同时可以减小程序，从而有效使用存储器。磨削用固定循环有如下4种。
切入式磨削循环(G75)切入式直接恒定尺寸磨削循环(G77)连续进给表面磨削循环(G78)间歇进给表面磨削循环(G79)
下面的说明中进行磨轮切削的轴、进行磨轮磨削的轴、进行修整砂轮切削的轴，按照如下方式表述。
砂轮切削的轴： 切削轴砂轮磨削的轴： 磨削轴修整砂轮切削的轴： 修整轴
磨削用固定循环执行过程中，无法使用如下功能。
可编程镜像比例缩放坐标系旋转3维坐标变换F1位进给刀具长度补偿
切削轴的切削量、以及磨削轴的磨削量的设定单位，遵从基准轴（参数(No.1031)）的设定单位（参数(No.1013)）。基准轴（参数(No.1031)）的设定值为0的情形下，遵从第1轴的设定单位。
磨削用固定循环的G代码(G75,G77,G78,G79)为01组的G代码。没有用于取消钻孔用固定循环的G80之类的G代码。通过指令G04以外的00组的G代码，虽然切削量等的模态信息将被清除，但是无法取消磨削用固定循环。要取消磨削用固定循环，需要指令G75,G77,G78,G79以外的01组的G代码。因此，从磨削用固定循环切换到其他的轴移动指令时，务必指令G00，G01之类的01组的G代码，并取消磨削用固定循环。如果没有取消磨削用固定循环就进行其他的轴移动指令，则循环将会继续而有可能导致预想外的动作。
1 本功能包含在“磨床用功能A”以及“磨床用功能B”的选项中。如需使用本功能，需要上述选项的任何一个。2 指令了磨削用固定循环的G代码(G75,G77,G78,G79)而本循环有效期间，在其后的指令程序段中即便没有G75,G77,G78,G79的指令，也许根据作为模态数据而保存的I,J,K,α,R,F,P的值执行磨削用固定循环。例.G75LJ_K_α_R_F_,P_；←即使是空的程序段也执行磨削用固定循环%3 从钻孔固定循环切换到磨削用固定循环时，请指令G80，并取消固定循环。4 从磨削用固定循环切换到其它的轴移动指令时，请根据上述警告中所记述的方法，取消固定循环。
# 5.7.1 切入式磨削循环(G75)
进行切入式磨削循环。
![](images/8a0eab24eadadf4578de7dc9263a9dca8e275d041545b3d401aa725afad37025.jpg)
$\alpha$  系由参数(No.5176)确定的磨削轴的任意的轴地址。
切入式磨削循环由6个动作顺序组成。在切削量到达地址K指定的总切削量之前，重复进行(1)至(6)的动作。在单程序段方式下，每次循环开始时都执行(1)至(6)的动作。
# - 循环中的动作顺序
# (1) 磨轮切削
在切削进给方式下沿Y轴方向切削由第1切削量I所指定的量。切削速度为由R所指定的速度。
# (2) 暂停
仅在由P所指定的时间内进行暂停。
# (3) 磨削
按照切削进给方式仅移动由α所指定的量。由参数(No.5176)来设定磨削轴的指定。切削速度变为由F所指定的速度。连续修整动能有效时，在指令了L的情况下，执行由切削轴和修整轴进行的修整。修整轴通过参数(No.5180)来设定。
# (4) 磨轮切削
在切削进给方式下沿Y轴方向切削由第2切削量J所指定的量。切削速度为由R所指定的速度。
# (5) 暂停
# (6) 磨削 (返回方向)
沿着相反方向以F所指定的速度进给由α所指定的量。连续修整动能有效时，在指令了L的情况下，执行由切削轴和修整轴进行的修整。
# ·连续修整
连续修整功能有效时，磨削执行中，根据由L所指令的修整量，对磨轮的切削以及修整砂轮的切削连续进行补偿。即，在循环中的动作顺序的每个磨削动作时都进行连续修整，在磨削轴移动的同时，成为基于切削轴方向的补偿以及修整轴方向的补偿的同时3轴插补。此时，切削轴的移动量(补偿值)作为所指定的修整值，修整轴的移动量是所指定的修整量的2倍(直径)的值。
修整量通过地址L指定偏置号。偏置号最多可以指令400个  $(\mathrm{L1}\sim \mathrm{L400})$  。对应于偏置号，通过MDI单元预先在偏置存储器中设定补偿量。
下列情况下不进行补偿动作。
连续修整功能无效的情形；
尚未指令L的情形；
指令了L0的情形。
![](images/737464a0fcc0835743e1c09651e7ec0e13702ce2e55a3237bb2162640accd4fa.jpg)
# ·切削轴
切削轴作为控制轴的第2轴。通过将参数  $\mathrm{FXY(No.5101\#0)}$  设定为1，即可进行基于平面选择指令(G17,G18,G19)的切换。
# ·磨削轴
磨削轴在参数(No.5176)中设定切削轴以外的轴号。
# ·修整轴
修整轴在参数(No.5180)中设定切削轴和磨削轴以外的轴号。
# ·αJ.J.K
αJ.J.K的指令，均为增量指令。
下列情况下为无火花磨削（只执行磨削方向的移动）。
没有指定I，J的情形或  $\mathrm{I} = \mathrm{J} = 0$  的情形没有指定K的情形或  $\mathrm{K} = 0$  的情形
没有指定I，J的情形或  $\mathrm{I} = \mathrm{J} = 0$  的情形下，进而在  $\mathrm{K}\neq 0$  的情形下无限制地进行磨削动作。
# ·清除
·清除在固定循环中的数据I,J,K,α,R,F,P是G75,G77,G78,G79共同的模态信息，只要不重新指令，以前所指令的数据保持有效。该数据在指定G04以外的00组G代码或G75、G77、G78、G79以外的01组G代码时将被清除。L仅在其被指令的程序段中有效。
# ·达到总切削量时的动作
在用I或J进行切削期间，当切削量达到总切削量时，执行之后的动作顺序(直到(6)），然后结束循环。在这种情况下，在达到总切削量位置之后不再进行进一步的切削。
在由I或J指定的切削动作达到总切削量时
![](images/8f67c893f175d437a5aba998072e3e755c419c67b9f5757d21de5371ab4b8ed9.jpg)
在I或J的切削动作过程中还到总切削量时
![](images/2640142ba83750826c322a34be684aef5d32b1cd8f8ce3bd0796e9b90f784bbf.jpg)
注释1 I,J,K的符号不同时，会发出报警(PS0455)。2 指令了G75时，在没有进行磨削轴指令的情况下，会有报警(PS0455)发出。3 切削轴号、磨削轴号或修磨轴号为相同轴号时，会发出报警(PS0456)。4 本循环有效期间，即使指令了G90（绝对指令），α,I,J,K的指令也将作为增量指令。
# 5.7.2 切入式直接恒定尺寸磨削循环 (G77)
进行切入式直接恒定尺寸磨削循环。
![](images/67fc66dac0217ef6e8d2bb56fbf02051b90876d538a8a6ba3159be30086176de.jpg)
注释 $\alpha$  系由参数(No.5177)确定的磨削轴的任意的轴地址。
解释切入式直接恒定尺寸磨削循环由6个动作顺序组成。在切削量到达地址K指定的总切削量之前，重复进行(1)至(6)的动作。在单程序段方式下，每次循环开始时都执行(1)至(6)的动作。
# ·循环中的动作顺序
(1) 磨轮切削在切削进给方式下沿Y轴方向切削由第1切削量I所指定的量。切削速度为由R所指定的速度。
(3) 磨削按照切削进给方式仅移动由α所指定的量。由参数(No.5177)来设定磨削轴的指定。切削速度变为由F所指定的速度。连续修整功能有效时，在指令了L的情况下，执行由切削轴和修整轴进行的修整。修整轴通过参数(No.5181)来设定。
(4) 磨轮切削在切削进给方式下沿Y轴方向切削由第2切削量J所指定的量。切削速度为由R所指定的速度。
# (6) 磨削（返回方向）
沿着相反方向以F所指定的速度进给由α所指定的量。连续修整功能有效时，在指令了L的情况下，执行由切削轴和修整轴进行的修整。
连续修整功能有效时，磨削执行中，根据由L所指令的修整量，对磨轮的切削以及修整砂轮的切削连续进行补偿。详情请参阅G75的解释。
# ·跳转信号输入时的动作
G77中，通过在循环过程中输入一个跳过信号，在使当前的动作顺序中断(或者使当前的动作顺序结束)后，可以使循环终止。
下面列出在每个动作顺序中跳转信号输入时的动作。
·在动作顺序(1)、(4)中（IJ移动时）跳转信号输入时，立即停止切削操作，刀具返回到循环开始时的α坐标。
![](images/b04b256a3e32891eed46667b87a86f07fd49d2ea8c9e8a433e8362333069f21a.jpg)
·在动作顺序(2)、(5)中(暂停中)跳过信号被输入时，立即停止暂停，刀具返回到循环开始时的α坐标。·在动作顺序(3)、(6)中(磨削移动时)跳过信号被输入时，在α的移动结束后，刀具返回到循环开始时的α坐标。
![](images/9878110f3bc3e74522e627bbf32ce0a697993da7c8dbe2bec8fb3307b51802e9.jpg)
切削轴作为控制轴的第2轴。通过将参数FXY(No.5101#0)设定为1，即可进行基于平面选择指令(G17,G18,G19)的切换。
磨削轴在参数(No.5177)中设定切削轴以外的轴号。
修整轴在参数(No.5181)中设定切削轴和磨削轴以外的轴号。
# ·α,I,J,K
α,I,J,K的指令，均为增量指令。下列情况下为无火花磨削（只执行磨削方向的移动）。- 没有指定IJ的情形或  $\mathrm{I} = \mathrm{J} = 0$  的情形- 没有指定K的情形或  $\mathrm{K} = 0$  的情形
没有指定IJ的情形或  $\mathrm{I} = \mathrm{J} = 0$  的情形下，进而在  $\mathrm{K}\neq 0$  的情形下无限制地进行磨削动作。
基于I或J的切削时，达到总切削量时的动作与G75相同。请参阅G75的限制。
注释1. LJ.K的符号不同时，会发出报警(PS0455)。2. 指令了G77时，在没有进行磨削轴指令的情况下，会有报警(PS0455)发出。3. 切削轴号、磨削轴号或修整轴号为相同轴号时，会发出报警(PS0456)。4. 本循环有效期间，即使指令了G90（绝对指令），α,I,J,K的指令也将作为增量指令。
# 5.7.3 连续进给表面磨削循环(G78)
进行连续进给表面磨削循环。
![](images/3fe13517e3b0f48b2ad11abcf7c6aa5eec43e56a20be56a4e160ebf1c561f24c.jpg)
注释 $\alpha$  系由参数(No.5178)确定的磨削轴的任意的轴地址。
解释连续进给表面磨削循环由4个动作顺序组成。在切削量到达地址K指定的总切削量之前，重复进行(1)至(4)的动作。在单程序段方式下，每次循环开始时都执行(1)至(4)的动作。
# (1) 暂停
# (2) 磨轮切削十磨削
(2) 磨轮切削十磨削切削轴（Z轴）和磨削轴同时进行切削进给。切削轴的移动量（切削量）作为由第1切削量I所指定的量，磨削轴的移动量作为由α所指定的量。由参数(No.5178)来设定磨削轴的指定。切削速度变为由F所指定的速度。连续修整功能有效时，在指令了L的情况下，执行由切削轴和修整轴进行的修整。修整轴通过参数(No.5182)来设定。
# (3) 暂停
# (4) 磨轮切削十磨削（返回方向）
(4) 磨轮切削十磨削（返回方向）切削轴（Z轴）和磨削轴同时进行切削进给。切削轴的移动量（切削量）作为由第2切削量J所指定的量，磨削轴的移动量作为由α所指定的量相反的方向。切削速度变为由F所指定的速度。连续修整功能有效时，在指令了L的情况下，执行由切削轴和修整轴进行的修整。
·连续修整连续修整功能有效时，磨削执行中，根据由L所指令的修整量，对磨轮的切削以及修整砂轮的切削连续进行补偿。详情请参阅G75的解释。
·切削轴切削轴作为控制轴的第3轴。通过将参数FXY(No.5101#0)设定为1，即可进行基于平面选择指令(G17,G18,G19)的切换。
磨削轴在参数(No.5178)中设定切削轴以外的轴号。
修整轴在参数(No.5182)中设定切削轴和磨削轴以外的轴号。
# ·J
·J尚未指令J时，视为  $\mathrm{J} = \mathrm{I}_{\circ}$  J指令只在其被指令的程序段中才有效。
# ·α,J,J,K
α,J,J,K的指令，均为增量指令。下列情况下为无火花磨削（只执行磨削方向的移动）。
没有指定IJ的情形或  $\mathrm{I} = \mathrm{J} = 0$  的情形没有指定K的情形或  $\mathrm{K} = 0$  的情形
·清除在固定循环中的数据I,K,α,F,P是G75,G77,G78,G79共同的模态信息，只要不重新指令，以前所指令的数据保持有效。该数据在指定G04以外的00组G代码或G75、G77、G78、G79以外的01组G代码时将被清除。J,L仅在其被指令的程序段中有效。
在用I或J进行切削期间，当切削量达到总切削量时，执行之后的动作顺序(直到(40)，然后结束循环。在这种情况下，在达到总切削量位置之后不再进行进一步的切削。
·在由I或J指定的切削动作达到总切削量时
![](images/ad0140f64b310faa8fd1cf7d4f21d403642cb4e07aa1ff28e2fbb68566e60e40.jpg)
·在I或J的切削动作过程中达到总切削量时
![](images/cb10a41f9803f03a517632423aa1a14fa9712c1cc8fc82a66201616cf44999f4.jpg)
注释1 I,J,K的符号不同时，会发出报警(PS0455)。2 指令了G78时，在没有进行磨削轴指令的情况下，会有报警(PS0455)发出。3 切削轴号、磨削轴号或修整轴号为相同轴号时，会发出报警(PS0456)。4 未循环有效期间，即使指令了G90（绝对指令），α,I,J,K的指令也将作为增量指令。
# 5.7.4 间歇进给表面磨削循环 (G79)
进行间歇进给表面磨削循环。
![](images/f8da0d48bf457d50569693b9c8efe424c60b10b63a5fc75bb857ee48caa57239.jpg)
$\alpha$  系由参数(No.5179)确定的磨削轴的任意的轴地址。
间歇进给表面磨削循环由6个动作顺序组成。在切削量到达地址K指定的总切削量之前，重复进行(1)至(6)的动作。在单程序段方式下，每次循环开始时都执行(1)至(6)的动作。
(1) 磨轮切削在切削进给方式下按照第1切削量I指定的量，沿Z轴方向进行切削。切削速度为由R所指定的速度。
按照切削进给方式仅移动由α所指定的量。由参数(No.5179)来设定磨削轴的指定。切削速度变为由F所指定的速度。连续修整功能有效时，在指令了L的情况下，执行由切削轴和修整轴进行的修整。修整轴通过参数(No.5183)来设定。
在切削进给方式下仅按照第2切削量J所指定的量，沿Z轴方向进行切削。切削速度为由R所指定的速度。
磨削轴在参数(No.5179)中设定切削轴以外的轴号。
修整轴在参数(No.5183)中设定切削轴和磨削轴以外的轴号。
α,I,J,K的指令，均为增量指令。下列情况下为无火花磨削（只执行磨削方向的移动）。
注释1 I,J,K的符号不同时，会发出报警(PS0455)。2 指令了G79时，在没有进行磨削轴指令的情况下，会有报警(PS0455)发出。3 切削轴号、磨削轴号或修整轴号为相同轴号时，会发出报警(PS0456)。4 本循环有效期间，即使指令了G90（绝对指令），α,I,J,K的指令也将作为增量指令。
# 6 补偿功能
# 6.1 刀具长度补偿位移类型
可以通过程序坐标系的位移来执行刀具长度偏置的动作。进行刀具长度补偿的轴的坐标系仅位移刀具长度补偿值。可以通过参数TOS(N0:3000#0)或参数TOP(N0:11400#2)选择刀具长度补偿位移类型。
没有与G43、G44或G49一起指定移動指令时，轴不会移动。有与G43、G44或G49一起指定的移动指令时，在坐标系位移后，将进行轴的移动。
根据可以进行刀具长度补偿的轴的种类，可使用如下三种刀具长度补偿的方法。
刀具长度补偿A补偿沿乙轴方向的刀具长度值。刀具长度补偿B补偿沿X轴方向、Y轴方向或乙轴方向的刀具长度值。刀具长度补偿C补偿沿指定轴方向的刀具长度值。
# 刀具长度补偿A
G43Z_H_；坐标系沿乙轴方向朝正侧仅位移补偿值G44Z_H_；坐标系沿乙轴方向朝负侧仅位移补偿值G43（或G44）：刀具长度补偿开始正（或负）侧偏置H_ ：刀具长度补偿值指定地址
# 刀具长度补偿B
G17G43Z_H_；坐标系沿乙轴方向朝正侧仅位移补偿值G17G44Z_H_；坐标系沿乙轴方向朝负侧仅位移补偿值G18G43Y_H_；坐标系沿X轴方向朝正侧仅位移补偿值G18G44Y_H_；坐标系沿X轴方向朝负侧仅位移补偿值G19G43X_H_；坐标系沿Y轴方向朝正侧仅位移补偿值G19G44X_H_；坐标系沿Y轴方向朝负侧仅位移补偿值G17（或G18、G19） ：平面选择G43（或G44） ：刀具长度补偿开始正（或负）侧偏置H_ ：刀具长度补偿值指定地址
# 刀具长度补偿C
G43a_H_；坐标系沿指定轴方向朝正侧仅位移补偿值G44a_H_；坐标系沿指定轴方向朝负侧仅位移补偿值G43（或G44） ：刀具长度补偿开始正（或负）侧偏置α_ ：任意一个轴的地址H_ ：刀具长度补偿值指定地址
# 刀具长度补偿取消
G49；或H0；刀具长度补偿取消G49（或H0）：刀具长度补偿取消
# - 偏置方向
H代码中所指定的（设定在偏置存储器中）刀具长度补偿值为G43时，坐标系朝正侧位移，为G44时坐标系朝负侧位移。刀具长度补偿的符号为负时，若是G43坐标系就朝负侧位移，而若是G44坐标系就朝正侧位移。G43和G44是模态G代码，在属于同一组的另一个G代码使用前有效。
# - 刀具长度补偿值的指定
使用与由H代码指定的编号（偏置号）对应的刀具长度补偿值（设定在偏置存储器中）。与偏置号0相对应的刀具长度补偿始终为0。不可设定与H0对应的刀具长度补偿值。
# - 补偿轴
通过参数TLC、TLB（No.5001#0、#1）来指定刀具长度补偿A、B或C。
# - 指定沿着2个或更多个轴的偏置
当偏置轴在多个程序段中被指定时，可以沿着2个或更多个轴进行刀具长度补偿B。
使X、Y轴偏置时G19G43H_；使X轴偏置G18G43H_；使Y轴偏置
在刀具长度补偿C中，如果将参数TAL（No.5001#3）设定为1，即使沿着2个或多个轴同时进行偏置，也不会发出报警。
# - 取消刀具长度补偿
要取消偏置时，指定G49或H0。取消刀具长度补偿时，坐标系的位移返回原处。另外，如果没有此移动指令，轴就不会移动。
# 有关刀具长度补偿开始以及取消时的动作
使用刀具长度补偿位移类型（参数TOS(No.5006#6)=1或者参数TOP(No.11400#2)=1）时，在刀具径补偿等模式中（※1），指令刀具长度补偿等（※2）的开始，或者取消时，在指令了开始或取消的程序段结束之前，不进行之后的程序段的预读。因此，成为如下所示动作。
- 在被指令开始或取消的程序段，暂时减速后停止。- 由于没有进行预读，刀具径补偿的补偿矢量作为与开始或取消被指令紧之前的程序段垂直的矢量。因此，在该指令的前后，有可能发生过切或不充分切削。- 在开始或取消被指令的程序段结束之前，不执行之后所指令的用户宏程序。
※1在如下指令中，不再执行程序段的预读
- 组07的G代码为G40以外的情形（刀具径补偿（G41/G42）的各模式中的情形）
※2符合如下指令。
- 刀具长度补偿（G43/G44）
# 在刀具径补偿中发生过切的例子）
在刀具径补偿模式中进行刀具长度补偿的开始或取消时，有可能会发生过切。
：G40G49G00G90X0Y0Z100. ；N1G42G01X10. Y10. F500D1； 刀具径补偿开始N2G43Z0. H2； 刀具长度补偿开始N3X100. ；N4Y100. ；N5X10. ；N6Y10. ；N7G49Z100. ； 刀具长度补偿取消N8#100- #5023； 用户宏程序N9G40X0Y0； 刀具径补偿取消
![](images/6cf36f8417d9878c362864319cb859bb24a227abc7525e0928a49cc96bfd45f3.jpg)
N2包含刀具径补偿(G42)模式中的G43（刀具长度补偿的开始），所以不进行N3以后的程序段的预读。结果，
刀具在N2- N3之间暂时减速后停止。
·N1的终点处的刀具径补偿的矢量与N1的程序段垂直。（有可能导致过切。）在假设执行了预读的情况下，作为与N2的起点垂直的矢量，不会发生过切。
![](images/fb11681e68707a7d57bbcd84276d2418457959adc1d4ba38693d6a56fa94f72f.jpg)
N7包含G42模式中的G49（刀具长度补偿的取消），所以不进行N8以后的程序段的预读。结果，
·刀具在N7的终点暂时减速后停止。·在等待N7结束后执行N8的用户宏程序。即，此例中，#100作为在N7的终点位置的Z轴的机械坐标值。（#5023：第3轴的机械坐标值)在假设已经执行了预读的情况下，N8的执行在N8的预读时刻、即N7的结束前执行，所以#100作为比N7的终点靠前的位置。·N6的终点处的刀具径补偿的矢量与N6的程序段垂直。（有可能导致过切或不充分切削。）
# 在刀具径补偿中没有发生过切的例子（建议）
在刀具径补偿模式之前开始刀具长度补偿。
：G40G49G00G90X0Y0Z100. ；N1G43G01Z100. F500H2； 刀具长度补偿开始N2G42X10. Y10. D1； 刀具半径补偿开始N3Z0;N4X100. ;N5Y100. ;N6X10. ;N7Y10. ；N8G40X0Y0； 刀具半径补偿取消N9G49Z100. ； 刀具长度补偿取消N10#100=#5023； 用户宏程序
![](images/799825566c405d89638f5899db23c9f42c2cf44a3cae02d2499e867cdee3e27d.jpg)
N1虽然是刀具长度补偿的开始指令，但是由于不是上述“※1”的模式，因而也会预读N2以后的程序段。结果，可以确定正确的刀具径补偿路径。此外，刀具不会在N1、N9的程序段减速后停止。系统不等待N9结束就执行N10的用户宏程序。
# 有关在刀具长度补偿模式中变更了刀具长度补偿量时的动作
使用刀具长度补偿位移类型（参数TOS(No.5006#6)=1、或者参数TOP(No.11400#2)=1）时，可在刀具径补偿等模式中（※1）且刀具长度补偿等（※2）的模式中，通过参数MOF(No.5000#1)来选择变更刀具长度补偿量（※3）时的动作。
参数MOF(No.5000#1)=0；轴移动，其移动量只相当于刀具长度补偿量已被变更的量。参数MOF(No.5000#1)=1：在变更刀具长度补偿量后，指令补偿轴的绝对指令之前，不进行刀具长度补偿量的变更量的移动。
※1符合如下指令。
·组07的G代码为G40以外的情形刀具径补偿(G41/G42)的各模式中的情形
刀具长度补偿(G43/G44)
※3刀具长度补偿量的变更，是指如下情形。
·在程序中指令了H代码（车床系统的扩展刀具选择功能中为D代码）的情形·指令G43/G44，变更了刀具长度补偿的方向的情形·利用参数EVO(No.5001#6)=1，通过偏置画面、G10指令、系统变量、窗口功能等对刀具补偿量进行变更的情形·刀具长度补偿中，恢复由G53、G28、G30、G30.1暂时取消的刀具长度补偿矢量的情形
# 通过H代码变更了刀具长度补偿量时的例子）
对在刀具长度补偿模式中变更了偏置号时的动作进行说明。
G40G49G00G90X0Y0Z100. ；N1G43G01Z100. F500H2； 刀具长度补偿开始N2G42X10. Y10. D1； 刀具径补偿开始N3Z0;N4X100. ；N5Y100. ；N6H3； 刀具长度补偿量（号码）变更N7X10. ；N8Y10. ；N9G91Z- 5. ； 补偿轴的增量指令N10G90Z- 5. ； 补偿轴的绝对指令
N6中，在刀具径补偿(G42)模式和刀具长度补偿(G43)模式的状态下指令刀具长度补偿量的变更(H代码)。此时的动作，通过参数  $\mathrm{MOF(No.5000\#1)}$  的设定，成为如下所示情形。
参数  $\mathrm{MOF(No.5000\#1) = \Omega^{"}0}$  ：在N6的程序段，轴移动，其移动量只相当于刀具长度补偿量已被变更的量。参数  $\mathrm{MOF(No.5000\#1) = \Omega^{"}1}$  ：在N6的程序段中，不执行移动。N9的程序段包含增量指令，所以不进行刀具长度补偿的变化量的移动。刀具只移动由程序所指令的移动量(- 5.000)。N10的程序段包含刀具长度补偿量的变更后最初所指令的补偿轴的绝对指令，所以刀具长度补偿量的变更量，在该程序段中得以反映。
# 运行中改写刀具长度补偿量时的例子）
下面就在参数EVO(No.5001#6)=1下以连续运转方式执行如下程序，在执行N3中变更了刀具补偿量的No.2时的动作进行说明。
：G40G49G00G90X0Y0Z100. ；N1G43G01Z100. F500H2； 刀具长度补偿开始N2G42X10. Y10. D1； 刀具径补偿开始N3Z0； 执行中途变更刀具长度补偿量(No.2)N4X100. ;N5Y100. ;N6X10. ;N7Y10. ；N8G91Z- 5. ； 补偿轴的增量指令N9G90Z- 5. ； 补偿轴的绝对指令：
参数  $\mathrm{MOF(No.5000\#1) = \Omega^{"}0}$  ：N6（在变更刀具补偿量后，最初被缓冲的程序段）中，轴移动，其移动量只相当于刀具长度补偿量已被变更的量。参数  $\mathrm{MOF(No.5000\#1) = \Omega^{"}1}$  ：N6的程序段是在变更刀具补偿量后、最初被缓冲的程序段，该程序段中由于没有补偿轴的指令，执行刀具长度补偿量已被变更的量的移动。N8的程序段中虽然包含有补偿轴的指令，但是由于该指令是一个增量指令而不进行刀具长度补偿量已被变更的量的移动。刀具只移动由程序所指令的移动量(- 5.000)。N9的程序段包含刀具长度补偿量的变更后最初所指令的补偿轴的绝对指令，所以刀具长度补偿量已被变更的量的移动，在该程序段中进行。
1在指定刀具长度补偿（位移类型）后指定增量指令时，刀具长度补偿值不会被反映到机床的移动量上，仅反映于坐标值。绝对指令中，机床的运动、坐标值均被反映于刀具长度补偿值。2可编程镜像有效时，在指定的方向应用刀具长度偏置。3对于刀具长度偏置值，不应用比例缩放倍率。4对于刀具偏置值，不应用坐标旋转。在应用了偏置的轴向，刀具长度偏置有效。5对于刀具长度偏置，还可以应用三维坐标变换。此时，要在多个轴上使刀具长度偏置有效时，请取消每一个轴的刀具长度偏置。6WINDOW指令中，即使在自动运行中改变参数TOS(No.5006#6)、或参数TOP(No.11400#2)，刀具长度偏置的类型也不会变化。7在沿着2个或更多个轴进行刀具长度补偿B后，沿着所有轴的偏置都通过指定G49被取消，如果HO被指定，沿着与指定平面垂直的一个轴的偏置被取消。8当刀具长度补偿值因偏置号改变而改变时，意味着其值改变为新的刀具长度偏置值，新的刀具长度补偿值不被加到旧的刀具长度补偿值上。9当指定了参考点返回(G28、G30)时，定位到参考点时指定的轴的刀具长度偏置将被取消。而没有指定的轴的刀具长度偏置不会被取消。此外，在包含刀具长度偏置取消(G49)的相同程序段中指定了参考点返回时，指定的轴和没有指定的轴均在定位到中间点时，其刀具长度补偿被取消。10机床坐标系指令(G53)中，定位到指令点时所指定的轴的刀具长度偏置将被取消。11通过在刀具长度补偿方式下指定G53、G28、G30而取消的刀具长度补偿矢量按照下列条件被恢复。·刀具长度补偿A和B中，参数EVO(No.5001#6)为1时，补偿矢量在下一个将要进行缓冲处理的程序段恢复。参数为0时，补偿矢量与刀具长度补偿A、B、C一起，在具有H指令或者G43、G44指令的程序段恢复。12使用刀具长度补偿偏移类型时，在刀具径、刀尖半径补偿模式中指令了刀具长度补偿等的开始或取消的情况下，不进行预读。结果，在开始或取消的程序段前后就有可能发生过切或不充分切削，所以应在进入刀具径、刀尖半径补偿的模式之前指令刀具长度补偿的开始和取消，或者在对加工没有影响的场所予以指令。
# 6.2 刀具长度自动测量（G37）
通过指定G37，刀具开始向测量位置移动，中途减速，一直移动到来自测量设备的测量位置到达信号被输出为止。即，当刀尖到达测量位置时，刀具移动停止。刀具到达测量位置时的坐标值与被G37指令的坐标值之间的差异被加到当前使用的刀具长度补偿值上。
![](images/f421350b846b681b0706ed8fd60941377118ad02db108aa3dbbb216dd8a41119.jpg)  
图6.2（a）刀具长度自动补偿
Hxx 指定刀具长度补偿的偏置号G90 G37 IP_；绝对指令G37仅在被指定的程序段中有效。IP_为X_、Y_、Z_的其中之一。
# 工件坐标系的设定
为把刀具移动到测量位置后进行测量，设定工件坐标系。坐标系必须与编程用的工件坐标系相同。
# 指定G37
以绝对值指定测量位置的正确位置。此指令的执行使刀具以快速进给速度向测量位置移动，在减速位置开始减速，直到来自测量仪器的到达信号发出为止，以减速以后的速度移动。当刀尖到达测量位置时，测量仪器向CNC发出一个测量位置到达信号，使刀具停止。
# 改变补偿值
刀具到达的测量位置的坐标值与G37指定的值之间的差异被加到当前刀具长度补偿值上（若是参数  $\mathrm{MDC(No.6210\#6) = 1}$  的情形则减去）。
补偿值  $=$  （当前的补偿值）  $+$  （（刀具到达测量位置时的坐标值）一（G37的指定值））这些补偿值可从MDI进行手动修改为任意值。
通过设定参数  $\mathrm{CCM(No.6210\#7) = 1}$  ，将考虑了现在实际进行补偿的补偿值而得的值作为补偿值来计算。现在实际进行补偿的补偿值根据G08组的模态状态、偏置存储器的内容来判断。
$+$  （现在的补偿值）：G43补偿值  $=$  一（几何补偿值）  $-$  （现在的补偿值）：G44 $\mathrm{G49}$  一（刀具到达测量位置时的坐标值））0
# ·报警
当进行刀具长度自动测量时，刀具的移动如图6.2(b)所示。
刀具通过BC间时，测量位置到达信号变为“1”时发出报警。此外，在刀具通过F点之前，测量位置到达信号没有变为“1”时也会发出报警。任一报警都会发出报警(PS0080)。
![](images/0cad57899c3e213ff45e8f58e18358c461bfa022fd6a802810f96617472b0ce6.jpg)  
图6.2（b）刀具向测量位置移动
在移动过程中以测量速度插入一个基于手动的移动时，在插入以后，务须使刀具回到插入前的位置后重新开始。
1 当H代码在与G37相同的程序段中被指定时，会有报警发出。在G37的程序段前面指定H代码。2 测量速度(FP)、  $\gamma$  、  $\epsilon$  作为参数(FP：No.6241、  $\gamma$  ：No.6251、  $\epsilon$  ：No.6254)，由机床制造商予以设定。设定数据时应满足  $\epsilon$  必须是正数，且  $\gamma >\epsilon$  的条件。3 当刀具补偿存储器A被使用时，改变补偿值。当刀具补偿存储器C被使用时，改变用于H代码的刀具磨损补偿值。4 测量位置到达信号检测的迟延或偏差，除了PMC端外，只有CNC端为  $0\sim 2\mathrm{msec}$  。因此，测量误差为在此2msec上加上PMC端的测量位置到达信号的传递迟延或偏差（也包含接收的迟延或偏差）后，乘以由参数(No.6241)设定的进给速度后的值。5 在检测测量位置到达信号后，使进给停止之前的迟延或偏差为  $0\sim 8\mathrm{msec}$  。要计算越程量，还需要考虑加/减速的迟延、伺服的迟延、PMC端的迟延。
G92 Z760.0 X1100.0； 相对于程序绝对原点的工件坐标系设定G00 G90 X850.0； 移动到X850.0（从测量位置仅移动到沿Z轴的指定距离之位置H01； 偏置号1G37 Z200.0； 移动到测量位置G00 Z204.0； 使刀具沿着Z轴收回一小段距离
如果刀具到达用Z198.0;指定的测量位置，正确的测量位置为  $200\mathrm{mm}$  ，因此必须更改补偿值，更改值为  $198.0-200.0 = -$ $2.0\mathrm{mm}$  。
![](images/de50d0c17ce068cd019eb6d720d539ffbd7ca7839c8f403d627e090a1b53f70a.jpg)
# 6.3 刀具位置偏置（G45～G48）
可以使指定的刀具移动距离仅放大或缩小指定的刀具位置偏置值，或者放大或缩小2倍。刀具位置偏置对于附加轴也有效。
![](images/926eca833918e1df49371f08b04509108c2b0716f599f2db11ba2b24b12606e9.jpg)
| G45 IP_D_; | 仅增大刀具位置偏置值 |
| --- | --- |
| G46 IP_D_; | 仅缩小刀具位置偏置值 |
| G47 IP_D_; | 仅使刀具位置偏置值增大2倍 |
| G48 IP_D_; | 仅使刀具位置偏置值缩小2倍 |
| G45～48; | 用于增大或缩小移动距离的单步G代码 |
| IP_ | 刀具的移动命令 |
| D_ | 刀具位置偏置值的指定代码 |
# ·增大、缩小
如表6.3(a)所示，刀具的移动距离可用指定的刀具位置偏置值来增大或缩小。在绝对指令方式下，移动距离随着刀具从上一程序段的终点位置向含有  $\mathrm{G45\sim G48}$  的程序段所指定的位置移动而增大或缩小。
表6.3（a） 刀具移动距离的增大、缩小  
| G代码 | 刀具位置偏置值为正 | 刀具位置偏置值为负 |
| --- | --- | --- |
| G45 | 起点 | 终点 |
| 终点 |  |  |
| G46 | 起点 | 终点 |
| 终点 |  |  |
| G47 | 起点 | 终点 |
| 终点 |  |  |
| G代码 | 刀具位置偏置值为正 | 刀具位置偏置值为负 |
| --- | --- | --- |
| G48 | 起点 终点 | 起点 终点 |
![](images/dbf742f4b8b161b112e5f54891229afc1999372220ca45b36a07a2ad2b0a8278.jpg)
如果移动距离为0（零）的移动指令在增量指令（G91）模式下被指定，刀具仅移动一段对应于指定刀具偏置值的距离。如果移动距离为0（零）的移动指令在绝对指令（G90）模式下被指定，刀具不移动。
# - 刀具位置偏置值
一旦被D代码选择，刀具位置偏置值保持不变，直到另一个刀具位置偏置值被选择为止。刀具位置偏置值可在如下范围内设定。
D0始终表示刀具位置偏置值为0（零）。
1 针对同时指定  $\mathbf{n}$  (  $\mathbf{n} = 1 \sim 6$  ) 轴的移动，在指定  $\mathrm{G45} \sim \mathrm{G48}$  时，补偿应用于所有  $\mathbf{n}$  轴。当刀具只为锥度加工中的刀具半径或直径补偿时，则会出现过切或不充分切削。因此，在这种情况下，使用 II- 6.4 或 II- 6.6 的刀具径补偿  $(\mathrm{G40} \sim \mathrm{G42})$ 。
![](images/1e98ded8d5eea8a615c1f0fe351b1c1a2935fafa0665ddb07e6168fbd49a88d8.jpg)
2 在 G41 或 G42（刀具径补偿）模式中，不得使用  $\mathrm{G45} \sim \mathrm{G48}$  （刀具位置偏置）。
1 当指定方向因减速而反转过来时，刀具朝着相反方向移动。
![](images/708fc1379d54e9b85d3038f3651321caa5b6443e9fa466e1f54379535c72d729.jpg)
2 针对圆弧插补（G02、G03），通过设定参数，即可以  $\mathrm{G45\sim G48}$  指令补偿出I、J、K指定的1/4和3/4圆。但是，此时假定还没有进行坐标旋转。此功能是为了与常规的不带刀具径补偿功能的CNC程序之间的兼容性而提供的。在编写新的部件程序时，不应使用此功能。
圆弧插补的刀具位置偏置
![](images/d0cb9496a28c5e82f923946d6721725f7eb7ffc7d33fcda61e0e7c6e1c98ce6f.jpg)
3 原则上由D代码来指定刀具位置偏置值。4  $\mathrm{G45\sim G48}$  在固定循环模式中被忽略。在基于  $\mathrm{G45\sim G48}$  的刀具位置偏置进入固定循环模式之前，结束固定循环，在放弃固定循环模式后再取消偏置。
![](images/a82229e55d07b0dea21464780ac939e71f86e0bded5f972a4edb19e833acc608.jpg)
程序
N1 G91 G46 G00 X80.0 Y50.0 D01； N2 G47 G01 X50.0 F120.0； N3 Y40.0; N4 G48 X40.0; N5 Y- 40.0; N6 G45 X30.0; N7 G45 G03 X30.0 Y30.0 J30.0; N8 G45 G01 Y20.0; N9 G46 X0； （在移动量为0下朝着正方向缩小。刀具朝着- X方向移动偏置值的量。） N10 G46 G02 X- 30.0 Y30.0 J30.0; N11 G45 G01 Y0； （在移动量为0下朝着正方向增大。刀具朝着  $+\mathrm{Y}$  方向移动偏置值的量。） N12 G47 X- 120.0; N13 G47 Y- 80.0; N14 G46 G00 X- 80.0 Y- 20.0;
# 6.4 刀具径补偿（G40～G42）的概括说明
可以使刀具仅偏置刀具的半径值地移动。（图6.4(a)）为了使偏置与刀具的半径值一样大，CNC首先创建一个偏置矢量（起刀），其长度等于刀具半径。偏置矢量与刀具的前进方向垂直，从工件朝向刀具中心的方向。如果在起刀后指定直线插补或圆弧插补，则可以使刀具在仅偏置某一偏置矢量后进行加工。最后，为了使刀具返回到起点，取消刀具径补偿。
![](images/0b82f6605abdd9dd32cb70ef79c7d05c48993c9a9bfed145bb80d84a096c5755.jpg)  
图6.4(a) 刀具径补偿 概括说明图
# - 起刀（刀具径补偿开始）
G00（或G01）G41（或G42）IP_D_;G41 : 刀具径补偿左（组07）G42 : 刀具径补偿右（组07）IP_ : 轴移动的指令值D_ : 刀具径补偿值指定代码（1～3位）（D代码）
# - 刀具径补偿取消（偏置模式取消）
| G40 IP_ ; |  |
| --- | --- |
| G40 | ： 刀具径补偿取消（组 07） |
|  | （偏置模式取消） |
| IP_ | ： 轴移动的指令值 |
·偏置平面的选择  
| 偏置平面 | 平面选择指令 | IP_ |
| --- | --- | --- |
| XpYp | G17; | Xp_Yp_ |
| ZpXp | G18; | Xp_Zp_ |
| YpZp | G19; | Yp_Zp_ |
# ·偏置取消模式
一开始当接通CNC的电源时，控制处于偏置取消模式下。在偏置取消模式下，矢量始终是0，刀具中心路径与编程路径一致。
# ·起刀
在偏置取消模式下，当指定了刀具径补偿的指令（G41或G42，以及非D0的D代码指令）时，CNC变为偏置模式。此时的刀具移动叫做起刀。
通过定位（G00）或直线插补（G01）来指定起刀。
起刀时指定圆弧插补(G02、G03)等时，将发生报警(PS0034)”在起刀/退刀段不允许切圆弧”。对于起刀程序段以及其后的程序段，CNC预读参数(No.19625)中所设定的预读程序段数的程序段。
# ·偏置模式
在偏置模式下，补偿由定位（G00）、直线插补（G01）、圆弧插补（G02、G03）来完成。如果在偏置模式中没有3个或更多个具有移动的程序段，刀具可能会过切或者不充分切削。此外，如果在偏置模式下切换偏置平面，则会有报警（PS0037）“G41/G42中无法改变平面”发出，刀具停止移动。
# ·偏置模式取消
在偏置模式下，当满足如下条件之一的程序段被执行时，CNC进入偏置取消模式，此程序段的动作称为偏置取消。
1. G40已被指定。
2. 0（零）已作为刀具径补偿值指定代码（D代码）被指定。
进行偏置取消时，不可为用圆弧指令(G02、G03)。如果在这样的模式下指令，则会发出报警(PS0034)，刀具停止移动。在偏置取消中，读入一个程序段输入指令，包括刀具径补偿缓冲器（无法显示）中的程序段在内，执行两个程序段。同时，若是单程序段模式，在读入一个程序段并执行一个程序段后，再次按下起动按钮，一个程序段被执行，而不读下一个程序段。然后控制进入取消模式，通常只将下次将被执行的程序段储存在缓冲寄存器里。
![](images/e2c554b97cfeb459d9aa736698a2c7491170c35173ffbf9bdaa8fcdd72c2859c.jpg)  
图6.4（b）改变偏置模式
# ·改变刀具径补偿值
·改变刀具径补偿值刀具径补偿值的改变通常在取消模式下换刀时进行。如果刀具径补偿值在偏置模式下改变，要利用指定在相同程序段中的刀具径补偿值计算程序段终点的矢量。
![](images/944c6c2d19318e8e4c3dfab2384a6441cb06adbbceba0173136c976b67051368.jpg)  
图6.4(c) 改变刀具径补偿值
# ·正负刀具径补偿值和刀具中心路径
·正负刀具径补偿值和刀具中心路径如果刀具径补偿值被设为负值（一），就变为与将程序的G41和G42全部互相置换等价的刀具移动。因此，绕过工件外侧的刀具将绕过工件的内侧，反之亦然。
图6.4(d)展示了一个实例。
一般说来，刀具径补偿值应被编程为正值（十）。
当在程序中指定(1)中所示的刀具中心路径，如果刀具径补偿值被设为负值（一），刀具中心如(2)中所示那样移动。如果一开始编写如(2)中所示的程序，将刀具径补偿值被设为负值（一），则刀具中心如(1)中所示那样移动。
因此，在一个相同的程序中允许切削组、阴形状，两者之间的间距可通过适当选择刀具径补偿值来进行任意调整。但是，此时假定起刀和偏置取消是类型A。
（参阅刀具径补偿的开始（起刀））
![](images/e91f38d55ef53b6d1237d85aaea5b6d3a8de65bb359f7fa5c42b40948e8bcdb9.jpg)  
图6.4(d) 基于正负补偿值的刀具中心路径
# ·刀具径补偿值设定
将刀具径补偿值分配给指定在程序中的D代码，并利用MDI面板进行设定。
注释D代码与0对应的刀具径补偿值始终为0。无法设定对应于D0的刀具径补偿值。
# ·补偿值的设定范围
可以作为补偿值设定的值的范围，通过参数OFC、OFA(No.5042#1,#0)设定成为如下所示的任一情形。
补偿值的设定范围（米制输入）  
| OFE | OFD | OFC | OFA | 设定范围 |
| --- | --- | --- | --- | --- |
| 0 | 0 | 0 | 1 | ±9999.99mm |
| 0 | 0 | 0 | 0 | ±9999.999mm |
| 0 | 0 | 1 | 0 | ±9999.9999mm |
| 0 | 1 | 0 | 0 | ±9999.99999mm |
| 1 | 0 | 0 | 0 | ±999.999999mm |
补偿值的设定范围（英制输入）  
| OFE | OFD | OFC | OFA | 设定范围 |
| --- | --- | --- | --- | --- |
| 0 | 0 | 0 | 1 | ±999.999inch |
| 0 | 0 | 0 | 0 | ±999.9999inch |
| 0 | 0 | 1 | 0 | ±999.99999inch |
| 0 | 1 | 0 | 0 | ±999.999999inch |
| 1 | 0 | 0 | 0 | ±99.9999999inch |
与偏置号0相对应的补偿值始终为0。无法给偏置号0设定补偿值。
# ·偏置矢量
偏置矢量是一个二维矢量，它等于D代码分配的刀具径补偿值，它在控制装置内加以计算，它的方向根据每个程序段中刀具的进度不断被更新。偏置矢量通过复位被删除。
# ·刀具径补偿值的指定
利用D代码（地址D后面的  $1\sim 3$  位数），通过指定刀具径补偿值的编号，指定刀具径补偿值。在另一D代码被指定前，D代码一直有效。D代码除了用来指定刀具径补偿的补偿值外，还用来指定刀具位置补偿值。
# ·平面选择和矢量
偏置计算在使用平面选择的G代码G17、G18、G19确定的平面上进行。进行偏置计算的平面称为偏置平面。偏置平面外的轴上的坐标值，不受偏置的影响，编程指令值按原样使用。在同时3轴指令时，刀具以投射在偏置平面上的形状被偏置的方式移动。在偏置取消模式下切换平面。如果在偏置模式中切换平面，则会有报警（PS0037）发出，刀具停止。
![](images/02871e5c63360d394aa954b767559fcb796a5e73da7a216136241e2fe5232030.jpg)
G17 G92 X0 Y0 Z0 ; .以绝对坐标值指定。定位到起点(X0,Y0,Z0)。N1 G90 G00 G41 D07 X250.0 Y350.0 ; .开始刀具径补偿（起刀）。刀具被D07中指定的距离偏置到刀具前进方向的左侧，然后仅偏置刀具径 (偏置模式)。已经事先将D07设为15（刀具径  $= 15\mathrm{mm}$  ）。N2 G01 Y900.0 F150 ; .P1→P2之间的加工N3 X450.0 ; .P2→P3之间的加工N4 G03 X500.0 Y1150.0 R650.0 ; .P3→P4之间的加工N5 G02 X900.0 R- 250.0 ; .P4→P5之间的加工N6 G03 X950.0 Y900.0 R650.0 ; .P5→P6之间的加工N7 G01 X1150.0 ; .P6→P7之间的加工N8 Y550.0 ; .P7→P8之间的加工N9 X700.0 Y650.0 ; .P8→P9之间的加工N10 X250.0 Y550.0 ; .P9→P1之间的加工N11 G00 G40 X0.0 Y0.0 ; .取消偏置模式。返回到起点(X0,Y0,Z0)。
# 6.5 刀尖半径补偿（G40～G42）的概括说明
自动地补偿刀尖的圆度所引起的误差量，就是刀尖半径补偿。
![](images/e490d6df6a719e89e6735995c73d691a95d9b336493a02d472850ed2796d4a56.jpg)  
图6.5（a） 刀尖半径补偿的刀具路径
# 6.5.1 假想刀尖
假想刀尖就是实际上是并不存在的点，如图6.5.1(a)中的A点。由于很难将实际刀尖半径中心对准在起点位置或者参考位置，因此，需要用假想刀尖，而假想刀尖比较容易对准在起点或者参考位置上。将刀具对准出发位置时的位置关系如图6.5.1(a)所示。
![](images/caa0a1bd52c17db6b4481b9cacbd8f6f279e55a5677fa8e2e7bfdfdda8998fcb.jpg)  
图6.5.1（a） 刀尖半径中心和假想刀尖
注意在具有参考点的机床上，标准位置（如刀具转台的中心）可以对准在起点位置上。从该标准位置到刀尖半径中心或假想刀尖的距离，通过刀具长度补偿进行补偿。在将标准位置到刀尖半径中心的距离作为补偿值设定时，等于将刀尖半径中心对准在起点上。另外，在将标准位置到假想刀尖的距离作为补偿值设定时，等于将假想刀尖放在起点上。为了设置补偿值，测量从标准位置到假想刀尖的距离比测量标准位置到刀尖半径中心的距离更容易。
![](images/3f3aa6fd647fe55f518f50d89bfe9bdabe09bf7860c1cb4fb5de05e6dea3187a.jpg)  
图6.5.1（b）将转台中心对准在起点时的刀具长度补偿
![](images/1f7553e11b55cb32cf2d77fcd71004e900ae43192b6c3bb368480e3a15acfb82.jpg)  
图6.5.1（c）将刀尖半径中心对准在起点进行加工时的刀具路径
![](images/9cad078a44fe38abba9757e40cde4226a34310cae0b9f263ef9818d7f2444298.jpg)  
图6.5.1（d）将假想刀尖对准在起点进行加工时的刀具路径
# 6.5.2 假想刀尖的方向
从刀尖半径中心看到的假想刀尖的方向，由切削过程中刀具的朝向决定，因此必须和补偿值一样事先设定。假想刀尖的方向可由下列8种中加以选择。与8种假想刀尖的方向对应的代码（编号）如图6.5.2(a)所示。图6.5.2(a)表示刀具与起点之间的位置关系。箭头的顶端表示假想刀尖。
![](images/2d43031a0a96f762ac7fb45f5f860070651cec5ff408e1309794df33ee66594e.jpg)  
图6.5.2(a) 假想刀尖的方向
当刀尖半径中心与起点对准在一起时，使用0号及9号假想刀尖。将此假想刀尖号设定在与偏置号对应的偏置存储器的OFT中。
![](images/b01b6d4223b047659a0bbf3aec53813864969fa35459018e3a94a7350d489a76.jpg)
# 6.5.3 偏置号与补偿值
解释
- 偏置号与补偿值
![](images/3a6cc33cfd2d0f1acc96fc372943edcce4ea332a147f1a3a7026d9ce28cf3337.jpg)
表6.5.3（a） 偏置号和补偿值（例）  
| 偏置号
最多999组 | (刀具补偿值) | (假想刀尖方向) |
| --- | --- | --- |
| 001 | 0.200 | 1 |
| 002 | 0.250 | 2 |
| 003 | 0.120 | 6 |
| 004 | : | : |
| 005 | : | : |
| : | : | : |
# -偏置值的指令
用D代码指定偏置号。
# -补偿值的设定范围
可以作为补偿值设定的值的范围，通过参数OFC、OFA(No.5042 #1,#0)设定成为如下所示的任一情形。
表6.5.3（b） 补偿值的设定范围（米制输入）  
表6.5.3（c）补偿值的设定范围（英制输入）  
| OFE | OFD | OFC | OFA | 设定范围 |
| --- | --- | --- | --- | --- |
| 0 | 0 | 0 | 1 | ±999.999in.ch |
| 0 | 0 | 0 | 0 | ±999.9999in.ch |
| 0 | 0 | 1 | 0 | ±999.99999in.ch |
| 0 | 1 | 0 | 0 | ±999.999999in.ch |
| 1 | 0 | 0 | 0 | ±99.9999999in.ch |
# 6.5.4 工件位置与移动指令
要进行刀尖半径补偿，必须指定编程路径的哪一边是工件位置。
| G代码 | 工件位置 | 刀具路径 |
| --- | --- | --- |
| G40 | 哪边都可以 | 在编程路径上移动 |
| G41 | 前进方向右侧 | 在编程路径的前进方向左侧移动 |
| G42 | 前进方向左侧 | 在编程路径的前进方向右侧移动 |
刀具在没有工件一侧被偏置。
![](images/9a46bc9d089c022527724bbb33afb1beabd22185f67e614cfa0aa6a360ba34b2.jpg)  
图6.5.4(a) 指定工件位置
通过设定坐标系，可使工件位置颠倒过来。
![](images/3b50610843fc18bf466ac6cde2b9a474b721f8e2e9e3952a2363b669f0ba3654.jpg)  
图6.5.4（b）工件位置颠倒的情形
G40、G41、G42是模态G代码。
在G41或G42模式下，在重新指定了G41或G42的G代码的程序段中，刀尖半径中心侧定位在与上一个程序段垂直的位置。
尚未指定G41/G42的G代码的在G41和G42模式下的程序段，可分别表达为（G41）或（G42）。
若将补偿值的正负颠倒过来，刀尖半径补偿的偏置矢量就会颠倒过来，但是假想刀尖的方向不变。因此，若在不将假想刀尖对准于起点下使用，请勿将相对于假设程序的补偿值的正负颠倒过来。
# 工件位置不变时的刀具移动
当刀具移动时，刀尖半径与工件保持接触。
![](images/305cd022216dea48ffb785cca03b76b235d4639d11fc07cb7a4fc95218fb4c87.jpg)  
图6.5.4（c）工件位置不变时的刀具移动
# 工件位置发生变化时的刀具移动
在工件位置发生变化的程序段的连接点接触于两工件。
![](images/dee40e9d202288db1ad5dc15b4d5e19f6fcffb77e60c99289b35b2642e03b2d2.jpg)  
图6.5.4（d）工件位置发生变化时的刀具移动
虽然在  $\mathrm{A}\to \mathrm{B}$  的右侧实际上并不存在工件，但是CNC假设工件存在于右侧。不得在与起刀程序段相邻的下一程序段中改变工件位置。在图6.5.4(d)中，  $\mathrm{A}\to \mathrm{B}$  在起刀时不会变为图中所示的情形。
# 起刀
模式由G40变为G41或G42的程序段称为起刀程序段。
G40_；
G41_；（起刀程序段）
在起刀程序段中，刀具在被偏置后进行过渡性移动。在起刀程序段后面的程序段的起点，刀尖中心定位在与该程序段垂直的位置。
![](images/5525e45a57da22d108a3c4caa0d217493c3b76aa65b1920128798dd6fd6dce5b.jpg)  
图6.5.4（e）起刀
# 偏置取消
在G41或G42模式下指定G40时，该程序段称为偏置取消程序段。
G41_; G40- ;（偏置取消程序段）
在偏置取消程序段前面的一个程序段中，刀尖半径中心定位在其终点的与该程序段垂直的位置。在G40的程序段中，刀具移动到终点。
![](images/5e02108a759ce81fe5d4d7d72ff13ee82712a303fde52a884c8df2014ed8c32a.jpg)  
图6.5.4（f）偏置取消
通常，在偏置取消模式换刀时改变补偿值。但是，在偏置模式中改变补偿值时，程序段的终点处的矢量采用在相同程序段所指定的补偿值进行计算。此外，假想刀尖方向、刀具位置补偿值的改变也相同。
![](images/2b38d7193dbba1fc37ad40c907e641034d0307d8f6c4998702dfded3619f6b93.jpg)  
图6.5.4（g）改变补偿值
# 在G41/G42模式下指定G41/G42
在G41/G42模式下，重新指定了G41或G42的G代码的程序段中，刀尖半径中心则定位在与上一个程序段垂直的位置。
![](images/1f2a6cf9ab34f803a70545c432318db9580dbdb7f86e5a0fc52f86a11823ac53.jpg)  
图6.5.4（h）在G41/G42模式下指定G41/G42
在由G40模式改变为G41/G42模式的最初的程序段中，不进行上述刀尖中心定位。
- 由与 G40（偏置取消）相同程序段指定的移动指令的方向与工件形状的方向不同时的刀具移动在如图 6.5.4(i)所示的工件形状下，当您想在最初的程序段切削终点在 X,Z 方向上取消刀尖半径补偿后退刀时，应指定：G40 X_Z_I_K_; 其中，I、K 为下一程序段的工件形状的方向，以增量来指定。
![](images/10b36e39400be34d01bced502bf3c3f18a0444ae2664f37d15ae296a443e28ff.jpg)  
图6.5.4(i) 在与 G40 相同的程序段指定 I 和 K 时
由此，如图 6.5.4(j)所示，可以防止过切。
![](images/abaa929b667ce16a98d60d3ab0b1d8d2ebd13ff6cfdc744e9b626edadff16f04.jpg)  
图6.5.4(j) 在与 G40 相同程序段发生过切现象时
由 L_K_所指定的工件形状的工件位置，处在与其之前的程序段相同一侧。请在与 G40 相同的程序段指定 L_K_;。若在与 G02 或 G03 相同的程序段指定，则视为圆弧的中心。
| G40 X_Z_I_K_; | 刀尖半径补偿 |
| --- | --- |
| G02 X_Z_I_K_; | 圆弧 |
在偏置取消模式中，如果与 G40 同时指定 L_K_，则 L_K_被忽略。另外，I 和 K 通常以半径编程方式指定。G40 G01 X_Z_; G40 G01 X_Z_I_K_; 偏置取消模式。（I、K 被忽略）
![](images/e22be3ec60633c38cf0fbeb2720185acb4253ae75b073e014cb848f50e6ef9b7.jpg)
(G40 模式)(1) G42 G00 X60.0 ;(2) G01 X120.0 Z - 150.0 F10 ;(3) G40 G00 X300.0 Z0 I40.0 K - 30.0 ;
# 6.5.5 关于刀尖半径补偿的注意事项
# - 在偏置模式下指定的没有移动的程序段
(1) M05 ; M 代码输出(2) S210 ; S 代码输出(3) G04 X10.0 ; 暂停(4) G22 X100000 ; 设定加工范围(5) G91 G01 X0 ; 移动量为 0(6) G90 ; 仅限于 G 代码(7) G10 L11 P01 R10.0 ; 改写偏置在从 N-2 程序段（N 为偏置模式中的读入程序段数（参数(No.19625)）连续多个指定这样的程序段时，在上一程序段的终点，刀具来到与该程序段垂直的位置。但是，移动量为 0 时（(5)），即使只需指定一个程序段也会变为如此情形。
![](images/286c88ebfb51fb1083819f910fdaf5e04febd31437904927c6f196d33e8907ad.jpg)  
图6.5.5 (a)
因此，如图 6.5.5(a) 所示，有时会产生过切。
# 倒角时的刀尖半径补偿
补偿后的移动如图6.5.5(b)所示
![](images/1c613bc08ce009cf10fb85e06545db3b7da4056737237e13c982a58f17942d7d.jpg)  
图6.5.5 (b)
# 倒圆时的刀尖半径补偿
补偿后的移动如图6.5.5(c)所示
![](images/105893ef67761ae9bc4122cb83cf45bbbddebb145e15eca1a5b993f3d019dee9.jpg)  
图6.5.5 (c)
# 6.6 刀具径补偿或刀尖半径补偿的详细说明
# 6.6.1 概述
下面主要就刀具径补偿进行说明，但是这里的说明可以应用于刀尖半径补偿中。
# 内边和外边
利用工件来测量程序的两个程序段的移动指令的夹角，当超过180度时，称为“内边”，在0度和180度之间称为“外边”。
![](images/71a435806ddfae2696d4326a3ca8dfce2a6c31030a8928cdfb8915c5166f935d.jpg)
# ·外边拐角的连接方式
在刀具径补偿模式下旋转外边拐角时，可以通过参数CCC(No.19607#2)，选择用直线插补还是用圆弧插补来连接多个补偿矢量。
# (1)直线连接类型[参数  $\mathbf{CCC} = \mathbf{0}]$
# (2)圆弧连接类型[参数  $\mathbf{CCC} = \mathbf{1}]$
![](images/892d92689970113701f2ef56aaef984e895fbbd9be7247aeeef9c1ea1d65e17b.jpg)
用圆弧插补来连接多个矢量
![](images/2d4b6ba5dc4e622ce698af120ac095016b84c5d0db071e8118b695cd9a2bb04d.jpg)
# ·取消模式
在下列任一条件下，刀具径补偿作为取消模式。（根据机床制造商的规格，在某些情况下不会变为取消模式）
(1）刚刚通电后(2）按下了MDI单元上的RESET(复位)按钮后(3）通过执行M02或M30结束程序后(4）执行完刀具径补偿取消指令(G40)后
在取消模式下，补偿矢量的大小始终为0，刀具径中心路径与编程路径一致。程序的最后必须在取消模式下结束。如果在刀具径补偿模式下结束，就无法定位在终点而在离开补偿矢量值的位置结束程序。
刀具径补偿中执行复位操作时的动作，根据参数CLR(No.3402#6)设定而不同。
参数CLR(No.3402#6)：0时
为复位状态。组07的模态保持G41/G42，要进行刀具径补偿，需要重新指令偏置号（D代码）。
参数CLR(No.3402#6)：1时为清除状态。组07的模态为G40，要再次进行刀具径补偿，需要执行G41/G42和偏置号（D代码）的指令。
在取消模式下执行满足所有下列条件的程序段时，CNC进入刀具径补偿模式。此时的动作叫做起刀。
(1）指定了G41或G42。或者已进行指定并已处在G41或G42模式。
(2)  $0<$  刀具径补偿的补偿号  $\equiv$  最大补偿号。
(3）处在定位(G00)或者直线插补(G01)模式。
(4）指定了移动量非0的补偿平面内的轴。（但起刀类型C除外）
在圆弧插补(G02、G03)模式下指定起刀时，将会发生报警(PS0034)“在G00/G01以外执行起刀/取消”。
无法在起刀程序段中指令工件坐标系的切换  $(\mathrm{G54}\sim \mathrm{G59})$  0
起刀的动作可以通过参数  $\mathrm{SUP(No.5003\#0)}$  以及参数SUV(No.5003#1)的设定，从下面所示的类型A、类型B、类型C中予以选择。但是，绕内边时的动作，没有基于类型的差异。
表6.6.1（a）起刀/取消的动作  
| SUV | SUP | 类型 | 动作 |
| --- | --- | --- | --- |
| 0 | 0 | 类型 A | 在起刀的下一个程序段/取消的上一个程序段输出垂直补偿矢量。 |
| G41 刀具中心路径 编程路径 |  |  |  |
| 0 | 1 | 类型 B | 输出与起刀的程序段/取消的程序段垂直的补偿矢量、以及交点矢量。 |
| 交点 编程路径 |  |  |  |
| 1 | 0 | 类型 C | 起刀的程序段/取消的程序段为没有移动的程序段时，刀具沿着与起刀的下一个程序段/取消的上一个程序段垂直的方向移动相当于刀具径/刀尖半径补偿值的量。 |
| 1 | 交点 编程路径 |  |  |
| G41 N1 |  |  |  |
| 若是有移动的程序段，则根据SUP的设定，0时变为类型A，1时变为类型B。 |  |  |  |
# ·读入刀具径补偿模式中的输入指令
在刀具径补偿模式下，在接收到取消指令之前，不管是否存在具有移动的程序段，通常读入3个程序段，还可以通过参数(No.19625)设定，最多读入8个程序段的输入指令，并进行交点计算和稍后将要描述的干涉检查。要进行交点计算，最起码必须读入2个或更多个具有移动的程序段。此外，要进行干涉检查，最起码必须读入3个或多个具有移动的程序段。
如参数(No.19625)中设定的那样，读入程序段数越多，越可以对更多的过切（干涉）指令进行预测。但是，由于读入后进行分析的程序段数增多，读入和分析操作需要较长时间。
# 结束刀具径补偿（取消）
在刀具径补偿模式下，只要执行满足下列条件中一个条件的程序段，刀具径补偿即被取消。
(1）指定了G40
(2）指定D00作为刀具径补偿的补偿号执行刀具径补偿取消时，不可为圆弧指令（G02、G03）。如果以圆弧指定，就会有报警发出。取消的动作如同起刀一样，可以通过参数SUP(No.5003#0)以及参数SUV(No.5003#1)的设定，从下面所示的类型A、类型B、类型C中予以选择。但是，场内边时的动作，没有基于类型的差异。
# 参数SBK(No.5000#0)
通过将参数SBK(No.5000#0)设定为1，就可以在为进行刀具径补偿而在内部创建的程序段中执行单程序段停止。用于包含刀具径补偿的程序的检查。
![](images/9c88e9806bf7461accd801c197801f8dd3f3e4c02b589de1952b51f9d6ede090.jpg)
在图的N1程序段中指令辅助功能（M代码）/主轴功能（S代码）/刀具功能（T代码）/第2辅助功能（B代码）时，在内部创建的程序段的停止点（单程序段停止点以外）停止时，不会受理FIN。
# 图中的符号
下面说明在以后描述的图中出现的符号含义。
- S表示执行单程序段1次的位置。- SS表示执行单程序段2次的位置。- SSS表示执行单程序段3次的位置。- L表示刀具沿直线移动。- C表示刀具沿圆弧移动。- r表示刀具径补偿值或刀尖半径补偿值。- 交点表示在程编程路径偏置r后形成形状时，2个程序段经偏置后的形状的交点。- ○表示刀具的中心。
# 6.6.2 起刀时的刀具移动
下面说明从偏置取消模式到进入偏置模式时的刀具移动（起刀）。
- 刀具绕内边移动时（ $180^{\circ}$  ）
![](images/0a67ea314c88e90faa5a8a498c06c8037aa7c7e01a0ccf825e5c54f7244b1ae4.jpg)
- 在起刀具有移动的程序段中，刀具绕钝角外边移动时（ $90^{\circ} \leq \alpha < 180^{\circ}$ ）刀具路径有两类，即A和B；它们由参数SUP（No.5003#0）选择。
![](images/35b609b1fb813ab0c146df3a051c0f25529fda3995c233b363bae2f3608d38ab.jpg)
![](images/533b7480236bb9e8a345af4273cdce7940f7a88213f841f028fe9a19312fa7d2.jpg)
# ·在具有移动的程序段中，刀具绕锐角外边移动时（  $\alpha < 90^{\circ}$  ）
刀具路径有两类，即A和B；它们由参数SUP（No.5003#0）选择。
| 类型A | 直线→直线 | 起点 |
| --- | --- | --- |
| G42 | L | 工件 |
| r | S | 编程路径 |
| S | L | 刀具中心路径 |
| 直线→圆弧 | G42 | 起点 |
| r | S | 刀具中心路径 |
| 类型B | 直线→直线 (直线连接类型) | L |
| r | G42 | 工件 |
| S | L | 编程路径 |
| 直线→圆弧 (直线连接类型) | L | 起点 |
| r | G42 | 工件 |
| S | L | 刀具中心路径 |
| 直线→圆弧 (直线连接类型) | L | 起点 |
| r | G42 | 工件 |
| S | L | 编程路径 |
![](images/fdbf3b13e034d7886927e720da5a82a89711e5f005de46a2d2655f14c37011bd.jpg)
·刀具绕小于  $1^{\circ}$  的锐角外边作直线  $\twoheadrightarrow$  直线移动时（  $\alpha < 1^{\circ}$  ）
![](images/9b3c544cebea5ebce20dd4993186264e96e87a97188c069330db373b0c94062e.jpg)
# ·不含起刀时指定刀具移动的程序段
类型A、类型B的情形起刀时指定了没有移动的程序段时，则不创建偏置矢量。因此，刀具不会在起刀的程序段动作。
![](images/a1b6bf2be4c32a3414ed5db9b9a5fa9f35c1f81ae0d26b62aed2fdce5022e202.jpg)
类型C的情形
刀具沿着起刀后面与具有移动的程序段垂直的方向，位移补偿值的量。
![](images/f8d8fb8f2837fc5daf5468a620746651788c42e1aa325f47dd939722c2683b61.jpg)
# 6.6.3 偏置模式下的刀具移动
在偏置模式下，直线插补、圆弧插补自不待言，即使对于定位指令也同样进行补偿。要进行交点计算，最起码必须读入2个或更多个具有移动的程序段。因此，在偏置模式下，通过连续指定辅助功能单独指令、暂停等不伴随移动的程序段，在无法读出具有移动的2个或更多个程序段时，就难以进行交点计算，在某些情况下会导致过切或不充分切削。假设由参数(No.19625)确定的偏置模式中的读入程序段数为N，已读入的N程序段中不伴随移动的程序段的指令数为M，则可以进行交点计算的条件就成为  $(\mathrm{N} + 2)\equiv \mathrm{M}$  。譬如，偏置模式中的最大读入程序段数为5时，即使指定3个没有移动的程序段，也照样可以进行交点计算。
注释后文描述的用于干涉检查的必要条件与此有所不同。详情请参阅干涉检查项。
此外，在指定抑制缓冲的G代码或M代码时，不可在执行该程序段之前读入后续的指令，这与参数(No.19625)的设定无关。这样会造成无法进行交点计算，从而在某些情况下导致过切或者不充分切削，应予注意。
# - 刀具绕内边移动时（ $180^{\circ} \leq \alpha$ ）
![](images/03df7d41fe6f2f012e97d52fd2ce4900675afbfaa7b7b7b510da30e8d04623f5.jpg)
·刀具绕小于  $1^{\circ}$  的内边移动，偏置矢量异常大时的直线  $\twoheadrightarrow$  直线
![](images/edc5539bc96e8a27d916f94b7ad81611107be9af325737a770ca56409541e18b.jpg)
有关圆弧  $\twoheadrightarrow$  直线、直线  $\twoheadrightarrow$  圆弧、圆弧  $\twoheadrightarrow$  圆弧的情形可由此类推。
- 刀具绕钝角外边移动时（ $90^{\circ} \leq \alpha < 180^{\circ}$ ）
![](images/b803cc43457f808d3531a138e9b9d53a35d7fb7dee050cb796a2fc838090f5f4.jpg)
![](images/edc681483d21d968cf56eaf99e7d751e82177c8c849c3b6d7e3bd3950ba91edb.jpg)
# - 刀具绕锐角外边移动时（ $\alpha < 90^{\circ}$ ）
![](images/65c8eba1ee34197f99c741958c879b0b11beab7490a29c348540aa044fda290b.jpg)
![](images/4f0b175fdcb984121282085fb6c4ca99d69f4da1b68959c71ae0562072d672ea.jpg)
# - 例外情况
# 圆弧的终点不在圆弧上时
圆弧的终点不在圆弧上时，系统则假设：刀具径补偿是相对于一个假想圆进行，该假想圆通过圆弧终点，圆弧中心为中心，根据这种假设，系统创建一个矢量，并进行补偿。“圆弧  $\twoheadrightarrow$  圆弧”的情况也相同。
![](images/e7b20b7ce633406be86cd2a6baf416d0842d7e2765c83a181e02c0c0c5073a85.jpg)
# 不存在内边的交点时
不存在内边的交点时如果刀具径补偿值或刀尖半径补偿值足够小，即使在偏置路径上存在圆弧的交点P，当刀具径补偿值或刀尖半径补偿值增大时，交点P不存在。此时，在上一程序段的终点，会有报警(PS0033）“G41/G42 无交点”发出，刀具停止。譬如，当刀具径补偿值或刀尖半径补偿值足够小时，即使沿圆弧A和圆弧B的已被偏置的路径在交点P点相交，但如果刀具径补偿值或刀尖半径补偿值增大，该交点就不会形成。
![](images/6d4b8f85a0598436a91197dbc4433d9d79c6bde4366bd974c7c1012537e34c9e.jpg)
# ·圆弧的中心与起点或终点重合
如果圆弧的中心与起点或终点重合，将会发生报警（PS0041）“G41/G42中发生过切”，刀具将停在上一个程序段的起点位置。
![](images/669c770aebf3f8ff29283a7ddcd8913b6ff186a4777de4f011ed5576186ab6c8.jpg)
# ·偏置模式下改变偏置方向
偏置方向根据刀具径补偿或刀尖半径补偿的G代码（G41、G42）和刀具径补偿值或刀尖半径补偿值的符号，按照如下方式决定。
| 刀具径补偿或刀尖半径补偿值的符号 | + | - |
| --- | --- | --- |
| G代码 |  |  |
| G41 | 左侧偏置 | 右侧偏置 |
| G42 | 右侧偏置 | 左侧偏置 |
在偏置模式下，可改变偏置方向。
如果偏置方向在一个程序段中改变，则在该程序段的刀具中心路径和上一程序段的刀具中心路径交点处产生一个矢量。但是，在起刀的程序段和它后面的程序段中，无法改变偏置方向。
# 具有交点的偏置路径
![](images/f4fa56d13a99e4fc0f3a856802400e73dc4ceb575d4cf2492cf3949a60ad41f5.jpg)
# ·没有交点的偏置路径
当用G41、G42将偏置方向由A程序段改变为B程序段时，如果没有交点，则创建一个与B程序段的起点垂直的矢量。
![](images/23453fdb20268b4e33e3593a910cc211b6b79c299028b10a55f971411191b08b.jpg)
# ·大于1周的圆弧
通常的交点几乎不可能产生这种情况，然而，当通过其切换G41、G42而改变方向时，或当用后面将要描述的地址I、J、K指定一个G40时，就有可能出现这种情况。
不用大于一周的圆弧来进行刀具径补偿：从P1至P2构成一个圆弧。根据情况，报警会因下文描述的“干涉检查”而显示。要执行一个以上的圆周，该弧线必须分段指定。
![](images/695435728cfba0ab4fabaad2462a7d2dea8e8d344f6db577f4e6ca62b9738ed5.jpg)
# ·偏置模式下的刀具径补偿G代码指令
通过独立指定偏置模式下的刀具径补偿G代码（G41、G42），可使偏置矢量与上一程序段中的移动方向形成直角，不管是加工内边还是加工外边。
如果该代码是用圆弧指令指定的，则不会得到正确的圆弧
当希望通过刀具径补偿G代码（G41、G42）指定来改变偏置方向时，请参阅本项的“偏置模式下改变偏置方向”。
![](images/22455d4fc93e854b4660980f9e8b8a30ed20bee0d6a294020cc6f40cfb0bd093.jpg)
# ·暂时取消矢量的指令
·暂时取消矢量的指令在使用偏置模式期间，如果指定G92（工件坐标系设定）或G52（局部坐标系设定），则偏置矢量暂时被取消，然后自动恢复到偏置模式。在这种情况下，无偏置取消移动，刀具直接从交点矢量移动到没有矢量的点，即程序指定的点。当恢复到偏置模式时，刀具直接移动到交点。
![](images/90aab55651ceb9104e1926f3d9939ae6864c78eaa8e5ae5b1743d3c915df4a7a.jpg)
指定G28（参考点返回）、G29（从参考点返回）、G30（第2、第3、第4参考点返回）、G53（机床坐标系选择）之前，请通过G40取消偏置模式。在偏置模式下指定上述指令时，偏置矢量暂时消失。
# ·在G00/G01模式的程序段中指定了I、J、K时
在开始刀具径补偿时或处在该模式下，通过在定位模式(G00)或直线插补模式(G01)的程序段中指定I、J、K，即可使该程序段终点位置的补偿矢量与由I、J、K所指定的方向垂直。由此，就可以有意识地改变补偿方向。
# IJ型矢量（XY平面）
IJ型矢量（XY平面）下面就补偿平面在XY平面（G17模式）下创建的补偿矢量（IJ型矢量）进行说明。（有关G18平面的KI型矢量、G19平面的JK型矢量也可以此类推。）IJ型矢量对编程路径不进行交点计算，而是将垂直于由I和J所指定方向的相当于补偿值的矢量作为补偿矢量。I和J，既可以在开始刀具径补偿时指定，也可以在该模式下指定。在开始补偿时进行指定的情况下，参数中所设定的起刀类型不管属于哪种类型都无效，而假设其为IJ型矢量。
# 偏置矢量的方向
偏置矢量的方向处在G41模式时，将由I、J、K所指定方向假设为假想的刀具前进方向，而在与其垂直的左侧创建一个偏置矢量。
![](images/b8cdd3aa532272bccbb2b668104d179e26dea64435427ebda196cc7284618731.jpg)
处在 G42 模式时，将由 I、J、K 所指定方向假设为假想的刀具前进方向，而在与其垂直的右侧创建一个偏置矢量。
![](images/8f9bb9b8878ba63f7f51cc546f36677b689cfa92049acce9a9d1f3555630dcfa.jpg)
![](images/1af6f91596a95fd36605b02b1e7f38384e1fe38501a6f947ba2141cf9c1d4070.jpg)
![](images/89af0d0d1307b112545a7a41fb55a04ed8106007618270dd2679d2bc5fa033e9.jpg)
![](images/ecf47093516821a34e17a8541fbd5e34a578dad60c637587690c21712bf8a7ec.jpg)
![](images/80d72267c1e09e9fc5a14cf33674adc8931e9108ae998089b7713d1e3eb5ff6d.jpg)
指定IJ型矢量时，根据方向，在某些情况下可能会在该矢量发生刀具干涉。在这种情况下，系统不会发出干涉报警，也不会执行避开干涉的操作。因此，有时会产生过切。
![](images/d4c808b6ba442d383a2f1013926e7e7b573be81cccdd25ed4c020d61aeb0abce.jpg)
# ·没有移动的程序段
下列程序段叫做没有移动的程序段，在这些程序段中，刀具不会因为偏置而移动。
| M05; | : M 代码输出 |
| --- | --- |
| S21; | : S 代码输出 |
| G04 X10.0; | : 暂停 |
| G22 X100000; | : 加工范围设定 |
| G10 L11 P01 R10.0; | : 刀具径补偿值的设定/更改 |
| (G17) Z200.0; | : 偏置平面外的移动 |
| G90 ;, O10 ;, N20 ; | : 仅限 G、O、N 代码的指令 |
| G91 X0.0; | : 移动量为 0 的轴指令 |
# ·在偏置模式下指定的没有移动的程序段
只要没有在偏置模式下连续指定比N- 2程序段（N为偏置模式下的读入程序段数（参数(No.19625)）更多的没有移动的程序段，矢量和刀具中心路径都会按照通常模式设定，在单程序段停止点执行该程序段。
![](images/5feab0cbf4bcfe72d303ffe540d8b338625d2214dcd2c2c144ceb62e6f52996f.jpg)
不得在偏置模式中比N- 2程序段（N为在偏置模式中的读入程序段数（参数(No.19625)））多地连续指定没有移动的程序段。如果指定这样的程序段，在上一程序段中创建一个长度等于偏置值的矢量，其方向与刀具移动方向垂直。需要注意的是，当进行这样的指定时，会造成过切。
![](images/08e32d26cd7b4b1f2fef2dd7ce90327f7d1f9da7a46427a3d6e421f6481af54e.jpg)
# ·指定了抑制缓冲的M代码/G代码时
在偏置模式中指定了抑制缓冲的M代码/G代码时，不管参数(No.19625)中确定的偏置模式中的读入程序段数是多少，无法再读入其后的程序段并进行分析。因此，无法再进行交点计算和后文描述的干涉检查。此时，由于向紧之前的程序段输出垂直矢量，在某些情况下会产生过切。
![](images/ad1a168a24bcd35b749e5b9461a994601e293e1c87859146861df9366cedaf5e.jpg)
# - 偏置模式中的工件坐标系指令或局部坐标系指令
指令局部坐标系(G52)或者工件坐标系(G92)时，在进行刀具径补偿(G41/G42)中时，将G52、G92指定为抑制缓冲的G代码。在执行G52、G92的程序段之前，不执行其以后的程序段。
# - 拐角移动
在一个程序段的终点创建2个或更多个偏置矢量时，刀具则线性地从一个矢量移动到另一个矢量。这种移动称为拐角移动。
矢量几乎一致时（根据参数(No.5010)的设定，该矢量间的拐角移动的距离被判定为较短时），不执行拐角移动。此时，至单程序段停止点的矢量优先留下，除此之外的矢量被忽略。由此，可以忽略通过进行刀具径补偿而产生的微小的移动，防止由于缓冲的中断而引起的速度变化。
![](images/82ffced9b0e8100192211d36c0e6b77ca04f82314d56252e515a13062c1fac63.jpg)
当没有判定矢量几乎一致（也即没有被擦除）时，执行绕过拐角的移动。单程序段停止点之前的拐角移动属于上一个程序段，单程序段停止点之后的拐角移动属于下一个程序段。
![](images/00a2dce742c3a6900ec206bbaffd29135baeff1ed349deb11f982b92b71058ab.jpg)
但是，如果下一程序段的路径是半圆以上的圆弧，矢量就不会被忽略。这主要是为了预防出现下列情况。
![](images/a3862ca4252dfa5c16b063dff9f33fa7ec95d13a89264477360251b9085f1227.jpg)
如果不忽略该矢量，刀具路径为  $\mathrm{P1}\rightarrow \mathrm{P2}\rightarrow \mathrm{P3}\rightarrow$  （一周圆弧）  $\rightarrow \mathrm{P4}\rightarrow \mathrm{P5}\rightarrow \mathrm{P6}$  ，而如果P2和P3之间的距离可忽略不计，P3被忽略，刀具路径为  $\mathrm{P2}\rightarrow \mathrm{P4}$  ，不到一周。
# - 手动运行的干预
有关在偏置模式下进行手动干预的情形，请参阅操作说明书（车床系统／加工中心通用）（B- 64484CM）“手动绝对开关的ON/OFF”。
·在具有移动的取消程序段中，刀具绕内边移动时（  $180^{\circ} \cong \alpha$  ）
![](images/5ff0089667cd7ad6872c059adf0ed6062eceb020f1cb5f4ca832e965809588d8.jpg)
- 在具有移动的取消程序段中，刀具绕钝角外边移动时（ $90^{\circ} \leq \alpha < 180^{\circ}$ ）起刀时的刀具路径有两类，即A和B；它们由参数SUP（No.5003#0）选择。
![](images/2c731761873ec5ae1e06f199b4e3667bd1612be81b7ae50e15068ebde3c83630.jpg)
![](images/471eef7e3354d9002cbf512e200db086190b6a37142f7f0cdf94d5f878ddbc11.jpg)
- 在具有移动的取消程序段中，刀具绕锐角外边移动时（ $\alpha < 90^{\circ}$ ）起刀时的刀具路径有两类，即A和B；它们由参数SUP（No.5003#0）选择。
![](images/a8af0e51d18201dc50924c51b55bf37fbdd1730f32e2371efa64b4b2813dc9f6.jpg)
![](images/6b3ac92c6cbb1d0d87a764a49426ded41708a8f66b315f079630fb3275aff049.jpg)
·在具有移动的取消程序段中，刀具绕小于等于  $1^{\circ}$  的锐角外边作直线  $\twoheadrightarrow$  直线移动时（  $\alpha \leq 1^{\circ}$  ）
![](images/84fb038cb9456b76cafd813af41bc5796ba38b90dd9642e42176e110b1baf80b.jpg)
# - 与偏置取消同时被指定的没有移动的程序段
类型A、类型B的情形
在取消程序段之前的程序段中，在垂直方向创建一个其值等于刀具径补偿或刀尖半径补偿值的矢量。刀具不会在取消程序段中动作。其余的矢量在下一个移动指令中被取消。
![](images/b03c50cf5b443deac6cfbe5faf3ca241a950e4b6643642bca502c523489fa84c.jpg)
刀具沿着与取消程序段之前的程序段垂直的方向，位移补偿值的量。
![](images/f0e9add1d98ceea94a26454fb9025b2d330dbcb747dc59ea34968402b8553314.jpg)
# G40和I_J_K被指定的程序段
# 该程序段前面的程序段为G41或G42模式
如果在指定G40和L，J，K的程序段之前为G41或G42模式，系统则假设：已经指定从前面程序段的终点到矢量（I，J）、（I，K）或（J，K）的方向。偏置方向与前面程序段中的方向相同。
![](images/849b13f5341411aa60bcbed9fbce1ff4d493dc8f72cf6f91e1c1e881be1ccf25.jpg)
在这种情况下应注意，不管指定加工内边还是加工外边，CNC都可得到一个交点。
![](images/bf91c7177845bf3d69ee2f7ebd36152c9d2bc6d3d2427c7091f8c3b854112f8d.jpg)
当得不到交点时，刀具移动到 G40 前面的程序段的终点并与之正交。
![](images/e1893a0d42220b191ddde8b14c90e82f5592691a86d26be0c70797dc747d8a0f.jpg)
# - G40 和 I_J_K_被指定的程序段中无移动指令、该程序段前面的程序段为 G41 或 G42 模式
参数 GNI(No.5000#3)=0 时，视为无移动的程序段，前往与 G40 之前的程序段垂直的位置。（与 Series 16i/18i/21i、Series 0i - C 动作有所不同）
![](images/26caf9770e456c949d180a05705c2914ce5abb40a251b1c0b0aab6adf5d9c030.jpg)
参数 GNI(No.5000#3)=1 时，则认为指令了从前一个程序段的终点到矢量(I,J)、(I,K)或(J,K)的方向。偏置方向与前面程序段中的方向相同。（Series 16i/18i/21i、Series 0i - C 兼容规格）
![](images/e7235bef4d70bcc7e7694c2066478c3efbda059fed43c7fe6570aa820f82fa3f.jpg)
在 Series 0i - F/0i - D 中使用在 Series 16i/18i/21i、Series 0i - C 中使用过的程序时，请在参数 GNI(No.5000#3)=1 的情况下使用。如果在 GNI(No.5000#3)=0 的情况下进行动作，则动作会有所区别，可能会发生贯穿、切削残余。
# 一周以上的圆弧
在下列例子中，圆弧没有变为一周以上，它形成一个从P1到P2的圆弧。可能会由于稍后将要叙述的干涉检查而引起报警。为了产生一个一周以上的圆弧，应将圆弧分割后编程。
![](images/fe4b6a698c5d24efbfd54421100153060c3a1b69429cc0daa4065ef08ff96460.jpg)
# 6.6.5 利用刀具径补偿来防止过切
# ·加工小于刀具直径的凹槽
当刀具中心路径通过刀具径补偿而逆着编程路径移动时，会引起过切，在其紧之前的程序段刚刚开始的位置发出报警并停止。
![](images/9ad59563c1b6110e1f0338127fdb306e81bc23471e84b89e2408855c20ab2fcb.jpg)  
图6.6.5（a）加工小于刀具直径的凹槽
# ·加工比刀具半径小的台阶
- 加工比刀具半径小的台阶若用圆弧来指定工件台阶形状，刀具中心路径则变为如图 6.6.5(b) 所示的情形。当台阶比刀具半径更小时，如图 6.6.5(c) 所示，如果是通常方式下进行补偿的刀具中心路径，有时会变为与编程路径相反的方向。在这种情况下，最初的矢量被忽略，刀具线性移动到第 2 号矢量的位置，单程序段操作在此处停止，如果不是单程序段方式，则自动运行继续进行。如果台阶是被线性指定的，则不会发出报警而正确地进行补偿。但是，此时会出现未切削的部分。
![](images/3f19167e178bd1dd917421a4c4a3f830215dd7a5bd66e17d2470b1a3ea70f42b.jpg)  
图6.6.5（b）加工比刀具半径大的台阶
![](images/4344d8085c0bdc1e469c0abaf91ed86597450777748f131dde65f32607f2f5e7.jpg)  
图6.6.5（c）加工比刀具半径小的台阶
# 开始补偿和沿  $\mathbf{Z}$  轴的切削操作
- 开始补偿和沿  $\mathbf{Z}$  轴的切削操作通常使用这种方式：在切削开始时离开工件某一距离的位置执行刀具径补偿后（通常是XY平面），刀具沿Z轴切削。此时，如果想把沿Z轴的动作分成2个阶段：快速进给和接近工件后的慢速进给，则应注意下列事项编程。假设刀具径补偿模式中的读入程序段数（参数(No.19625)）为3，设想如图6.6.5(d)所示的程序。
![](images/f1242d65c818ef573a527bc8712f736baf64bcd944e9a3f295ab6d22221df060.jpg)  
图6.6.5 (d)
图6.6.5 (d)在图6.6.5(d)的程序中，在开始对N1进行补偿时，可以读入  $\mathrm{N1}\sim \mathrm{N6}$  的程序段，因此，根据它们之间的关系，进行正确的补偿，如图6.6.5(d)所示。这里，假定程序段N3被按照图6.6.5(e)所示那样分成N3和N5。
![](images/b685be9b15dfcbd77fb45f9d70edb68c09d4764c0df22dd28a59e131df9443b0.jpg)  
图6.6.5 (e)
此时，读入程序段数为3，在开始N1的补偿时，虽然可以读入  $\mathrm{N1}\sim \mathrm{N5}$  的程序段，但是，无法读出N6程序段。结果，只是基于N1程序段的信息进行补偿，并在补偿开始程序段的终点创建垂直的矢量。因此，如图6.6.5(e)所示那样，通常会产生过切。
在这种情况下，可利用上述规则，在刀具沿着Z轴切入之后，事先在刀具沿着Z轴快要切入之前指定与刀具路径完全相同的指令，由此来防止过切。
![](images/a1bf9aa265e23430d6b624e3278df8074166b9541993ec2a2eaf1ae03d7d7bf1.jpg)  
图6.6.5 (f)
由于为N2指定了与N6的前进方向相同的指令，所以能正确进行补偿。
此外，在起刀的程序段中，如N1 G91 G00 G41 X500. Y500. I0 J1 D1; 那样地，在刀具沿着Z轴切入后将IJ型矢量指定为与前进方向相同的方向，同样可以防止过切。
# 6.6.6 干涉检查
刀具切入工件称为干涉，干涉检查功能提前检查刀具的干涉情况。然而，根据干涉检查功能的不同，并不能防止所有干涉，即使不发生干涉情况，有时也要进行干涉检查。
# 可以进行干涉检查的条件
要进行干涉检查，最起码必须读入3个或更多个具有移动的程序段。因此，在偏置模式下，通过连续指定辅助功能单独指令、暂停等不伴随移动的程序段，在无法读出具有移动的3个或更多个程序段时，就难以进行干涉检查，在某些情况下会导致过切或不充分切削。假设由参数(No.19625)确定的偏置模式中的读入程序段数为N，已读入的N程序段中不伴随移动的程序段的指令数为M，则可以进行干涉检查的条件就成为：
$(\mathrm{N - 3})\cong \mathrm{M}$
譬如，偏置模式中的最大读入程序段数为8时，即使指定5个没有移动的程序段，也照样可以进行干涉检查。但是，在这种情况下，虽然可以对相邻的3个程序段之间进行干涉检查，但是对其之前产生的干涉则无法进行检测。
# 干涉检查的方法
干涉检查的方法有两种：后文描述的方向检查和圆弧角度检查。根据参数CNC(No.500##1)和参数CNV(No.5008#3)，设定这些方法和是否有效。
| CNV | CNC | 动作 |
| --- | --- | --- |
| 0 | 0 | 干涉检查有效，进行方向检查和圆弧角度检查。 |
| 0 | 1 | 干涉检查有效，仅进行圆弧角度检查。 |
| 1 | 1 | 干涉检查无效。 |
没有仅进行方向检查这样的设定。</td></tr></table>
# ·视为干涉的基准(1)（方向检查）
假设刀具径补偿中的读入程序段数为N，首先对最初将被输出的（程序段1一程序段2）之间计算的补偿矢量组和（程序段N- 1一程序段N）之间计算的补偿矢量组进行检查，如果产生交点，则判断为相互干涉。若没有交点，则按照下列顺序
（程序段1一程序段2）和（程序段N- 2一程序段N- 1）（程序段1一程序段2）和（程序段N- 3一程序段N- 2）
（程序段1一程序段2）和（程序段2一程序段3）
沿着靠近本次将被输出的补偿矢量组的方向进行检查。补偿矢量组即使产生多组，也均成对地进行检查。
在对（程序段1一程序段2）和（程序段N- 1一程序段N）的补偿矢量组进行检查时，判断的方法为：对从所指令的（程序段1的终点）到（程序段N- 1的终点）的方向矢量与从（在程序段1的终点加上将要检查的补偿矢量后的点）到（在程序段N- 1的终点加上将要检查的补偿矢量的点）的方向矢量进行比较，如果在方向大于等于  $90^{\circ}$  、小于等于  $270^{\circ}$  下相交，则判断为相互干涉。这叫做方向检查。
视为干涉的基准(1)的例子
（程序段1的终点矢量和程序段7的终点矢量相交时）
![](images/e105b3837ef9fe5b8a506656d9d48fa4c0c71407e6beead872460e5e7b0db080.jpg)
（程序段1的终点矢量和程序段2的终点矢量相交时）
![](images/23c468722a094cc8894278397aa73e5f5e1bad44dbcb70f79dd7304321704a42.jpg)
# ·视为干涉的基准(2)（圆弧角度检查）
相邻的3个程序段间的检查，即在进行（程序段1一程序段2）之间计算的补偿矢量组和在（程序段2一程序段3）之间计算的补偿矢量组的检查中，程序段2为圆弧时，除了进行(1)的方向检查外，对程序路径的起点一终点间的圆弧角度和补偿后路径的起点一终点间的圆弧角度进行检查。并且，此差值大于等于  $180^{\circ}$  时，判断为相互干涉。这叫做圆弧角度检查。
(2)的例子（程序段2为圆弧且补偿后的圆弧的起点和终点一致时）
![](images/01948ddf4f6ed1b01efbd6e8b040b1bc905209a6883126617f0a75da1ad731fe.jpg)
# ·即使实际上没有干涉而被视为干涉时
(1）比刀具径补偿值或刀尖半径补偿值小的凹陷
![](images/58f402573c3bdc13e4c901ebad65abc5bc0eaf1d0654d24cc7a2a35f7c45692a.jpg)
不存在实际的干涉，但是，因为在程序段B中编程方向与刀具径补偿后的路径方向相反，被视为干涉，报警器发出报警，刀具停止。
(2）比刀具径补偿或刀尖半径补偿值更小的凹槽
![](images/4af73f90a2bbe2f3c65947463a94f78b0608782f017bac4d968de62202237809.jpg)
与(1)一样，因为在程序段B中方向相反而被视为干涉，报警器发出报警，刀具停止。
# 6.6.6.1 被判断为干涉时的动作
通过干涉检查而被判断为发生干涉（过切）时的动作，可以通过参数CAV(No.19607#5)的设定选择下列2种。
| 参数 CAV | 功能 | 动作 |
| --- | --- | --- |
| 0 | 干涉检查报警功能 | 在执行发生过切（干涉）的程序段之前，发出报警并停止刀具。 |
| 1 | 干涉检查避开功能 | 改变刀具路径并继续进行加工，由此来避免过切（干涉）的发生。 |
# 6.6.6.2 干涉检查报警功能
# ·发生在相邻的3个程序段间外的干涉
如图6.6.6.2(a)所示，程序段1的终点矢量和程序段7的终点矢量之间被判断为相互干涉时，在执行程序段1的动作前发出报警，刀具停止。在这种情况下，矢量不会被擦除。
![](images/c303e597de07ddbb98d3d91f6de998a21b668a7e6cd0b15b0e2ef1e63f7b2ac0.jpg)  
图6.6.6.2(a)
# ·发生在相邻的3个程序段间的干涉
·发生在相邻的3个程序段间的干涉当被判断为在相邻的3个程序段间发生干涉时，擦除发生干涉的矢量以及较其内侧的矢量，并创建一个连接其余矢量的路径。图6.6.6.2(b)在所示的例子中，V2和V5相互干涉，因此，V2、V5以及其内侧的V3、V4被擦除，V1和V6被连接起来。此间的动作叫做直线插补。
![](images/36073624be90cbd1cdc177510468ec3f86712e39e252ed981e75fe41d0aa1526.jpg)  
图6.6.6.2 (b)
图6.6.6.2 (b)在擦除矢量后，最后的一个矢量尚发生干涉，或者从一开始只有一个矢量且发生干涉时，在上一个程序段的刚刚开始（单程序段时为终点）发出报警，刀具停止。图6.6.6.2(c)所示的例子中，V2和V3相互干涉，但是即使将其擦除以后，由于最后的V1和V4仍然相互干涉，因此发出报警。
![](images/00f31d61ae970e413e4819640cdd6862f779301f9756641ee5c5a34efc2f8036.jpg)  
图6.6.6.2 (c)
# 6.6.6.3 干涉检查避开功能
在干涉检查报警功能下指定了一个满足发出干涉报警的条件的指令时，在选定本功能的情况下，不会有干涉报警发出，而是计算成为避开干涉的路径之新补偿矢量，使加工继续进行。但是，避开干涉的路径，对于编程路径将出现不充分切削现象。此外，根据指令形状，有时无法求出用来避开干涉的路径，或者会被判断为避开干涉的路径存在危险。在这种情况下，将会发出报警并停止刀具。因此，并非对于所有的指令都能避开干涉。
# ·避开干涉的方法
假设（程序段1一程序段2）之间的补偿矢量与（程序段N- 1一程序段N）之间的补偿矢量发生干涉这样的情形。从程序段1的终点到程序段N- 1的终点的方向矢量叫做间隙矢量。此时，求出（程序段1一间隙矢量）之间的补偿后的交点矢量与（间隙矢量一程序段N）之间的补偿后的交点矢量，创建连接此交点矢量的路径。
![](images/f9d94432fd7f4fea44b8c72a2a9b3398c513917ce322497a2d98e7f071c46a98.jpg)  
图6.6.6.3 (a)
（程序段1一间隙矢量）的补偿后的交点矢量与（间隙矢量一程序段N）的补偿后的交点矢量进一步相交时，首先按照与“发生在相邻的3程序段间的干涉”相同的方法擦除矢量。最后剩下的矢量仍然相交时，再次计算并求取（程序段1一程序段N）的补偿后的交点矢量。
![](images/178a8881ab59ca9da5f21a4103c0594c1e95b521e27640ee42dd8d981126e407.jpg)  
图6.6.6.3 (b)
此外，当刀具径补偿或刀尖半径补偿值大于如图6.6.6.3(c)所示指定的圆弧半径，且指定了对圆弧的内侧进行补偿的指令时，通过将圆弧的指令视为直线并进行交点计算来避开干涉。在这种情况下，避开矢量之间通过直线插补连接。
![](images/3819b8523c54dedf8f794f1d23fc1b40e24eb5ce00d086bdf28f8523ae2c2d5d.jpg)  
图6.6.6.3 (c)
# - 不存在干涉避开矢量时
加工如图6.6.6.3(d)所示的平行槽孔时，程序段1的终点矢量和程序段2的终点矢量间被判断为相互干涉，作为干涉避开矢量而试图计算程序段1的补偿后路径和程序段3的补偿后路径的交点矢量。在这种情况下，由于程序段1与程序段3平行，不存在交点。此时，在程序段1紧之前发出报警，刀具停止。
![](images/89c41d139c7792bc92f76cd301da49ac1574a992457f0028d016bb362865f052.jpg)  
图6.6.6.3(d)
加工如图6.6.6.3(e)所示的圆弧槽孔时，程序段1的终点矢量和程序段2的终点矢量间被判断为相互干涉，作为干涉避开矢量而试图计算程序段1的补偿后路径和程序段3的补偿后路径的交点矢量。在这种情况下，由于程序段1与程序段3是一条圆弧，不再存在补偿后的交点。这种情况也与前面的例子一样，在程序段1紧之前发出报警，刀具停止。
![](images/1dd29b3c4b9d84e7c72e1a67d691796cfa9a62cd106e900338d7dc6f0fb4aee8.jpg)  
图6.6.6.3(e)
# ·避开干涉时被判断为危险时
·避开干涉时被判断为危险时加工如图6.6.6.3(f)所示的锐角槽孔时，程序段1的终点矢量和程序段2的终点矢量间被判断为相互干涉，作为干涉避开矢量而试图计算程序段1的补偿后路径和程序段3的补偿后路径的交点矢量。在这种情况下，避开后路径的移动方向成为与原来的指令方向完全不同的方向。对于避开后的路径与原来的指令完全不同（大于等于  $90^{\circ}$ ，小于等于  $270^{\circ}$ ）这样的情形，避开干涉的动作被判断为危险，在程序段1之前发出报警，刀具停止。
![](images/ec4b4facfdb778ed756d31f22191a86d2859f218435061698ab7f2d51595009a.jpg)  
图6.6.6.3(f)
图6.6.6.3(f)加工如图6.6.6.3(g)所示的底部比入口宽的槽孔时，程序段1的终点矢量和程序段2的终点矢量间被判断为相互干涉，作为干涉避开矢量而试图计算程序段1的补偿后路径和程序段3的补偿后路径的交点矢量。在这种情况下，程序段1和程序段3的关系被判断为外侧，避开后路径对原来的指令而言出现过切。这种情况同样会将避开干涉的动作判断为危险，在程序段1紧之前发出发出报警，刀具停止。
![](images/68d17ab7836f92e644d5d8a9c7c85c1c1080bb4122a55e853c5568b93d414be6.jpg)  
图6.6.6.3(g)
# - 对干涉避开矢量进一步产生干涉时
加工如图6.6.6.3(h)所示的槽孔时，如果读入程序段数为3，程序段1的终点矢量和程序段2的终点矢量间被判断为相互干涉，作为干涉避开矢量而计算程序段1的补偿后路径和程序段3的补偿后路径的交点矢量。但在这种情况下，接着将被计算的程序段3的终点矢量，对于先前的干涉避开矢量进一步产生干涉。相对于如此之一旦创建并被输出的干涉避开矢量进一步产生干涉时，不执行该程序段的移动而在其紧之前发出报警，刀具停止。
![](images/aafe6c3760e690fedb79985e9cc615c8d9c8c5e8a1ad3f7908446af27f9c4f3c.jpg)  
图6.6.6.3 (h)
1 对于“避开干涉时被判断为危险时”以及“对干涉避开矢量进一步产生干涉时”，可以通过参数NAA(No.19607#6)的设定，使其不发出报警而继续进行加工。但是，对于“不存在干涉避开矢量时”的情形，不管本参数的设定如何，都无法避免报警的发生。2 在执行避开干涉的操作中执行诸如单程序段停止，手动干预、MDI干预、刀具径补偿或刀尖半径补偿值的变更等与原来的移动不同的操作，在新的路径进行交点计算。因此，在执行此类操作时，已经避开的干涉可能会进一步产生干涉，应予注意。
# 6.6.7 针对来自MDI输入的刀具径补偿或刀尖半径补偿
# - MDI运行
在MDI运行期间，即在复位状态下通过MDI模式指定程序指令并执行循环开始操作时，与存储器运行／DNC运行一样地进行交点计算并予以补偿。通过MDI运行调用程序存储器中的子程序时，也同样进行补偿。
![](images/48ca1737bcf87f42b8689d6ade94ef3de8e5d728de9acc359f5dcdaebc9bb02e.jpg)
# - MDI 干预
在执行 MDI 干预，即在存储器运行 / DNC 运行等中途执行单程序段停止以进入自动运行停止状态，在 MDI 模式下指定程序指令并执行循环开始操作时，刀具径补偿不进行交点计算而继续保持干预前的最后的补偿矢量。
![](images/459480dccdeefdf9fe41c48ecb37b7fe445e737521e300b2a6d266585eca04a3.jpg)
MDI 运行、MDI 干预时如果执行刀具径/刀尖半径补偿，请设定为参数 MCR(No.5008#4)=0。如果在参数 MCR(No.5008#4)=1 的情况下执行，将会发生报警(PS5257)“MDI 模式下无法指令 G41/G42”。
# 6.7 矢量保持（G38）
在刀具径补偿或刀尖半径补偿中，通过在偏置模式下指定G38，即可不进行交点计算地在上一个程序段的终点位置保持补偿矢量。
（偏置模式中）G38IP_;
IP：轴移动的指令值
# ·矢量保持
通过上述指令，在G38之前的一个程序段的终点，输出垂直于该程序段的矢量。并且，在G38的程序段中，保持上一个程序段中输出的垂直矢量。G38是单步G代码。因此，在没有G38指令的下一个移动指令中重新创建补偿矢量。
# ·模式
请在G00或G01模式下指定G38。在G02或G03（圆弧插补）模式下指定G38时，在起点和终点有时会产生半径误差。
# ·起刀／取消
在起刀/取消中，作为起刀时的刀具移动项以及偏置模式取消模式下的刀具移动项中描述的动作。因此，在下一个程序段中，无法指令G38。
1）起刀指令(G41，G42)的程序段2) 取消指令(G40)的程序段3) 取消指令(G40)前一个程序段
![](images/a33f2c8e823b5ccb6a6d44d439b87bab80c8906e69737f24d2bfee5a3feb0f39.jpg)
# 6.8 拐角圆弧插补（G39）
在刀具径补偿或刀尖半径补偿中，通过在偏置模式下指定G39，即可在拐角处进行以补偿值作为半径的拐角圆弧插补。
在偏置模式下
G39;
G39  $\left\{ \begin{array}{l}\mathbf{I}_{- }\mathbf{J}_{- } \\ \mathbf{I}_{- }\mathbf{K}_{- } \\ \mathbf{J}_{- }\mathbf{K}_{- } \end{array} \right\}$ ;
# ·拐角圆弧插补
当上表所示的指令被指定时，即可进行以补偿值为半径的拐角圆弧插补。此指令前面的G41、G42确定圆弧是顺时针方向还是逆时针方向。G39是单步G代码。
# ·没有I、J、K指令时的G39
当指定G39时，产生拐角圆弧，该拐角圆弧使圆弧终点的矢量与下一程序段的起点垂直。
# ·含有I、J、K指令时的G39
当用I、J、K指定G39时，产生拐角圆弧，该拐角圆弧使圆弧终点的矢量与由I、J、K值指定的矢量垂直。
# ·移动指令
无法在一个含有G39的程序段中指定移动指令。否则将会发出报警。
# ·内边拐角
无法对于内边拐角的程序段间指定G39。指定该该指令将导致切过。
# ·拐角圆弧的速度
在G00模式下通过G39指定拐角圆弧时，拐角圆弧的程序段的速度将是基于前面指定的F指令的速度。在程序中一次也没有指定F指令的状态下指定G39时，拐角圆弧的程序段的速度作为参数(No.1411)中所设定的速度。
![](images/107ead4356dcc94ac9ba5d585294cf1bc528a12cff4170c5a2a3f0503379bd9e.jpg)
![](images/355ec1d3374bcde0e14ae9f8e27f20378ccf14d75e930828968a1812f2c39761.jpg)
# 6.9 刀具补偿值、补偿值数目和利用程序的刀具补偿值输入（G10）
刀具补偿值包括刀具几何补偿值和刀具磨损补偿值（图6.9(a)）。
![](images/11554868a85187fa838700ff4f8ee9a1527476842958eacae0ae9d2a9184c52c.jpg)  
图6.9（a）几何补偿值和磨损补偿值
刀具补偿值可以由MDI（见III- I.1.1）输入CNC的存储器，或从程序输入。被设定（输入）在CNC中的刀具补偿值，可由程序中的地址H或D后面的代码指定，此值用于刀具长度补偿、刀具径补偿或刀具位置偏置的补偿值。
刀具补偿存储器按照补偿值的构成分为刀具补偿存储器A、C三类，可以任选。
# ·刀具补偿存储器A
刀具补偿存储器A，没有几何补偿存储器和磨损补偿存储器之区别。因此，可以将几何补偿和磨损补偿累加起来的值设定在补偿存储器中。此外，也没有刀具径补偿用（D代码用）和刀具长度补偿用（H代码用）的区别。
设定例  
| 偏置号 | 补偿值(几何+磨损) | D代码/H代码通用 |
| --- | --- | --- |
| 001 | 10.000 | D代码用 |
| 002 | 20.000 | D代码用 |
| 003 | 100.000 | H代码用 |
| ... | ... | ... |
# ·刀具补偿存储器C
刀具补偿存储器C分别备有几何补偿存储器和磨损补偿存储器。因此，可以分别设定几何补偿值和磨损补偿值。此外，还分别备有刀具补偿用（D代码用）和刀具长度补偿用（H代码用）的存储器。
| 偏置号 | D代码 | H代码 |
| --- | --- | --- |
| 几何补偿用 | 磨损补偿用 | 几何补偿用 |
| 001 | 10.000 | 0.100 |
| 002 | 20.000 | 0.200 |
| ... | ... | ... |
# ·刀具补偿值的单位和设定范围
刀具偏置值的单位和设定范围，可以通过参数OFC,OFA(No.5042#1,#0)从下列项目中选择。
补偿值的单位和设定范围（米制输入）  
| OFE | OFD | OFC | OFA | 单位 | 设定范围 |
| --- | --- | --- | --- | --- | --- |
| 0 | 0 | 0 | 1 | 0.01mm | ±9999.99mm |
| 0 | 0 | 0 | 0 | 0.001mm | ±9999.999mm |
| 0 | 0 | 1 | 0 | 0.0001mm | ±9999.9999mm |
| 0 | 1 | 0 | 0 | 0.00001mm | ±9999.99999mm |
| 1 | 0 | 0 | 0 | 0.000001mm | ±999.999999mm |
补偿值的单位和设定范围（英制输入）  
| OFE | OFD | OFC | OFA | 单位 | 设定范围 |
| --- | --- | --- | --- | --- | --- |
| 0 | 0 | 0 | 1 | 0.001inch | ±999.999inch |
| 0 | 0 | 0 | 0 | 0.0001inch | ±999.9999inch |
| 0 | 0 | 1 | 0 | 0.00001inch | ±999.99999inch |
| 0 | 1 | 0 | 0 | 0.000001inch | ±999.999999inch |
| 1 | 0 | 0 | 0 | 0.0000001inch | ±99.9999999inch |
# ·刀具补偿数目
整个系统中使用的刀具补偿数据的个数随所使用的机床而不同，请参阅机床制造商提供的说明书。
编程格式取决于使用刀具补偿存储器的种类。
刀具补偿存储器为A时
G10L11P_R_Q_; P_：刀具补偿号 R_：刀具补偿值 Q_：假想刀尖号
刀具补偿存储器为C时
G10L_P_R_Q_;
L_：补偿存储器的种类L10：对应于H代码的几何补偿值L11：对应于H代码的磨损补偿值L12：对应于D代码的几何补偿值L13：对应于D代码的磨损补偿值L110：对应于D代码（倒圆偏置用）的几何补偿值L111：对应于D代码（倒圆偏置用）的磨损补偿值P_：刀具补偿号R_：刀具补偿值Q_：假想刀尖号
可以通过G10的指令设定/改变刀具补偿值。当用绝对输入(G90)来指定G10时，所指定的值就作为新的刀具补偿值。使用增量输入(G91)时，加上了当前设定的刀具补偿值中所指定值后的值，就作为新的刀具补偿值。
1 地址R遵从刀具偏置值的设定单位。2 为了与以往的CNC格式相互兼容，省略L时，在指定了L1的情况下，作为指定了L11相同的动作。3 假想刀尖号具有刀具径补偿功能，在使用假想刀尖方向时予以设定。
# 6.10 坐标系旋转（G68、G69）
可以使编程形状旋转。通过使用这一功能，在安装的工件处在相对于机床旋转的位置上这样的情况，即可通过旋转指令来进行补偿。此外，当存在使一个形状旋转的图形时，通过编写一个形状子程序，在使其旋转后调用该子程序，就可以缩短编程所需的时间和程序长度。
![](images/5b145fe73cf87b4b0198c945345d3b8f233466c8d20793ce80a9cfe9d4b195c4.jpg)  
图6.10(a)坐标系旋转
![](images/f625b721e9dc40fb1e3f6958fbfe90e9c1ad5d383b1fdf6c55a2791cf6bef7e1.jpg)
![](images/984474172a8401127f7a2949fec1c0b95e4c2024ee05d82c27529e30bec5a85e.jpg)  
图6.10（b） 旋转中心与旋转角度
当在旋转角度指令（R）中使用小数点时，小数点的位置以度为单位。
# ·平面选择G代码G17、G18或G19
用于平面选择的G代码（G17、G18、G19）可在含有坐标旋转的指令G代码（G68）的程序段前面指定。在坐标系旋转模式下，不应指定G17、G18或G19。
# ·坐标系旋转模式下的增量指令
针对在指定G68后在绝对指令之前的增量指令，指定了G68时的刀具位置即被认为是旋转中心（图6.10(e)）。
# ·旋转中心
在没有指定旋转中心（ $\alpha_{- }\beta_{- }$ ）的情况下，指定G68时的刀具的位置就变为旋转中心。
# ·旋转角度指令
当省略旋转角度指令(R_时，在参数(No.5410)中设定的值被认为是角度。旋转角度指令(R_在将参数FRD(No.11630#)设定为1时，可以取0.00001deg单位（10万分之1）。此时的指令范围为 $- 36000000\equiv \mathrm{R}\equiv 36000000$ 。
# ·坐标系旋转取消
坐标系旋转取消指令的G代码(G69)可以与别的指令一起指定在相同的程序段中。
# ·刀具补偿
刀具径补偿或刀尖半径补偿、刀具长度补偿、刀具位置偏置和其他补偿操作在坐标旋转后进行。
# ·与三维坐标变换（G68、G69）之间的关系
坐标旋转和三维坐标变换都用相同的G代码：G68和G69。如果有I、J、K指令，就视为三维坐标变换；如果没有I、J、K的指令，则视为二维坐标旋转的指令。
# ·与参考点返回／坐标系相关的指令
在坐标旋转模式下，无法指定与参考点有关的G代码（G27、G28、G29、G30等）和用来改变坐标系的指令（G52～G59、G92等）。在指定这些G代码时，请先取消坐标旋转模式。如果在G68.1模式中指令，将会发生报警(PS0412）“使用非法G代码”。
# ·增量指令
- 增量指令紧跟在坐标旋转取消(G69)之后的最初的移动指令必须用绝对值来指定。如果是增量指令，就不会进行正确的移动。
- AI轮廓控制模式、3维坐标变换模式中的指令M系列的情况下，始终可指令。
# ·坐标系旋转的1轴指令的注意
通过如下参数，可以选择在绝对模式下指令了1轴时的移动位置。2轴指令的情况下，与参数设定无关地移动到相同的位置。
参数AX1(No.11600#5)
坐标系旋转模式下，在绝对模式下指令了1轴的情形
0：首先，由旋转前的坐标系计算指令位置，使坐标系旋转。
1：首先，坐标系旋转，然后在该坐标系上移动到指令位置。（FS16i/18i/21i兼容规格）
由于本参数，尚未指令的轴的坐标的操作将会变化，所以移动的位置不同。
G90G0X0Y0G01X10. Y10. F6000G68X0Y0R45. ···坐标系旋转指令Y14.142·1轴指令 (1)G69
AX1(No.11600#5)=0的情形
由旋转前的坐标系(XY)计算指令位置，使坐标系旋转。因此，(1)中的指令下，尚未指令的X轴的位置成为X10，指令位置为(X10,Y14.142)。然后，移动到使其旋转45度的移动位置（X- 2.929,Y17.071）。
![](images/dc2fa51576748233b2a82533863d9f8cfd7d44f93513aa93e984f6520f82d6bc.jpg)  
图6.10(c)1轴指令  $\mathbf{(AX1 = 0)}$
AX1(No.11600#5)=1的情形：
(1)中的指令下，变换为使坐标旋转指令前的坐标值(X10,Y10)旋转45度后的坐标系(X'Y')中的坐标值(X'14.142,Y'0)。然后移动到指令位置(X'14.142,Y'14.142)，即移动位置(X0,Y20)。
![](images/0147e1b8c24950c4393cd4ae885648280b67a28dfed0d134ad987227ea7654a7.jpg)  
图6.10（d）1轴指令  $\mathbf{(AX1 = 1)}$
·绝对/增量指令
![](images/9607c4f4a0337065bad6bd40a79a8fd45fa911a780290f961ee90e20cf054182.jpg)  
图6.10（e）坐标系旋转模式下的绝对/增量指令
# - 刀具径补偿和坐标旋转
![](images/696e203d1256ac43176e08bed283f5a7096ea398a6b8c248975185aa94f94592.jpg)  
图6.10 (f) 刀具径补偿和坐标系旋转
# ·比例缩放和坐标旋转
如果在比例缩放模式（G51模式）下指定坐标旋转，则旋转中心的坐标值（α，β）也将被比例缩放。但是，旋转角度（R）不会被比例缩放。针对移动指令，首先使用比例缩放，然后进行坐标旋转。
在刀具径补偿模式(G41、G42)和比例缩放模式(G51)，无法指定坐标旋转指令（G68）。坐标旋转指令始终应在设定刀具径补偿模式之前被指定。
1. 非刀具径补偿模式时的指令顺序G51： 比例缩放模式开始G68： 坐标系旋转模式开始G69： 坐标系旋转模式取消G50： 比例缩放模式取消
2. 刀具径补偿模式时的指令顺序（图6.10（g））
（刀具径补偿取消）G51： 比例缩放模式开始G68： 坐标系旋转模式开始：G41： 刀具径补偿模式开始
![](images/c283b7420c8afacb47a97984de36b47b5ec635e5821d24723417825ace0c0dcc.jpg)  
图6.10（g）在刀具径补偿模式下的比例缩放和坐标旋转
# 反复指定的坐标旋转
可以事先存储一个程序作为子程序，通过改变角度来调用该子程序。
![](images/a9773e1665e3b12a46f3c48c1077e94b3113bea1ac00d46327b665d0b2605193.jpg)  
图6.10（h）坐标系旋转指令
# 7 Series15格式下的存储器运行
通过将设定参数FCV(No.0001#1)设定为1，就可以将由Series15的程序格式记录的程序记录到存储器中并进行存储器运行。
可以处理本Series0i- FPlus与Series15之间不同的刀具径补偿、子程序调用和固定循环的程序格式并进行存储器运行。其他程序格式必须符合本Series0i- FPlus。当一个超出Series0i- FPlus的指令范围的值被记录时，发出报警。
1 关于Series0i- FPlus上没有的功能，无法记录到存储器中，也无法进行存储器运行。2 请勿在存储器运行中切换参数FCV(No.0001#1)。切换要在复位状态下进行。3 有关刚性攻丝，请参照“5.3刚性攻丝”。4 Series15格式的限制事项及注意事项请参照通常的格式。
# - 刀具径补偿的偏置号的地址
偏置号由Series15中的地址D指定。当偏置号由地址D指定时，由地址H指定的模态值被由地址D指定的偏置号取代。
# - 子程序的调用
如果一个4位数以上的子程序被指定，则后4位数被认为是子程序号。如果没有指定重复次数，则重复次数被认为是1次。
表7（a）子程序调用的程序格式  
| 机型 | 程序格式 |
| --- | --- |
| Series 15 | M98 P O O O O L O O O O ; P: 子程序号 L: 重复次数(1～9999) |
| Series 0i-F Plus | M98 P O O O □□□□; 重复次数 子程序号 (1～9999) |
但是，用户宏程序有效时（参数NMC(No.8135#5)=0），两者的指令都可用。
# - 钻孔固定循环的重复次数的地址
钻孔固定循环，如表7(b)所示，其重复次数的地址不同。
表7（b）钻孔固定循环的重复次数的地址  
| 机型 | 地址 |
| --- | --- |
| Series 15 | L |
| Series 0i-F Plus | K |
# 8 用于高速加工的功能
# 8.1 通过程序指令选择精细表面设定的设定模式
概述对于影响高品位加工的参数，操作者可以根据加工条件从机床制造商提供的3种参数设定（称为设定模式）中选择有效的设定模式。由此可以简化影响高品位加工的参数的设定与符合加工条件的参数的选择。本章将对通过程序指令选择设定模式进行说明。有关精细表面设定的模式设定画面，请参阅“精细表面设定”的项。
G08.1P_;
P_ ：设定模式P1 ：“模式1”P2 ：“模式2”P3 ：“模式3”
例）如果在程序中指令G08.1P3；，“模式3”即为有效的设定模式。
G05.1Q1R_;
G05.1Q1R_;R_ ：等级（1～10）G05P10000R_;R_ ：等级（1～10）G08P1R_;R_ ：等级（1～10）
通过G08.1指令选择设定模式
通过在自动运行中进行G08.1指令，可以选择设为有效的设定模式。通过地址P指定设为有效的设定模式。
通过G05.1、G05、G08指令选择设定模式
可以通过加工条件选择功能的G代码（G05.1、G05、G08指令）选择设定模式。由此可以直接沿用使用了加工条件选择功能的机床的加工程序。
# 1 显示和设定数据
# 1.1 按下功能键 显示的画面
按下功能键 可显示或设定刀具偏置值及各类设定数据。这里将描述如何显示或设定下面数据。
1. 刀具偏置值2. 刀具长度测量3. 加工等级选择
# 1.1.1 显示和设定刀具偏置值
刀具位置偏置值、刀具长度补偿值、刀具径补偿值均由程序中的D代码或H代码指定。在此画面上显示和设定与D代码或H代码相应的补偿值。
# 显示和设定刀具偏置值（8.4/10.4”显示器的情形）
# 步骤
1 按功能键若是双路径控制，事先利用路径选择开关选择要设定哪个路径的刀具偏置值。2 按下章节选择软键[刀偏]。或按下 数次，显示出刀具补偿画面。根据刀具补偿存储器的类型，显示的画面会有所不同。
![](images/6509a2c197f08f70c7957ee79900e5e7771c6b2437b85d275afbd07279866442.jpg)  
图1.1.1（a）刀具补偿存储器A（10.4”显示器）
![](images/e069ae362b279cd3f09a433133dea61676df59f47ebf313215c044923a5e8649.jpg)  
图1.1.1（b）刀具补偿存储器C（10.4”显示器）
3 利用翻页键、光标键将光标移至想要设定 / 改变的补偿值位置。或者键入想要设定 / 改变的补偿值的补偿号，再按下软键 [搜索号码]。4 想要设定补偿值时，键入补偿值并按下软键 [输入]。想要改变补偿值时，键入一个想要增减的值并按下软键 [+输入]。或者在键入新的补偿值后按下软键 [输入]。
# 显示和设定刀具偏置值（15/19”显示器的情形）
1 按功能键若是双路径控制，事先利用路径选择开关选择要设定哪个路径的刀具偏置值。2 按下章节选择竖排软键[刀偏]。或按下功能键数次，显示出刀具补偿画面。根据刀具补偿存储器的类型，显示的画面会有所不同。
![](images/20c48054151f691c293a4862e3627b65ec68be28089db13d2a61f9cb8e9709e6.jpg)  
图1.1.1（c）刀具补偿存储器A（15”显示器）
![](images/520ea39b86ffa6a1b163bcd761e6b234881ac803b7d20cee9169f1da4956e775.jpg)  
图1.1.1（d）刀具补偿存储器C（15”显示器）
3 利用翻页键、光标键将光标移至想要设定/改变的补偿值位置。或者键入想要设定/改变的补偿值的补偿号，再按下横排软键[搜索号码]。
4 想要设定补偿值时，键入补偿值并按下横排软键［输入］。想要改变补偿值时，键入一个想要增减的值并按下横排软键［+输入］。或者在键入新的补偿值后按下横排软键［输入］。
# - 小数点输入
在输入补偿值时可用小数点。
# - 其他设定方法
外部输入／输出设备可用来输入／输出刀具偏置值。请参阅操作说明书（T系列／M系列通用）“输入／输出数据”。另外，还可以利用下一节将要介绍的刀具长度测量来设定刀具长度补偿。
# - 刀具补偿存储器
刀具补偿存储器有A、C三种，按照如下所示方式区别补偿值的数据。刀具补偿存储器A没有D代码／H代码、刀具几何补偿／刀具磨损补偿的区别。刀具补偿存储器C有D代码／H代码的区别，同时也有刀具几何补偿／刀具磨损补偿的区别。
# - 禁止输入补偿值
设定参数WOF、GOF（No.3290#0、#1）可以禁止补偿值的输入。（没有刀具补偿存储器A）此外，通过在参数（No.3294）中设定一个在那时被禁止输入的刀具偏置值的开头号，在参数（No.3295）中设定一个从该开头号数起的个数，即可禁止从MDI输入任意指定范围内的刀具偏置值。设定连续的输入值如下。1）从一个可以输入的偏置号输入到禁止输入的偏置号时，发出警告，仅在可以输入的偏置号范围内设定。
2）从一个禁止输入的偏置号连续输入到可以输入的偏置号中时，系统会发出警告而不予设定补偿量。
# 1.1.2 刀具长度测量
刀具长度可以作为刀具长度偏置值来测量和登录，其方法是移动参考刀具和待测刀具，直到其抵接于机床上某一固定点。刀具长度可以沿X轴、Y轴或Z轴测量。通过设定参数CIM(No.11405#2)，可以切换基于相对坐标的测量与基于机床坐标的测量。
# 基于相对坐标刀具长度测量（8.4/10.4”显示器的情形）
1 以手动运行方式移动参考刀具，直到其抵接于机床固定点（或工件上的固定点）。2 按下功能键POS 数次，显示出相对坐标的位置显示画面。
![](images/f5298eac79e7848b340a12ed4abe7e988a732d351d8391fd6e0ae8d646d91639.jpg)  
图1.1.2（a）实际位置显示画面（10.4”显示器）
3 将Z轴的相对坐标值复位至“0”。
4 按下功能键POS 数次，显示出刀具补偿画面。
5 以手动运行方式移动待测刀具，直到其抵接于机床上相同的固定点。此时，在画面上以相对坐标值（也在刀具补偿画面上显示。）显示出参考刀具和待测刀具长度上的差别。
6 将光标移动到将要设定的测量值的刀具偏置号处。（光标的移动与刀具偏置值的设定时相同）
7 按下地址 Z
按下X或代替地址Z时，作为刀具长度补偿值分别输入X轴或Y轴的相对坐标值。
8 按下软键[C输入]。Z轴相对坐标值作为刀具长度补偿值被输入并显示。
![](images/40c06d7227d6b868b755660158ee43ecc8657d7926bfd4ca61034bbcec95d83a.jpg)
# 基于相对坐标刀具长度测量（15/19”显示器的情形）
1 以手动运行方式移动参考刀具，直到其抵接于机床固定点（或工件上的固定点）。2 按下功能键，显示全部位置显示画面。
![](images/b52f664778aab2b3c34e7c6ff4145aa936dab3254ea1186586bfb4f9a080d691.jpg)  
图1.1.2（b） 实际位置显示画面（15”显示器）
![](images/4527b8ad8a914a042545c3eac56056247e5527dfacd4e326008d2205c1488e97.jpg)
5 以手动运行方式移动待测刀具，直到其抵接于机床上相同的固定点。此时，在画面上以相对坐标值（也在刀具补偿画面上显示。）显示出参考刀具和待测刀具长度上的差别。6 将光标移动到将要设定的测量值的刀具偏置号处。（光标的移动与刀具偏置值的设定时相同）
![](images/fa20d7d3bcdb6d2378b9faca129323405b89ee83bcd7434be67468f58cb9494d.jpg)
![](images/1e2827d1210b71849b00e4de3b32cd24b5486e64cf4c8f3d4ddb8f57c6146ffe.jpg)
8 按下横排软键[C输入]。
Z轴相对坐标值作为刀具长度补偿值被输入并显示。
![](images/2c42e85274e6a315fabfe5cc1c4f1c2ef5444dc418ba0128d6ae3375d8ae4156.jpg)
# 基于机床坐标的刀具长度测量
![](images/c30471f5c5e3e2ad1945e812d4ac40dffad7537b248373420a0e9d72fe482ab0.jpg)
![](images/e52c734eea050b82eaed28a139970dbe71c9795d7a142ac600992ab0db50e0ed.jpg)  
图1.1.2（c）基于机床坐标的设定画面（  $10.4^{\ast}$  显示器）
7 键入调整值，按下软键[调整值]。“补偿值”中显示刀具长度补偿值中输入的值。8 按下软键[执行]。补偿值作为刀具长度补偿值被输入并显示。
# 1.1.3 精密表面设定
1.1.3 精密表面设定对于影响高品位加工的参数，可以根据加工条件从事先准备的3种参数设定（称为设定模式。）中选择有效的设定模式。由此可以简化影响高品位加工的参数的设定与符合加工条件的参数的选择。精密表面设定有2个画面，分别是精密表面设定画面与模式选择画面。在精密表面设定画面中可以准备设定模式、在模式选择画面中可以选择设定模式。本章将对模式选择画面（设定模式的选择）进行说明。有关精细表面设定画面（设定模式的准备），请参阅“连接说明书（功能篇）（B- 64693JA- 1）”。
# 显示模式选择画面
1 按下功能键 2 按下继续菜单键 数次，显示软键[加工条件]。3 按下软键[加工条件]，显示模式选择画面。
![](images/3668aee2acf5bf85772afcf6f43d38d5a638ab9dc83bdde28787a8f97be8157a.jpg)  
图1.1.3（a）模式选择画面
# 模式选择画面的操作
# 公差的设定
![](images/e1a634f14997c5ea28622fd6f1aa2067b28f01aa348b3676849348bfaff2e89a.jpg)
![](images/908e45752095206883b6049bad34a6c5f86c75174f34bbdfc09d8395b7095d72.jpg)  
图1.1.3（b）模式选择画面（公差的设定值的输入）
不使用平滑容差+控制时，无需设定公差。
1 平滑容差+控制无效时，不显示公差的项目。
2 使用8级数据保护功能保护设置参数时，无法在模式选择画面中输入设定值。如果在该状态下输入设定值，将显示“禁止写入”的警告。
3 请在紧急停止中或MDI模式下且不处于自动运行中的状态下在模式选择画面中输入设定值。如果在其他模式下进行输入操作，将显示“请在MDI模式下进行”的警告。
4 工件装卸机控制用功能有效时，工件装卸机系统中不显示模式设定画面。
# 选择设定模式
![](images/167d39702c361b704c61b21728eed8d30c54cca5dfbeeec42f93b17260b8c806.jpg)
2 按下软键[操作]。
3 按下软键[选择]后，所选择的设定模式变为有效。
![](images/0dad6e4c41f13d0487c5e2305f82db8dea671540811ee7d28ea62411c489b1b1.jpg)  
图1.1.3（c）模式选择画面（选择设定模式）
也可以通过程序指令选择设定模式。通过程序指令选择设定模式的选择方法的详情请参照“通过程序指令选择精细表面设定的设定模式”的项。
1 请在紧急停止中或MDI模式下且不处于自动运行中的状态下通过模式选择画面选择设定模式。如果在其他模式下进行选择操作，将显示“请在MDI模式下进行”的警告。2 工件装卸机控制用功能有效时，工件装卸机系统中不显示模式设定画面。
# 程序指令中包含地址P的功能一览
# A.1 G代码的自变量中包含地址P的功能一览表
G代码中包含地址P的功能如下所示
| 功能名 | 加工中心系统 | 车床系统 | 参考项目 |
| --- | --- | --- | --- |
| G代码体系 |  |  |  |
| A | B | C |  |
| 暂停 | G04 | G04 | G04 |
| 基于G代码的掩码缓冲器 | G04.1 | G04.1 | G04.1 |
| AI轮廓控制II（高精度轮廓控制/AI高精度轮廓控制兼容指令） | G05 | G05 | G05 |
| 可编程数据输入 | G08 | G08 | G08 |
| 可编程数据输入 | G10 | G10 | G10 |
| 可编程参数输入 | G10 | G10 | G10 |
| 可编程内部数据变更 | G10.8 | G10.8 | G10.8 |
| 机床配置的选择 | G10.8 | G10.8 | G10.8 |
| 主轴速度变动检测 | G26 | G26 | G26 |
| 参考点返回 | G30 | G30 | G30 |
| 多级跳转 | G31 | G31 | G31 |
| 扭矩极限跳过 | G31 | G31 | G31 |
| 连续高速跳转 | G31 | G31 | G31 |
| EGB跳转功能 | G31.8 | G31.8 | G31.8 |
| 砂轮磨损补偿 | G41 | G41 | G41 |
| 比例缩放 | G51 | - | G51 |
| 多边形加工 | G51.2 | G51.2 | G51.2 |
| (G251) | (G251) | (G251) |  |
| 基于程序指令的同步/混合/重叠控制 | G51.4 | G51.4 | G51.4 |
| G51.5 | G51.5 | G51.5 | G51.5 |
| G51.6 | G51.6 | G51.6 | G51.6 |
| G50.5 | G50.5 | G50.5 | G50.5 |
| 任意轴切换 | G52.1 | G52.1 | G52.1 |
| G52.2 | G52.2 | G52.2 | G52.2 |
| G52.3 | G52.3 | G52.3 | G52.3 |
| 高速G53 | G53 | G53 | G53 |
| 坐标系设定 | G54 | G54 | G54 |
| (G54.1) | (G54.1) | (G54.1) | (G54.1) |
| 用户宏程序 | G65, | G65, | G65, |
| G66, | G66, | G66, | G66, |
| G66.1 | G66.1 | G66.1 | G66.1 |
| 执行宏 注释）1 | G65, | G65, | G65, |
| G66, | G66, | G66, | G66, |
| 功能名 | 加工中心系统 | 车床系统 | 参考项目 |
| --- | --- | --- | --- |
| G代码体系 |  |  |  |
| A | B | C |  |
| G66.1 | G66.1 | G66.1 | G66.1 |
| 注释)1 | 注释)1 | 注释)1 | 注释)1 |
| 模式数据输入 | G65 | G65 | G65 |
| 均衡切削 | - | G68 | G68 |
| 倾斜面分度指令 | G68.2 | G68.2 | G68.2 |
| 基于刀具轴方向的倾斜面分度指令 | G68.3 | G68.3 | G68.3 |
| 倾斜面分度指令(增量多重指令) | G68.4 | G68.4 | G68.4 |
| 复合型固定循环 | G70.7～G76.7 | G70～G76 | G70～G76 |
| 图形复制 | G72.1, | G72.1, | G72.1, |
| G72.2 | G72.2 | G72.2 | G72.2 |
| 钻孔固定循环 | G74, | - | - |
| G75, |  |  |  |
| 磨削用固定循环(磨床用) | G75, | G72, | G72, |
| G77, | G74 | G74 | G75 |
| G78, |  |  |  |
| G79, |  |  |  |
| 钻孔固定循环 | G82～G84, | G82～G85, | G82～G85, |
| G87～G89 | G87～G89, | G87～G89, | G87～G89, |
|  | G83.5, | G83.5, | G83.5, |
|  | G83.6, | G83.6, | G83.6, |
|  | G87.5, | G87.5, | G87.5, |
|  | G87.6, | G87.6, | G87.6, |
| 电子齿轮箱 | G81 | G81 | G81 |
| 电子齿轮箱2组 | G81.5 | G81.5 | G81.5 |
| 高速钻深孔循环 | - | G83.1 | G83.1 |
| 刚性攻丝循环(FS15格式) | G84.2 | G84.2 | G84.2 |
| 反向攻丝(FS15格式) | G84.3 | - | - |
| 限速恒定控制 | G96 | G96 | G96 |
| 主轴分度功能 | G96.1～G96.3 | G96.1～G96.3 | G96.1～G96.3 |
| 基于伺服电机的主轴控制功能 | G96.4 | G96.4 | G96.4 |
注释）1：可根据如下编译参数，选择任意的G代码。No.9013～No.9022、No.9034、No.9045～No.9047、No.9129～No.9137
# A.2 M代码、S代码的自变量中包含地址P的功能一览表
M代码与S代码中包含地址P的功能如下所示。
| 功能名 | M代码格式 | 相关参数 | 参考项目 |
| --- | --- | --- | --- |
| 等待M代码 | M_P_ | No.8110, No.8111, MWP(No.8103#1) | 连接说明书（功能篇） 操作说明书（通用） Ⅱ.编程 |
| 高速类型的等待M代码 | M_P_ | No.8114, No.8115, MWP(No.8103#1) | 连接说明书（功能篇） 操作说明书（通用） Ⅱ.编程 |
| 开始位置指定等待功能 | M_P_L_IP | STW(No.8101#1), No.8110, No.8111, MWP(No.8103#1) | 连接说明书（功能篇） 操作说明书（通用） Ⅱ.编程 |
| （用户宏程序）子程序调用 | M98P_ |  | 操作说明书（通用） Ⅱ.编程 |
| 程序结尾 | M99P_ |  |  |
| 外部子程序调用 | M998P_ | SBP(No.3404#2) | 操作说明书（通用） Ⅲ.操作 |
| 用户宏程序M代码宏程序调用（也包括多个指定、特殊调用） | M_P_ | MAA(No.6009#2) | 操作说明书（通用） Ⅱ.编程 |
| 执行宏子程序调用 | M98P_ |  | 宏程序执行器编程说明书 |
| 用户程序的子程序调用 | M_P_ |  |  |
| 执行宏M代码宏程序调用（也包括多个指定、特殊调用） | M_P_ |  |  |
| 多主轴 | S_P_ | MPP(No.3703#3), No.3781 | 连接说明书（功能篇） |
# 索引
# <A>
安全使用须知 s- 1按下功能键显示的画面 181
# <B>
倍率信号 68被判断为干涉时的动作 155补偿功能 88
# <C>
插补功能 14程序指令中包含地址P的功能一览 193
# <D>
刀尖半径补偿（  $\mathrm{G40\sim G42}$  ）的概括说明 105刀具补偿值、补偿值数目和利用程序的刀具补偿值输入（G10） 167刀具长度补偿位移类型 88刀具长度测量 185刀具长度自动测量（G37） 93刀具径补偿（  $\mathrm{G40\sim G42}$  ）的概括说明 100刀具径补偿或刀尖半径补偿的详细说明 115刀具位置偏置（  $\mathrm{G45\sim G48}$  ） 95刀具形状和基于程序的刀具移动 9
# <F>
反向刚性攻丝循环(G74) 60反向攻丝循环(G74) 26分度工作台分度功能 72
# <G>
G代码的自变量中包含地址P的功能一览表 193概述 3,9,115干涉检查 152干涉检查报警功能 155干涉检查避开功能 157刚性攻丝 56刚性攻丝(G84) 56刚性攻丝中的倍率 67高速钻深孔循环(G73) 24工件位置与移动指令 109攻丝循环(G84) 38固定循环取消(G80) 67拐角圆弧插补（G39） 165关于刀尖半径补偿的注意事项 114
# <H>
横向进给控制（磨床用） 74回程镗孔循环（G87） 42
# <J>
极坐标指令(G15、G16) 16假想刀尖 105假想刀尖的方向 107
间歇进给表面磨削循环(G79) 86精密表面设定 188精密镗孔（G76） 28
# <L>
拉拔倍率 67利用刀具径补偿来防止过切 149连续进给表面磨削循环(G78) 83螺纹切削（G33） 14
# <M>
M代码、S代码的自变量中包含地址P的功能一览表 195磨削用固定循环（磨床用） 77
# <P>
偏置号与补偿值 108偏置模式取消模式下的刀具移动 142偏置模式下的刀具移动 124
# <Q>
起刀时的刀具移动 119切入式磨削循环(G75) 78切入式直接恒定尺寸磨削循环(G77) 81
# <R>
任意角度的倒角和倒圆 69
# <S>
Series15格式下的存储器运行 176深孔刚性攻丝循环(G84或G74) 63矢量保持（G38） 164
# <T>
镗孔循环(G85) 39镗孔循环(G86) 41镗孔循环(G88) 44镗孔循环(G89) 46通过程序指令选择精细表面设定的设定模式 177
# <W>
为简化编程的功能 20
# <X>
显示和设定刀具偏置值 181显示和设定数据 181
# <Y>
用于高速加工的功能 177有关各类数据的注意事项 6预备功能（G功能） 10阅读本说明书时的注意事项 5
# <Z>
针对来自MDI输入的刀具径补偿或刀尖半径补偿.162
钻孔固定循环 .20钻孔固定循环搭接 .51钻孔固定循环的举例 .48钻孔固定循环取消(G80) .47钻孔固定循环主轴速度到达等待时间缩短 .50钻孔循环，定点镗孔(G81) .29钻孔循环，镗阶梯孔(G82) .31钻深孔循环(G83) .32钻小口径深孔循环(G83) .34坐标系旋转（G68、G69） .169坐标值和尺寸 .16
# 说明书改版履历
| 版本 | 日期 | 变更内容 |
| --- | --- | --- |
| 01 | 2019 年 7 月 |  |
B- 64694CM- 2/01